!function(){function e(e,i){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,i){if(!e)return;if("string"==typeof e)return t(e,i);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,i)}(e))||i&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){l=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(l)throw s}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}(self.webpackChunkperun_web_apps=self.webpackChunkperun_web_apps||[]).push([[739],{95142:function(e,t,n){"use strict";n.d(t,{y:function(){return R}});var r=n(33642),s=n(60611),o=n(88426),l=n(31572),c=n(57629),u=n(61511),d=n(59403),p=n(19139),g=n(67806),f=n(4252),h=n(48160);function m(e,t){if(1&e){var i=l.EpF();l.TgZ(0,"perun-web-apps-refresh-button",5),l.NdJ("refresh",function(){return l.CHM(i),l.oxw().refreshTable()}),l.qZA()}}function v(e,t){if(1&e){var i=l.EpF();l.TgZ(0,"perun-web-apps-immediate-filter",6),l.NdJ("filter",function(e){return l.CHM(i),l.oxw().applyFilter(e)}),l.qZA()}2&e&&l.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_MEMBERS.FILTER")}function A(e,t){1&e&&l._UZ(0,"mat-spinner",7)}var S=function(){return["id","fullName"]};function b(e,t){if(1&e){var i=l.EpF();l.TgZ(0,"perun-web-apps-members-list",8),l.NdJ("page",function(e){return l.CHM(i),l.oxw().pageChanged(e)})("updateTable",function(){return l.CHM(i),l.oxw().refreshTable()}),l.qZA()}if(2&e){var n=l.oxw();l.Q6J("disableRouting",!n.routeAuth)("filter",n.filterValue)("displayedColumns",l.DdM(5,S))("members",n.members)("pageSize",n.pageSize)}}var R=function(){var e=function(){function e(t,n,a,r){i(this,e),this.route=t,this.resourceService=n,this.tableConfigService=a,this.authResolver=r,this.loading=!1,this.filterValue="",this.tableId=s.iQ}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe(function(t){e.resourceId=t.resourceId,e.refreshTable()})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.resourceService.getAssignedRichMembers(this.resourceId).subscribe(function(t){e.members=t,e.setAuthRights(),e.loading=!1})}},{key:"setAuthRights",value:function(){0!==this.members.length&&(this.routeAuth=this.authResolver.isAuthorized("getMemberById_int_policy",[this.members[0]]))}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(l.Y36(c.gz),l.Y36(r.xk),l.Y36(s.dB),l.Y36(o.x4))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-resource-assigned-members"]],decls:7,vars:7,consts:[[1,"page-subtitle"],[3,"refresh",4,"ngIf"],[3,"placeholder","filter",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],[3,"disableRouting","filter","displayedColumns","members","pageSize","page","updateTable",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],[1,"ml-auto","mr-auto"],[3,"disableRouting","filter","displayedColumns","members","pageSize","page","updateTable"]],template:function(e,t){1&e&&(l.TgZ(0,"h1",0),l._uU(1),l.ALo(2,"translate"),l.qZA(),l.YNc(3,m,1,0,"perun-web-apps-refresh-button",1),l.YNc(4,v,1,1,"perun-web-apps-immediate-filter",2),l.YNc(5,A,1,0,"mat-spinner",3),l.YNc(6,b,1,6,"perun-web-apps-members-list",4)),2&e&&(l.xp6(1),l.Oqu(l.lcZ(2,5,"RESOURCE_DETAIL.ASSIGNED_MEMBERS.TITLE")),l.xp6(2),l.Q6J("ngIf",!t.loading),l.xp6(1),l.Q6J("ngIf",!t.loading),l.xp6(1),l.Q6J("ngIf",t.loading),l.xp6(1),l.Q6J("ngIf",!t.loading))},directives:[u.O5,d.t,p.L,g.$g,f.O],pipes:[h.X$],styles:[""]}),e}()},75374:function(t,n,r){"use strict";r.d(n,{D:function(){return G}});var s=r(33642),o=r(60611),l=r(4230),c=r(27613),u=r(84608),d=r(88426),p=r(31572),g=r(48160),f=r(61511),h=r(15980),m=r(67806),v=r(91058),A=r(91721);function S(e,t){1&e&&p._UZ(0,"mat-spinner",6)}function b(e,t){if(1&e){var i=p.EpF();p.TgZ(0,"app-services-list",10),p.NdJ("page",function(e){return p.CHM(i),p.oxw(2).pageChanged(e)}),p.qZA()}if(2&e){var n=p.oxw(2);p.Q6J("pageSize",n.pageSize)("disableRouting",!0)("services",n.unAssignedServices)("filterValue",n.filterValue)("selection",n.selection)}}function R(e,t){if(1&e){var i=p.EpF();p.TgZ(0,"div",7),p.TgZ(1,"perun-web-apps-debounce-filter",8),p.NdJ("filter",function(e){return p.CHM(i),p.oxw().applyFilter(e)}),p.ALo(2,"translate"),p.qZA(),p.YNc(3,b,1,5,"app-services-list",9),p.qZA()}if(2&e){var n=p.oxw();p.xp6(1),p.s9C("placeholder",p.lcZ(2,2,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.FILTER_DESCRIPTION")),p.xp6(2),p.Q6J("ngIf",!n.loading)}}var E=function(){var t=function(){function t(e,n,a,r,s,c,u){i(this,t),this.dialogRef=e,this.data=n,this.notificator=a,this.translate=r,this.resourceManager=s,this.servicesManager=c,this.tableConfigService=u,this.loading=!1,this.selection=new l.Ov(!0,[]),this.tableId=o.DR,this.filterValue=""}return a(t,[{key:"ngOnInit",value:function(){var t=this;this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.theme=this.data.theme,this.resourceManager.getAssignedServicesToResource(this.data.resourceId).subscribe(function(i){t.servicesManager.getServices().subscribe(function(n){t.unAssignedServices=n;var a,r=e(i);try{for(r.s();!(a=r.n()).done;){var s,o=a.value,l=e(n);try{for(l.s();!(s=l.n()).done;){var c=s.value;o.id===c.id&&t.unAssignedServices.splice(t.unAssignedServices.indexOf(c),1)}}catch(u){l.e(u)}finally{l.f()}}}catch(u){r.e(u)}finally{r.f()}t.filteredServices=t.unAssignedServices,t.loading=!1})})}},{key:"onCancel",value:function(){this.dialogRef.close()}},{key:"onAdd",value:function(){var t=this;this.loading=!0;var i,n=[],a=e(this.selection.selected);try{for(a.s();!(i=a.n()).done;){var r=i.value;n.push(r.id)}}catch(s){a.e(s)}finally{a.f()}this.resourceManager.assignServices(this.data.resourceId,n).subscribe(function(){t.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SUCCESS_MESSAGE").subscribe(function(e){t.notificator.showSuccess(e),t.dialogRef.close(!0)})},function(){return t.loading=!1})}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),t}();return t.\u0275fac=function(e){return new(e||t)(p.Y36(u.so),p.Y36(u.WI),p.Y36(d.V6),p.Y36(g.sK),p.Y36(s.xk),p.Y36(s.KK),p.Y36(o.dB))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-perun-web-apps-assign-service-to-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[3,"placeholder","filter"],[3,"pageSize","disableRouting","services","filterValue","selection","page",4,"ngIf"],[3,"pageSize","disableRouting","services","filterValue","selection","page"]],template:function(e,t){1&e&&(p.TgZ(0,"div"),p.TgZ(1,"h1",0),p._uU(2),p.ALo(3,"translate"),p.qZA(),p.YNc(4,S,1,0,"mat-spinner",1),p.YNc(5,R,4,4,"div",2),p.TgZ(6,"div",3),p.TgZ(7,"button",4),p.NdJ("click",function(){return t.onCancel()}),p._uU(8),p.ALo(9,"translate"),p.qZA(),p.TgZ(10,"button",5),p.NdJ("click",function(){return t.onAdd()}),p._uU(11),p.ALo(12,"translate"),p.qZA(),p.qZA(),p.qZA()),2&e&&(p.Tol(t.theme),p.xp6(2),p.Oqu(p.lcZ(3,9,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.TITLE")),p.xp6(2),p.Q6J("ngIf",t.loading),p.xp6(1),p.Q6J("ngIf",!t.loading),p.xp6(3),p.hij(" ",p.lcZ(9,11,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.CANCEL_BUTTON")," "),p.xp6(2),p.Q6J("disabled",0===t.selection.selected.length||t.loading),p.xp6(1),p.hij(" ",p.lcZ(12,13,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.ADD_BUTTON")," "))},directives:[u.uh,f.O5,u.H8,h.lW,m.$g,u.xY,v.P,A.Q],pipes:[g.X$],styles:[""]}),t}(),Z=r(67033);function I(e,t){1&e&&p._UZ(0,"mat-spinner",6)}function T(e,t){1&e&&p._UZ(0,"th",15)}function O(e,t){if(1&e&&(p.TgZ(0,"td",16),p._uU(1),p.qZA()),2&e){var i=t.$implicit;p.xp6(1),p.hij(" ",i.name," ")}}function C(e,t){1&e&&p._UZ(0,"tr",17)}function _(e,t){1&e&&p._UZ(0,"tr",18)}function y(e,t){if(1&e&&(p.TgZ(0,"div",7),p.TgZ(1,"p"),p._uU(2),p.ALo(3,"translate"),p.qZA(),p.TgZ(4,"div",8),p._uU(5),p.ALo(6,"translate"),p.qZA(),p.TgZ(7,"table",9),p.ynx(8,10),p.YNc(9,T,1,0,"th",11),p.YNc(10,O,2,1,"td",12),p.BQk(),p.YNc(11,C,1,0,"tr",13),p.YNc(12,_,1,0,"tr",14),p.qZA(),p.qZA()),2&e){var i=p.oxw();p.xp6(2),p.hij(" ",p.lcZ(3,5,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DESCRIPTION")," "),p.xp6(3),p.hij(" ",p.lcZ(6,7,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.ASK")," "),p.xp6(2),p.Q6J("dataSource",i.dataSource),p.xp6(4),p.Q6J("matHeaderRowDef",i.displayedColumns),p.xp6(1),p.Q6J("matRowDefColumns",i.displayedColumns)}}var x=function(){var t=function(){function t(e,n,a,r,s){i(this,t),this.dialogRef=e,this.data=n,this.notificator=a,this.translate=r,this.resourcesManager=s,this.displayedColumns=["name"]}return a(t,[{key:"ngOnInit",value:function(){this.theme=this.data.theme,this.dataSource=new Z.by(this.data.services)}},{key:"onSubmit",value:function(){var t=this;this.loading=!0;var i,n=[],a=e(this.data.services);try{for(a.s();!(i=a.n()).done;){var r=i.value;n.push(r.id)}}catch(s){a.e(s)}finally{a.f()}this.resourcesManager.removeServices(this.data.resourceId,n).subscribe(function(){t.translate.get("DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.SUCCESS").subscribe(function(e){t.notificator.showSuccess(e),t.dialogRef.close(!0)})},function(){return t.loading=!1})}},{key:"onCancel",value:function(){this.dialogRef.close()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(p.Y36(u.so),p.Y36(u.WI),p.Y36(d.V6),p.Y36(g.sK),p.Y36(s.xk))},t.\u0275cmp=p.Xpm({type:t,selectors:[["app-perun-web-apps-remove-service-from-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(p.TgZ(0,"div"),p.TgZ(1,"h1",0),p._uU(2),p.ALo(3,"translate"),p.qZA(),p.YNc(4,I,1,0,"mat-spinner",1),p.YNc(5,y,13,9,"div",2),p.TgZ(6,"div",3),p.TgZ(7,"button",4),p.NdJ("click",function(){return t.onCancel()}),p._uU(8),p.ALo(9,"translate"),p.qZA(),p.TgZ(10,"button",5),p.NdJ("click",function(){return t.onSubmit()}),p._uU(11),p.ALo(12,"translate"),p.qZA(),p.qZA(),p.qZA()),2&e&&(p.Tol(t.theme),p.xp6(2),p.Oqu(p.lcZ(3,9,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.TITLE")),p.xp6(2),p.Q6J("ngIf",t.loading),p.xp6(1),p.Q6J("ngIf",!t.loading),p.xp6(3),p.hij(" ",p.lcZ(9,11,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.CANCEL")," "),p.xp6(2),p.Q6J("disabled",t.loading),p.xp6(1),p.hij(" ",p.lcZ(12,13,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DELETE")," "))},directives:[u.uh,f.O5,u.H8,h.lW,m.$g,u.xY,Z.BZ,Z.w1,Z.fO,Z.Dz,Z.as,Z.nj,Z.ge,Z.ev,Z.XQ,Z.Gk],pipes:[g.X$],styles:[""]}),t}(),N=r(57629),w=r(59403),D=r(19139);function U(e,t){if(1&e){var i=p.EpF();p.TgZ(0,"button",7),p.NdJ("click",function(){return p.CHM(i),p.oxw().addService()}),p._uU(1),p.ALo(2,"translate"),p.qZA()}2&e&&(p.xp6(1),p.hij(" ",p.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_SERVICES.ADD_SERVICE"),"\n"))}function L(e,t){if(1&e){var i=p.EpF();p.TgZ(0,"button",8),p.NdJ("click",function(){return p.CHM(i),p.oxw().removeServices()}),p._uU(1),p.ALo(2,"translate"),p.qZA()}if(2&e){var n=p.oxw();p.Q6J("disabled",0===n.selected.selected.length),p.xp6(1),p.hij(" ",p.lcZ(2,2,"RESOURCE_DETAIL.ASSIGNED_SERVICES.REMOVE_SERVICE"),"\n")}}function k(e,t){1&e&&p._UZ(0,"mat-spinner",9)}function M(e,t){if(1&e){var i=p.EpF();p.TgZ(0,"app-services-list",10),p.NdJ("page",function(e){return p.CHM(i),p.oxw().pageChanged(e)}),p.qZA()}if(2&e){var n=p.oxw();p.Q6J("pageSize",n.pageSize)("services",n.assignedServices)("selection",n.selected)("filterValue",n.filterValue)("displayedColumns",n.displayedColumns)("disableRouting",!n.serviceRoutingAuth)}}var G=function(){var e=function(){function e(t,n,a,r,s){i(this,e),this.route=t,this.resourcesManager=n,this.tableConfigService=a,this.dialog=r,this.guiAuthResolver=s,this.assignedServices=[],this.selected=new l.Ov(!0,[]),this.tableId=o.uC,this.filterValue="",this.displayedColumns=["select","id","name","enabled","script","description"]}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe(function(t){e.resourceId=t.resourceId,e.resourcesManager.getResourceById(e.resourceId).subscribe(function(t){e.resource=t,e.getDataForAuthorization(),e.loadAllServices()})})}},{key:"loadAllServices",value:function(){var e=this;this.loading=!0,this.resourcesManager.getAssignedServicesToResource(this.resourceId).subscribe(function(t){e.assignedServices=t,e.selected.clear(),e.loading=!1})}},{key:"addService",value:function(){var e=this,t=(0,c.kZ)();t.width="800px",t.data={theme:"resource-theme",resourceId:this.resourceId},this.dialog.open(E,t).afterClosed().subscribe(function(t){t&&e.loadAllServices()})}},{key:"removeServices",value:function(){var e=this,t=(0,c.kZ)();t.width="500px",t.data={theme:"resource-theme",resourceId:this.resourceId,services:this.selected.selected},this.dialog.open(x,t).afterClosed().subscribe(function(t){t&&e.loadAllServices()})}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}},{key:"getDataForAuthorization",value:function(){this.assignServiceAuth=this.guiAuthResolver.isAuthorized("assignServices_Resource_List<Service>_policy",[this.resource]),this.removeServiceAuth=this.guiAuthResolver.isAuthorized("removeServices_Resource_List<Service>_policy",[this.resource]),this.displayedColumns=this.removeServiceAuth?["select","id","name","enabled","script","description"]:["id","name","enabled","script","description"],this.serviceRoutingAuth=this.guiAuthResolver.isPerunAdmin()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(p.Y36(N.gz),p.Y36(s.xk),p.Y36(o.dB),p.Y36(u.uw),p.Y36(d.x4))},e.\u0275cmp=p.Xpm({type:e,selectors:[["app-perun-web-apps-resource-assigned-services"]],decls:9,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","ml-2",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","services","selection","filterValue","displayedColumns","disableRouting","page",4,"ngIf"],["color","accent","mat-flat-button","",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"pageSize","services","selection","filterValue","displayedColumns","disableRouting","page"]],template:function(e,t){1&e&&(p.TgZ(0,"h1",0),p._uU(1),p.ALo(2,"translate"),p.qZA(),p.TgZ(3,"perun-web-apps-refresh-button",1),p.NdJ("refresh",function(){return t.loadAllServices()}),p.qZA(),p.YNc(4,U,3,3,"button",2),p.YNc(5,L,3,4,"button",3),p.TgZ(6,"perun-web-apps-immediate-filter",4),p.NdJ("filter",function(e){return t.applyFilter(e)}),p.qZA(),p.YNc(7,k,1,0,"mat-spinner",5),p.YNc(8,M,1,6,"app-services-list",6)),2&e&&(p.xp6(1),p.Oqu(p.lcZ(2,6,"RESOURCE_DETAIL.ASSIGNED_SERVICES.TITLE")),p.xp6(3),p.Q6J("ngIf",!t.loadingResource&&t.assignServiceAuth),p.xp6(1),p.Q6J("ngIf",!t.loadingResource&&t.removeServiceAuth),p.xp6(1),p.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_SERVICES.FILTER_SERVICES"),p.xp6(1),p.Q6J("ngIf",t.loading),p.xp6(1),p.Q6J("ngIf",!t.loading))},directives:[w.t,f.O5,D.L,h.lW,m.$g,A.Q],pipes:[g.X$],styles:[""]}),e}()},79472:function(e,t,n){"use strict";n.d(t,{X:function(){return E}});var r=n(88426),s=n(33642),o=n(31572),l=n(57629),c=n(55109),u=n(61511),d=n(541),p=n(69012),g=n(48160);function f(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"RESOURCE_DETAIL.ENTITY")," ")}function h(e,t){if(1&e&&o._UZ(0,"app-one-entity-attribute-page",4),2&e){var i=o.oxw();o.Q6J("entity","resource")("entityId",i.resourceId)}}function m(e,t){1&e&&(o._uU(0),o.ALo(1,"translate"),o.ALo(2,"translate")),2&e&&o.AsE(" ",o.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",o.lcZ(2,4,"MEMBER_DETAIL.ENTITY")," ")}function v(e,t){if(1&e&&o._UZ(0,"app-two-entity-attribute-page",5),2&e){var i=o.oxw(2);o.Q6J("firstEntity","resource")("firstEntityId",i.resourceId)("secondEntity","member")}}function A(e,t){1&e&&(o.TgZ(0,"mat-tab"),o.YNc(1,m,3,6,"ng-template",1),o.YNc(2,v,1,3,"ng-template",2),o.qZA())}function S(e,t){1&e&&(o._uU(0),o.ALo(1,"translate"),o.ALo(2,"translate")),2&e&&o.AsE(" ",o.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",o.lcZ(2,4,"GROUP_DETAIL.ENTITY")," ")}function b(e,t){if(1&e&&o._UZ(0,"app-two-entity-attribute-page",5),2&e){var i=o.oxw(2);o.Q6J("firstEntity","resource")("firstEntityId",i.resourceId)("secondEntity","group")}}function R(e,t){1&e&&(o.TgZ(0,"mat-tab"),o.YNc(1,S,3,6,"ng-template",1),o.YNc(2,b,1,3,"ng-template",2),o.qZA())}var E=function(){var e=function(){function e(t,n,a){i(this,e),this.route=t,this.authResolver=n,this.resourceManager=a}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.route.parent.params.subscribe(function(t){e.resourceId=parseInt(t.resourceId,10),e.resourceManager.getResourceById(e.resourceId).subscribe(function(t){e.resource=t,e.resourceGroupAttAuth=e.authResolver.isAuthorized("getAssignedGroups_Resource_policy",[e.resource]),e.resourceMemberAttAuth=e.authResolver.isAuthorized("getAssignedRichMembers_Resource_policy",[e.resource])})})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Y36(l.gz),o.Y36(r.x4),o.Y36(s.xk))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-resource-attributes"]],hostVars:2,hostBindings:function(e,t){2&e&&o.ekj("router-component",t.true)},decls:10,vars:5,consts:[[1,"page-subtitle"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entity","entityId"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(e,t){1&e&&(o.TgZ(0,"div"),o.TgZ(1,"h1",0),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"mat-tab-group"),o.TgZ(5,"mat-tab"),o.YNc(6,f,2,3,"ng-template",1),o.YNc(7,h,1,2,"ng-template",2),o.qZA(),o.YNc(8,A,3,0,"mat-tab",3),o.YNc(9,R,3,0,"mat-tab",3),o.qZA(),o.qZA()),2&e&&(o.xp6(2),o.Oqu(o.lcZ(3,3,"RESOURCE_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),o.xp6(6),o.Q6J("ngIf",t.resourceMemberAttAuth),o.xp6(1),o.Q6J("ngIf",t.resourceGroupAttAuth))},directives:[c.SP,c.uX,c.uD,c.Vc,u.O5,d.t,p.Y],pipes:[g.X$],styles:[""]}),e}()},72920:function(e,t,n){"use strict";n.d(t,{b:function(){return M}});var r=n(17),s=n(75585),o=n(33642),l=n(27613),c=n(88426),u=n(22280),d=n(81954),p=n(95909),g=n(31572),f=n(57629),h=n(48958),m=n(84608),v=n(66297),A=n(61511),S=n(67806),b=n(43691),R=n(36922),E=n(21575),Z=n(15980),I=n(48160);function T(e,t){1&e&&g._UZ(0,"mat-spinner",3)}function O(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"button",15),g.NdJ("click",function(){return g.CHM(i),g.oxw(2).editResource()}),g.TgZ(1,"mat-icon"),g._uU(2,"edit"),g.qZA(),g.qZA()}}function C(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"button",16),g.NdJ("click",function(){return g.CHM(i),g.oxw(2).deleteResource()}),g.TgZ(1,"mat-icon"),g._uU(2,"delete_forever"),g.qZA(),g.qZA()}}var _=function(e){return["/organizations",e]};function y(e,t){if(1&e&&(g.TgZ(0,"a",8),g._uU(1),g.qZA()),2&e){var i=g.oxw(2);g.Q6J("routerLink",g.VKq(2,_,i.resource.vo.id)),g.xp6(1),g.Oqu(i.resource.vo.name)}}function x(e,t){if(1&e&&(g.TgZ(0,"span"),g._uU(1),g.qZA()),2&e){var i=g.oxw(2);g.xp6(1),g.hij(" ",i.resource.vo.name," ")}}var N=function(e){return["/facilities",e]};function w(e,t){if(1&e&&(g.TgZ(0,"a",8),g._uU(1),g.qZA()),2&e){var i=g.oxw(2);g.Q6J("routerLink",g.VKq(2,N,i.resource.facilityId)),g.xp6(1),g.Oqu(i.resource.facility.name)}}function D(e,t){if(1&e&&(g.TgZ(0,"span"),g._uU(1),g.qZA()),2&e){var i=g.oxw(2);g.xp6(1),g.hij(" ",i.resource.facility.name," ")}}var U=function(){return{color:"black"}},L=function(e){return[e]};function k(e,t){if(1&e&&(g.TgZ(0,"div"),g.TgZ(1,"div",4),g._UZ(2,"mat-icon",5),g.ALo(3,"translate"),g.TgZ(4,"div",6),g.TgZ(5,"div",7),g.TgZ(6,"a",8),g._uU(7),g.qZA(),g.TgZ(8,"span",9),g._uU(9),g.qZA(),g.YNc(10,O,3,0,"button",10),g.YNc(11,C,3,0,"button",11),g.qZA(),g.TgZ(12,"div"),g._uU(13),g.ALo(14,"translate"),g.qZA(),g.TgZ(15,"span",12),g._uU(16),g.ALo(17,"translate"),g.ALo(18,"translate"),g.YNc(19,y,2,4,"a",13),g.YNc(20,x,2,1,"span",2),g._uU(21),g.ALo(22,"translate"),g.YNc(23,w,2,4,"a",14),g.YNc(24,D,2,1,"span",2),g._uU(25),g.ALo(26,"translate"),g.qZA(),g.qZA(),g.qZA(),g._UZ(27,"app-animated-router-outlet"),g.qZA()),2&e){var i=g.oxw();g.xp6(2),g.s9C("matTooltip",g.lcZ(3,20,"RESOURCE_DETAIL.ENTITY")),g.Q6J("ngStyle",g.DdM(32,U)),g.xp6(4),g.Q6J("routerLink",g.VKq(33,L,i.baseUrl)),g.xp6(1),g.hij(" ",i.resource.name," "),g.xp6(2),g.hij(" \xa0#",i.resource.id," "),g.xp6(1),g.Q6J("ngIf",i.editResourceAuth),g.xp6(1),g.Q6J("ngIf",i.deleteAuth),g.xp6(2),g.AsE(" ",g.lcZ(14,22,"RESOURCE_DETAIL.UUID"),": ",i.resource.uuid," "),g.xp6(3),g.AsE(" ",g.lcZ(17,24,"RESOURCE_DETAIL.ENTITY"),", ",g.lcZ(18,26,"RESOURCE_DETAIL.VO"),": "),g.xp6(3),g.Q6J("ngIf",i.voLinkAuth),g.xp6(1),g.Q6J("ngIf",!i.voLinkAuth),g.xp6(1),g.AsE(" #",i.resource.voId,", ",g.lcZ(22,28,"RESOURCE_DETAIL.FACILITY"),": "),g.xp6(2),g.Q6J("ngIf",i.facilityLinkAuth),g.xp6(1),g.Q6J("ngIf",!i.facilityLinkAuth),g.xp6(1),g.lnq(" #",i.resource.facilityId,", ",g.lcZ(26,30,"RESOURCE_DETAIL.DESCRIPTION"),": ",i.resource.description," ")}}var M=function(){var e=function(){function e(t,n,a,r,s,o,l,c,u){i(this,e),this.route=t,this.facilityManager=n,this.vosManagerService=a,this.resourcesManager=r,this.sideMenuService=s,this.sideMenuItemService=o,this.dialog=l,this.guiAuthResolver=c,this.router=u,this.deleteAuth=!1,this.baseUrl="",this.loading=!1}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.params.subscribe(function(t){e.resourcesManager.getRichResourceById(t.resourceId).subscribe(function(t){e.resource=t,e.setAuth(),"facilities"===e.route.parent.snapshot.url[0].path?(e.baseUrl=(new u.r5).transform(t,!1),e.facilityManager.getFacilityById(t.facilityId).subscribe(function(i){var n=e.sideMenuItemService.parseFacility(i),a=e.sideMenuItemService.parseResource(t,!1);e.sideMenuService.setFacilityMenuItems([n,a]),e.loading=!1},function(){return e.loading=!1})):(e.baseUrl=(new u.r5).transform(t,!0),e.vosManagerService.getVoById(t.voId).subscribe(function(i){var n=e.sideMenuItemService.parseVo(i),a=e.sideMenuItemService.parseResource(t,!0);e.sideMenuService.setAccessMenuItems([n,a]),e.loading=!1},function(){return e.loading=!1})),(0,l.sF)("resources",e.resource)})})}},{key:"setAuth",value:function(){this.facilityLinkAuth=this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.resource]),this.editResourceAuth=this.guiAuthResolver.isAuthorized("updateResource_Resource_policy",[this.resource]),this.voLinkAuth=this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.resource]),this.deleteAuth=this.guiAuthResolver.isAuthorized("deleteResource_Resource_policy",[this.resource])}},{key:"editResource",value:function(){var e,t=this;this.resourcesManager.getResourceById(this.resource.id).subscribe(function(i){e=i;var n=(0,l.kZ)();n.width="450px",n.data={theme:"resource-theme",resource:e,dialogType:d.Eg.RESOURCE},t.dialog.open(d.rd,n).afterClosed().subscribe(function(e){e&&t.resourcesManager.getRichResourceById(t.resource.id).subscribe(function(e){t.resource=e})})})}},{key:"deleteResource",value:function(){var e=this,t=(0,l.kZ)();t.width="500px",t.data={theme:"resource-theme",resources:[this.resource]},this.dialog.open(p.f,t).afterClosed().subscribe(function(t){t&&e.router.navigate(["../"],{relativeTo:e.route})})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(f.gz),g.Y36(o.IQ),g.Y36(o.YF),g.Y36(o.xk),g.Y36(h.D),g.Y36(s.V),g.Y36(m.uw),g.Y36(c.x4),g.Y36(f.F0))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-resource-detail-page"]],decls:4,vars:2,consts:[[1,"container-fluid","pl-xl-5","pr-xl-5","resource-theme"],["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-resource-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],["queryParamsHandling","merge",1,"resource-link",3,"routerLink"],[1,"text-muted"],["mat-icon-button","","aria-label","Edit resource",3,"click",4,"ngIf"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"mt-1","entity-info"],["queryParamsHandling","merge","class","resource-link",3,"routerLink",4,"ngIf"],["class","resource-link","queryParamsHandling","merge",3,"routerLink",4,"ngIf"],["mat-icon-button","","aria-label","Edit resource",3,"click"],["mat-icon-button","",3,"click"]],template:function(e,t){1&e&&(g.TgZ(0,"div",0),g._UZ(1,"perun-web-apps-back-button"),g.YNc(2,T,1,0,"mat-spinner",1),g.YNc(3,k,28,35,"div",2),g.qZA()),2&e&&(g.xp6(2),g.Q6J("ngIf",t.loading),g.xp6(1),g.Q6J("ngIf",!t.loading&&void 0!==t.resource))},directives:[v.W,A.O5,S.$g,b.Hw,R.gM,A.PC,f.yS,E.A,Z.lW],pipes:[I.X$],styles:[".break-line[_ngcontent-%COMP%]{display:inline-block}"],data:{animation:[r.Ji]}}),e}()},42473:function(t,n,r){"use strict";r.d(n,{K:function(){return Q}});var s=r(33642),o=r(4230),l=r(84608),c=r(67033),u=r(88426),d=r(31572),p=r(48160),g=r(61511),f=r(15980),h=r(67806);function m(e,t){1&e&&d._UZ(0,"mat-spinner",6)}function v(e,t){1&e&&d._UZ(0,"th",15)}function A(e,t){if(1&e&&(d.TgZ(0,"td",16),d._uU(1),d.qZA()),2&e){var i=t.$implicit;d.xp6(1),d.hij(" ",i.name," ")}}function S(e,t){1&e&&d._UZ(0,"tr",17)}function b(e,t){1&e&&d._UZ(0,"tr",18)}function R(e,t){if(1&e&&(d.TgZ(0,"div",7),d.TgZ(1,"p"),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"div",8),d._uU(5),d.ALo(6,"translate"),d.qZA(),d.TgZ(7,"table",9),d.ynx(8,10),d.YNc(9,v,1,0,"th",11),d.YNc(10,A,2,1,"td",12),d.BQk(),d.YNc(11,S,1,0,"tr",13),d.YNc(12,b,1,0,"tr",14),d.qZA(),d.qZA()),2&e){var i=d.oxw();d.xp6(2),d.hij(" ",d.lcZ(3,5,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DESCRIPTION")," "),d.xp6(3),d.hij(" ",d.lcZ(6,7,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.ASK")," "),d.xp6(2),d.Q6J("dataSource",i.dataSource),d.xp6(4),d.Q6J("matHeaderRowDef",i.displayedColumns),d.xp6(1),d.Q6J("matRowDefColumns",i.displayedColumns)}}var E=function(){var t=function(){function t(e,n,a,r,s){i(this,t),this.dialogRef=e,this.data=n,this.notificator=a,this.translate=r,this.resourceManager=s,this.displayedColumns=["name"],this.loading=!1}return a(t,[{key:"ngOnInit",value:function(){this.theme=this.data.theme,this.dataSource=new c.by(this.data.groups)}},{key:"onCancel",value:function(){this.dialogRef.close()}},{key:"onSubmit",value:function(){var t,i=this,n=[],a=e(this.data.groups);try{for(a.s();!(t=a.n()).done;){var r=t.value;n.push(r.id)}}catch(s){a.e(s)}finally{a.f()}this.loading=!0,this.resourceManager.removeGroupsFromResource(n,this.data.resourceId).subscribe(function(){i.translate.get("DIALOGS.REMOVE_GROUP_FROM_RESOURCE.SUCCESS").subscribe(function(e){i.notificator.showSuccess(e),i.dialogRef.close(!0)})},function(){return i.loading=!1})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(d.Y36(l.so),d.Y36(l.WI),d.Y36(u.V6),d.Y36(p.sK),d.Y36(s.xk))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-perun-web-apps-remove-group-from-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(d.TgZ(0,"div"),d.TgZ(1,"h1",0),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.YNc(4,m,1,0,"mat-spinner",1),d.YNc(5,R,13,9,"div",2),d.TgZ(6,"div",3),d.TgZ(7,"button",4),d.NdJ("click",function(){return t.onCancel()}),d._uU(8),d.ALo(9,"translate"),d.qZA(),d.TgZ(10,"button",5),d.NdJ("click",function(){return t.onSubmit()}),d._uU(11),d.ALo(12,"translate"),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.Tol(t.theme),d.xp6(2),d.Oqu(d.lcZ(3,9,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.TITLE")),d.xp6(2),d.Q6J("ngIf",t.loading),d.xp6(1),d.Q6J("ngIf",!t.loading),d.xp6(3),d.hij(" ",d.lcZ(9,11,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.CANCEL")," "),d.xp6(2),d.Q6J("disabled",t.loading),d.xp6(1),d.hij(" ",d.lcZ(12,13,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DELETE")," "))},directives:[l.uh,g.O5,l.H8,f.lW,h.$g,l.xY,c.BZ,c.w1,c.fO,c.Dz,c.as,c.nj,c.ge,c.ev,c.XQ,c.Gk],pipes:[p.X$],styles:[""]}),t}(),Z=r(60611),I=r(36922),T=r(91058),O=r(78364);function C(e,t){1&e&&d._UZ(0,"mat-spinner",6)}var _=function(){return["select","id","name","description"]};function y(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"div",7),d.TgZ(1,"perun-web-apps-debounce-filter",8),d.NdJ("filter",function(e){return d.CHM(i),d.oxw().applyFilter(e)}),d.ALo(2,"translate"),d.qZA(),d.TgZ(3,"perun-web-apps-groups-list",9),d.NdJ("page",function(e){return d.CHM(i),d.oxw().pageChanged(e)}),d.qZA(),d.qZA()}if(2&e){var n=d.oxw();d.xp6(1),d.s9C("placeholder",d.lcZ(2,8,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.FILTER_DESCRIPTION")),d.xp6(2),d.Q6J("pageSize",n.pageSize)("groups",n.unAssignedGroups)("selection",n.selection)("filter",n.filterValue)("displayedColumns",d.DdM(10,_))("disableRouting",!0)("disableMembers",!1)}}var x=function(){var t=function(){function t(e,n,a,r,s,l,c,u){i(this,t),this.dialogRef=e,this.data=n,this.notificator=a,this.translate=r,this.resourceManager=s,this.tableConfigService=l,this.groupService=c,this.guiAuthResolver=u,this.loading=!1,this.checkGroups=!1,this.selection=new o.Ov(!0,[]),this.filterValue="",this.tableId=Z.cL}return a(t,[{key:"ngOnInit",value:function(){var t=this;this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.theme=this.data.theme,this.resource=this.data.resource,this.resourceManager.getAssignedGroups(this.resource.id).subscribe(function(i){t.groupService.getAllGroups(t.resource.voId).subscribe(function(n){t.unAssignedGroups=n;var a,r=e(i);try{for(r.s();!(a=r.n()).done;){var s,o=a.value,l=e(n);try{for(l.s();!(s=l.n()).done;){var c=s.value;o.id===c.id&&t.unAssignedGroups.splice(t.unAssignedGroups.indexOf(c),1)}}catch(u){l.e(u)}finally{l.f()}}}catch(u){r.e(u)}finally{r.f()}t.loading=!1},function(){return t.loading=!1})},function(){return t.loading=!1})}},{key:"onCancel",value:function(){this.dialogRef.close()}},{key:"onAdd",value:function(){var t=this;if(this.checkGroups);else{this.loading=!0;var i,n=[],a=e(this.selection.selected);try{for(a.s();!(i=a.n()).done;){var r=i.value;n.push(r.id)}}catch(s){a.e(s)}finally{a.f()}this.resourceManager.assignGroupsToResource(n,this.resource.id).subscribe(function(){t.translate.get("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.SUCCESS_MESSAGE").subscribe(function(e){t.notificator.showSuccess(e),t.dialogRef.close(!0)})},function(){return t.loading=!1})}}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}},{key:"canAddGroups",value:function(){var e=this,t=!0;return this.selection.selected.forEach(function(i){e.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[e.resource,i])||(t=!1)}),t}}]),t}();return t.\u0275fac=function(e){return new(e||t)(d.Y36(l.so),d.Y36(l.WI),d.Y36(u.V6),d.Y36(p.sK),d.Y36(s.xk),d.Y36(Z.dB),d.Y36(s.ff),d.Y36(u.x4))},t.\u0275cmp=d.Xpm({type:t,selectors:[["app-perun-web-apps-assign-group-to-resource-dialog"]],decls:14,vars:19,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","","class","dialog-container",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent","matTooltipPosition","above",1,"ml-2",3,"disabled","matTooltipDisabled","matTooltip","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content","",1,"dialog-container"],[3,"placeholder","filter"],[3,"pageSize","groups","selection","filter","displayedColumns","disableRouting","disableMembers","page"]],template:function(e,t){1&e&&(d.TgZ(0,"div"),d.TgZ(1,"h1",0),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.YNc(4,C,1,0,"mat-spinner",1),d.YNc(5,y,4,11,"div",2),d.TgZ(6,"div",3),d.TgZ(7,"button",4),d.NdJ("click",function(){return t.onCancel()}),d._uU(8),d.ALo(9,"translate"),d.qZA(),d.TgZ(10,"button",5),d.NdJ("click",function(){return t.onAdd()}),d.ALo(11,"translate"),d._uU(12),d.ALo(13,"translate"),d.qZA(),d.qZA(),d.qZA()),2&e&&(d.Tol(t.theme),d.xp6(2),d.Oqu(d.lcZ(3,11,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.TITLE")),d.xp6(2),d.Q6J("ngIf",t.loading),d.xp6(1),d.Q6J("ngIf",!t.loading),d.xp6(3),d.hij(" ",d.lcZ(9,13,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.CANCEL_BUTTON")," "),d.xp6(2),d.s9C("matTooltip",d.lcZ(11,15,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ADD_TOOLTIP")),d.Q6J("disabled",0===t.selection.selected.length||!t.canAddGroups()||t.loading)("matTooltipDisabled",t.canAddGroups()),d.xp6(2),d.hij(" ",d.lcZ(13,17,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ADD_BUTTON")," "))},directives:[l.uh,g.O5,l.H8,f.lW,I.gM,h.$g,l.xY,T.P,O.W],pipes:[p.X$],styles:[""]}),t}(),N=r(27613),w=r(57629),D=r(59403),U=r(39571),L=["checkbox"];function k(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"button",9),d.NdJ("click",function(){return d.CHM(i),d.oxw().addGroup()}),d._uU(1),d.ALo(2,"translate"),d.qZA()}2&e&&(d.xp6(1),d.hij(" ",d.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_GROUPS.ADD_GROUP"),"\n"))}function M(e,t){1&e&&d._UZ(0,"mat-spinner",10)}var G=function(e){return[e]},Y=function(){return["select","id","name","description","status"]};function q(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"div",11),d.TgZ(1,"perun-web-apps-groups-list",12),d.NdJ("page",function(e){return d.CHM(i),d.oxw().pageChanged(e)}),d.qZA(),d.qZA()}if(2&e){var n=d.oxw();d.xp6(1),d.Q6J("pageSize",n.pageSize)("groups",n.assignedGroups)("filter",n.filteredValue)("selection",n.selected)("disableMembers",!1)("disableRouting",!n.guiAuthResolver.isAuthorized("getGroupById_int_policy",d.VKq(7,G,n.assignedGroups[0])))("displayedColumns",d.DdM(9,Y))}}function J(e,t){1&e&&(d.TgZ(0,"app-alert",13),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&e&&(d.xp6(1),d.hij(" ",d.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_GROUPS.NO_GROUPS"),"\n"))}var Q=function(){var e=function(){function e(t,n,a,r,s,l){i(this,e),this.route=t,this.resourcesManager=n,this.vosManagerService=a,this.tableConfigService=r,this.dialog=s,this.guiAuthResolver=l,this.assignedGroups=[],this.selected=new o.Ov(!0,[]),this.filteredValue="",this.tableId=Z.Ad}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.loading=!0,this.route.parent.params.subscribe(function(t){e.resourceId=t.resourceId,e.getDataForAuthorization(),e.loadAllGroups()})}},{key:"loadAllGroups",value:function(){var e=this;this.loading=!0,this.resourcesManager.getGroupAssignments(this.resourceId).subscribe(function(t){e.assignedGroups=t.map(function(e){var t=e.enrichedGroup.group;return t.status=e.status,t}),e.selected.clear(),e.loading=!1})}},{key:"addGroup",value:function(){var e=this,t=(0,N.kZ)();t.width="800px",t.data={theme:"resource-theme",resource:this.resource},this.dialog.open(x,t).afterClosed().subscribe(function(t){t&&e.loadAllGroups()})}},{key:"removeGroups",value:function(){var e=this,t=(0,N.kZ)();t.width="500px",t.data={resourceId:this.resourceId,groups:this.selected.selected,theme:"resource-theme"},this.dialog.open(E,t).afterClosed().subscribe(function(t){t&&e.loadAllGroups()})}},{key:"canRemoveGroups",value:function(){var e=this,t=!0;return this.selected.selected.forEach(function(i){e.guiAuthResolver.isAuthorized("removeGroupsFromResource_List<Group>_Resource_policy",[e.resource,i])||(t=!1)}),t}},{key:"applyFilter",value:function(e){this.filteredValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}},{key:"getDataForAuthorization",value:function(){var e=this;this.loadingResource=!0,this.resourcesManager.getResourceById(this.resourceId).subscribe(function(t){e.resource=t,e.loadingResource=!1})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(d.Y36(w.gz),d.Y36(s.xk),d.Y36(s.YF),d.Y36(Z.dB),d.Y36(l.uw),d.Y36(u.x4))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-perun-web-apps-resource-groups"]],viewQuery:function(e,t){var i;(1&e&&d.Gf(L,7),2&e)&&(d.iGM(i=d.CRH())&&(t.checkbox=i.first))},decls:14,vars:18,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","mat-flat-button","",1,"ml-2","mr-2",3,"disabled","click"],[3,"matTooltipDisabled","matTooltip"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["alert_type","warn",4,"ngIf"],["color","accent","mat-flat-button","",3,"click"],[1,"ml-auto","mr-auto"],[1,"mt-3"],[3,"pageSize","groups","filter","selection","disableMembers","disableRouting","displayedColumns","page"],["alert_type","warn"]],template:function(e,t){1&e&&(d.TgZ(0,"h1",0),d._uU(1),d.ALo(2,"translate"),d.qZA(),d.TgZ(3,"perun-web-apps-refresh-button",1),d.NdJ("refresh",function(){return t.loadAllGroups()}),d.qZA(),d.YNc(4,k,3,3,"button",2),d.TgZ(5,"button",3),d.NdJ("click",function(){return t.removeGroups()}),d.TgZ(6,"span",4),d.ALo(7,"translate"),d._uU(8),d.ALo(9,"translate"),d.qZA(),d.qZA(),d.TgZ(10,"perun-web-apps-debounce-filter",5),d.NdJ("filter",function(e){return t.applyFilter(e)}),d.qZA(),d.YNc(11,M,1,0,"mat-spinner",6),d.YNc(12,q,2,10,"div",7),d.YNc(13,J,3,3,"app-alert",8)),2&e&&(d.xp6(1),d.Oqu(d.lcZ(2,10,"RESOURCE_DETAIL.ASSIGNED_GROUPS.TITLE")),d.xp6(3),d.Q6J("ngIf",!t.loadingResource&&t.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",d.VKq(16,G,t.resource))),d.xp6(1),d.Q6J("disabled",0===t.selected.selected.length||!t.canRemoveGroups()),d.xp6(1),d.s9C("matTooltip",d.lcZ(7,12,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_TOOLTIP")),d.Q6J("matTooltipDisabled",t.canRemoveGroups()),d.xp6(2),d.hij(" ",d.lcZ(9,14,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_GROUP")," "),d.xp6(2),d.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_GROUPS.FILTER_GROUPS"),d.xp6(1),d.Q6J("ngIf",t.loading),d.xp6(1),d.Q6J("ngIf",!t.loading&&0!==t.assignedGroups.length),d.xp6(1),d.Q6J("ngIf",0===t.assignedGroups.length&&!t.loading))},directives:[D.t,g.O5,f.lW,I.gM,T.P,h.$g,O.W,U.w],pipes:[p.X$],styles:[""]}),e}()},76527:function(e,t,n){"use strict";n.d(t,{H:function(){return f}});var r=n(33642),s=n(88426),o=n(31572),l=n(57629),c=n(61511),u=n(67806),d=n(8557);function p(e,t){1&e&&o._UZ(0,"mat-spinner",2)}function g(e,t){if(1&e&&(o.TgZ(0,"div"),o._UZ(1,"perun-web-apps-menu-buttons-field",3),o.qZA()),2&e){var i=o.oxw();o.xp6(1),o.Q6J("items",i.navItems)("size","small")}}var f=function(){var e=function(){function e(t,n,a){i(this,e),this.resourcesManager=t,this.route=n,this.guiAuthResolver=a,this.navItems=[],this.loading=!1}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.params.subscribe(function(t){e.resourcesManager.getResourceById(t.resourceId).subscribe(function(t){e.resource=t,e.initItems("facilities"!==e.route.parent.parent.snapshot.url[0].path),e.loading=!1},function(){return e.loading=!1})})}},{key:"initItems",value:function(e){var t=e?"/organizations/".concat(this.resource.voId):"/facilities/".concat(this.resource.facilityId);this.navItems=[],this.guiAuthResolver.isAuthorized("getAssignedGroups_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-group",url:"".concat(t,"/resources/").concat(this.resource.id,"/groups"),label:"MENU_ITEMS.RESOURCE.ASSIGNED_GROUPS",style:"resource-btn"}),this.guiAuthResolver.isAuthorized("getAssignedServices_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-service",url:"/".concat(t,"/resources/").concat(this.resource.id,"/services"),label:"MENU_ITEMS.RESOURCE.ASSIGNED_SERVICES",style:"resource-btn"}),this.guiAuthResolver.isAuthorized("getAssignedMembers_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-user",url:"".concat(t,"/resources/").concat(this.resource.id,"/members"),label:"MENU_ITEMS.RESOURCE.ASSIGNED_MEMBERS",style:"resource-btn"}),this.navItems.push({cssIcon:"perun-attributes",url:"".concat(t,"/resources/").concat(this.resource.id,"/attributes"),label:"MENU_ITEMS.RESOURCE.ATTRIBUTES",style:"resource-btn"}),this.guiAuthResolver.isManagerPagePrivileged(this.resource)&&this.navItems.push({cssIcon:"perun-settings2",url:"".concat(t,"/resources/").concat(this.resource.id,"/settings"),label:"MENU_ITEMS.RESOURCE.SETTINGS",style:"resource-btn"})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Y36(r.xk),o.Y36(l.gz),o.Y36(s.x4))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-resource-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&o.ekj("router-component",t.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(o.YNc(0,p,1,0,"mat-spinner",0),o.YNc(1,g,2,2,"div",1)),2&e&&(o.Q6J("ngIf",t.loading),o.xp6(1),o.Q6J("ngIf",!t.loading))},directives:[c.O5,u.$g,d.L],styles:[""]}),e}()},64359:function(e,t,n){"use strict";n.d(t,{O:function(){return p}});var r=n(33642),s=n(88426),o=n(31572),l=n(57629),c=n(61511),u=n(489);function d(e,t){if(1&e&&o._UZ(0,"app-managers-page",1),2&e){var i=o.oxw();o.Q6J("complementaryObject",i.resource)("complementaryObjectType",i.type)("theme",i.theme)("availableRoles",i.availableRoles)}}var p=function(){var e=function(){function e(t,n,a){i(this,e),this.route=t,this.resourceService=n,this.guiAuthResolver=a,this.availableRoles=[],this.type="Resource",this.theme="resource-theme"}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.route.parent.parent.params.subscribe(function(t){e.resourceService.getResourceById(t.resourceId).subscribe(function(t){e.resource=t})}),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Resource")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Y36(l.gz),o.Y36(r.xk),o.Y36(s.x4))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-resource-settings-managers"]],decls:1,vars:1,consts:[[3,"complementaryObject","complementaryObjectType","theme","availableRoles",4,"ngIf"],[3,"complementaryObject","complementaryObjectType","theme","availableRoles"]],template:function(e,t){1&e&&o.YNc(0,d,1,4,"app-managers-page",0),2&e&&o.Q6J("ngIf",t.resource)},directives:[c.O5,u.s],styles:[""]}),e}()},22927:function(e,t,n){"use strict";n.d(t,{h:function(){return f}});var r=n(33642),s=n(88426),o=n(31572),l=n(57629),c=n(61511),u=n(67806),d=n(8557);function p(e,t){1&e&&o._UZ(0,"mat-spinner",2)}function g(e,t){if(1&e&&(o.TgZ(0,"div"),o._UZ(1,"perun-web-apps-menu-buttons-field",3),o.qZA()),2&e){var i=o.oxw();o.xp6(1),o.Q6J("items",i.items)("size","small")}}var f=function(){var e=function(){function e(t,n,a){i(this,e),this.route=t,this.resourceManager=n,this.authResolver=a,this.items=[],this.loading=!1}return a(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.parent.parent.params.subscribe(function(t){e.resourceManager.getResourceById(t.resourceId).subscribe(function(t){e.resource=t,e.initItems("facilities"!==e.route.parent.parent.parent.snapshot.url[0].path),e.loading=!1},function(){return e.loading=!1})})}},{key:"initItems",value:function(e){this.items=[],this.authResolver.isManagerPagePrivileged(this.resource)&&this.items.push({cssIcon:"perun-manager",url:"".concat(e?"/organizations/".concat(this.resource.voId):"/facilities/".concat(this.resource.facilityId),"/resources/").concat(this.resource.id,"/settings/managers"),label:"MENU_ITEMS.RESOURCE.MANAGERS",style:"resource-btn"})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(o.Y36(l.gz),o.Y36(r.xk),o.Y36(s.x4))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-resource-settings-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&o.ekj("router-component",t.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(o.YNc(0,p,1,0,"mat-spinner",0),o.YNc(1,g,2,2,"div",1)),2&e&&(o.Q6J("ngIf",t.loading),o.xp6(1),o.Q6J("ngIf",!t.loading))},directives:[c.O5,u.$g,d.L],styles:[""]}),e}()},77968:function(e,t,n){"use strict";n.d(t,{t:function(){return l}});var r=n(17),s=n(31572),o=n(21575),l=function(){var e=function(){function e(){i(this,e)}return a(e,[{key:"ngOnInit",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-resource-settings"]],hostVars:2,hostBindings:function(e,t){2&e&&s.ekj("router-component",t.true)},decls:1,vars:0,template:function(e,t){1&e&&s._UZ(0,"app-animated-router-outlet")},directives:[o.A],styles:[""],data:{animation:[r.Ji]}}),e}()},489:function(t,n,r){"use strict";r.d(n,{s:function(){return Ue}});var s=r(4230),o=r(84608),l=r(88426),c=r(33642),u=r(60611),d=r(67004),p=r(16073),g=r(31572),f=r(48160),h=r(57629),m=r(66283),v=r(4786),A=r(61511),S=r(80340),b=r(15980),R=r(71522),E=r(67806),Z=r(39571),I=r(86593),T=function(){var e=function(){function e(t){i(this,e),this.translate=t,this.prefix="ROLES."}return a(e,[{key:"transform",value:function(e,t){var i=this.prefix.concat(e);return this.translate.instant(i)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(f.sK,16))},e.\u0275pipe=g.Yjl({name:"displayedRole",type:e,pure:!0}),e}();function O(e,t){if(1&e&&(g.TgZ(0,"mat-option",15),g._uU(1),g.ALo(2,"displayedRole"),g.qZA()),2&e){var i=t.$implicit;g.Q6J("value",i),g.xp6(1),g.Oqu(g.lcZ(2,2,i))}}function C(e,t){1&e&&g._UZ(0,"mat-spinner",16)}function _(e,t){1&e&&(g.TgZ(0,"app-alert",20),g._uU(1),g.ALo(2,"translate"),g.qZA()),2&e&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"DIALOGS.ADD_MANAGERS.NO_USERS_FOUND")," "))}var y=function(){return["select","id","name","email","logins","organization"]};function x(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"app-users-list",21),g.NdJ("page",function(e){return g.CHM(i),g.oxw(2).pageChanged(e)}),g.qZA()}if(2&e){var n=g.oxw(2);g.Q6J("pageSize",n.pageSize)("disableRouting",!0)("selection",n.selection)("displayedColumns",g.DdM(5,y))("users",n.users)}}function N(e,t){if(1&e&&(g.TgZ(0,"div",17),g.YNc(1,_,3,3,"app-alert",18),g.YNc(2,x,1,6,"app-users-list",19),g.qZA()),2&e){var i=g.oxw();g.xp6(1),g.Q6J("ngIf",0===i.users.length&&i.firstSearchDone),g.xp6(1),g.Q6J("ngIf",0!==i.users.length)}}var w=function(){var e=function(){function e(t,n,a,r,o,l,c,d,p,g){var f=this;i(this,e),this.dialogRef=t,this.data=n,this.authzService=a,this.usersService=r,this.translate=o,this.notificator=l,this.storeService=c,this.route=d,this.router=p,this.tableConfigService=g,this.selection=new s.Ov(!0,[]),this.users=[],this.firstSearchDone=!1,this.tableId=u.H2,o.get("DIALOGS.ADD_MANAGERS.TITLE").subscribe(function(e){return f.title=e}),o.get("DIALOGS.ADD_MANAGERS.SUCCESS").subscribe(function(e){return f.successMessage=e})}return a(e,[{key:"ngOnInit",value:function(){this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.theme=this.data.theme,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.searchCtrl=new p.NI("",[p.kI.required,p.kI.pattern(".*[\\S]+.*")])}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}},{key:"onSubmit",value:function(){var e=this;this.loading=!0,this.authzService.setRoleWithUserComplementaryObject({role:this.selectedRole,users:this.selection.selected.map(function(e){return e.id}),complementaryObject:this.data.complementaryObject}).subscribe(function(){e.notificator.showSuccess(e.successMessage),e.loading=!1,e.dialogRef.close(!0)},function(){return e.loading=!1})}},{key:"onSearchByString",value:function(){var e=this;if(this.searchCtrl.invalid)this.searchCtrl.markAllAsTouched();else{this.loading=!0,this.selection.clear();var t=[d.r.USER_DEF_ORGANIZATION,d.r.USER_DEF_PREFERRED_MAIL];t=t.concat(this.storeService.getLoginAttributeNames()),this.usersService.findRichUsersWithAttributes(this.searchCtrl.value,t).subscribe(function(t){e.users=t,e.loading=!1,e.firstSearchDone=!0},function(){return e.loading=!1})}}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(o.so),g.Y36(o.WI),g.Y36(c.Ct),g.Y36(c.Fv),g.Y36(f.sK),g.Y36(l.V6),g.Y36(l.d6),g.Y36(h.gz),g.Y36(h.F0),g.Y36(u.dB))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-add-manager-dialog"]],decls:32,vars:31,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"mr-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"mr-2","w-100"],["matInput","","autocomplete","false",3,"placeholder","formControl","keyup.enter"],["mat-flat-button","","color","accent",1,"ml-auto",3,"disabled","click"],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[3,"value"],[1,"mr-auto","ml-auto"],[1,"mt-3"],["alert_type","warn",4,"ngIf"],[3,"pageSize","disableRouting","selection","displayedColumns","users","page",4,"ngIf"],["alert_type","warn"],[3,"pageSize","disableRouting","selection","displayedColumns","users","page"]],template:function(e,t){1&e&&(g.TgZ(0,"div"),g.TgZ(1,"h1",0),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"div",1),g.TgZ(5,"div",2),g.TgZ(6,"mat-form-field",3),g.TgZ(7,"mat-label"),g._uU(8),g.ALo(9,"translate"),g.qZA(),g.TgZ(10,"mat-select",4),g.NdJ("valueChange",function(e){return t.selectedRole=e}),g.YNc(11,O,3,4,"mat-option",5),g.qZA(),g.qZA(),g.TgZ(12,"mat-form-field",6),g.TgZ(13,"label"),g.TgZ(14,"input",7),g.NdJ("keyup.enter",function(){return t.onSearchByString()}),g.ALo(15,"translate"),g.qZA(),g.qZA(),g.TgZ(16,"mat-error"),g._uU(17),g.ALo(18,"translate"),g.qZA(),g.qZA(),g.qZA(),g.TgZ(19,"button",8),g.NdJ("click",function(){return t.onSearchByString()}),g._uU(20),g.ALo(21,"translate"),g.qZA(),g.TgZ(22,"div",9),g.YNc(23,C,1,0,"mat-spinner",10),g.qZA(),g.YNc(24,N,3,2,"div",11),g.qZA(),g.TgZ(25,"div",12),g.TgZ(26,"button",13),g.NdJ("click",function(){return t.onCancel()}),g._uU(27),g.ALo(28,"translate"),g.qZA(),g.TgZ(29,"button",14),g.NdJ("click",function(){return t.onSubmit()}),g._uU(30),g.ALo(31,"translate"),g.qZA(),g.qZA(),g.qZA()),2&e&&(g.Tol(t.theme),g.xp6(2),g.Oqu(g.lcZ(3,17,"DIALOGS.ADD_MANAGERS.TITLE")),g.xp6(6),g.Oqu(g.lcZ(9,19,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),g.xp6(2),g.Q6J("value",t.selectedRole),g.xp6(1),g.Q6J("ngForOf",t.availableRoles),g.xp6(3),g.s9C("placeholder",g.lcZ(15,21,"DIALOGS.ADD_MANAGERS.DESCRIPTION")),g.Q6J("formControl",t.searchCtrl),g.xp6(3),g.hij(" ",g.lcZ(18,23,"DIALOGS.ADD_MANAGERS.EMPTY_SEARCH_MESSAGE")," "),g.xp6(2),g.Q6J("disabled",t.loading),g.xp6(1),g.hij(" ",g.lcZ(21,25,"DIALOGS.ADD_MANAGERS.SEARCH")," "),g.xp6(3),g.Q6J("ngIf",t.loading),g.xp6(1),g.Q6J("ngIf",null!==t.users&&!t.loading),g.xp6(3),g.hij(" ",g.lcZ(28,27,"DIALOGS.ADD_MANAGERS.CANCEL")," "),g.xp6(2),g.Q6J("disabled",0===t.selection.selected.length||void 0===t.selectedRole||t.loading),g.xp6(1),g.hij(" ",g.lcZ(31,29,"DIALOGS.ADD_MANAGERS.CREATE")," "))},directives:[o.uh,o.xY,m.KE,m.hX,v.gD,A.sg,S.Nt,p.Fj,p.JJ,p.oH,m.TO,b.lW,A.O5,o.H8,R.ey,E.$g,Z.w,I.C],pipes:[f.X$,T],styles:[".inline-dialog-items[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]}),e}(),D=r(67033);function U(e,t){1&e&&g._UZ(0,"th",14)}function L(e,t){if(1&e&&(g.TgZ(0,"td",15),g._uU(1),g.qZA()),2&e){var i=t.$implicit;g.xp6(1),g.AsE(" ",i.firstName," ",i.lastName,"")}}function k(e,t){1&e&&g._UZ(0,"tr",16)}function M(e,t){1&e&&g._UZ(0,"tr",17)}function G(e,t){if(1&e&&(g.TgZ(0,"div",6),g.TgZ(1,"p"),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"div",7),g._uU(5),g.ALo(6,"translate"),g.qZA(),g.TgZ(7,"table",8),g.ynx(8,9),g.YNc(9,U,1,0,"th",10),g.YNc(10,L,2,2,"td",11),g.BQk(),g.YNc(11,k,1,0,"tr",12),g.YNc(12,M,1,0,"tr",13),g.qZA(),g.qZA()),2&e){var i=g.oxw();g.xp6(2),g.hij(" ",g.lcZ(3,5,"DIALOGS.REMOVE_MANAGERS.DESCRIPTION")," "),g.xp6(3),g.hij(" ",g.lcZ(6,7,"DIALOGS.REMOVE_MANAGERS.ASK")," "),g.xp6(2),g.Q6J("dataSource",i.dataSource),g.xp6(4),g.Q6J("matHeaderRowDef",i.displayedColumns),g.xp6(1),g.Q6J("matRowDefColumns",i.displayedColumns)}}function Y(e,t){1&e&&g._UZ(0,"mat-spinner",18)}var q=function(){var e=function(){function e(t,n,a,r,s){i(this,e),this.dialogRef=t,this.data=n,this.notificator=a,this.translate=r,this.authzService=s,this.displayedColumns=["name"]}return a(e,[{key:"ngOnInit",value:function(){this.dataSource=new D.by(this.data.managers),this.theme=this.data.theme}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}},{key:"onSubmit",value:function(){var e=this;this.loading=!0,this.authzService.unsetRoleWithUserComplementaryObject({role:this.data.role,users:this.data.managers.map(function(e){return e.id}),complementaryObject:this.data.complementaryObject}).subscribe(function(){e.translate.get("DIALOGS.REMOVE_MANAGERS.SUCCESS").subscribe(function(t){e.notificator.showSuccess(t),e.loading=!1,e.dialogRef.close(!0)},function(){return e.loading=!1})},function(){return e.loading=!1})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(o.so),g.Y36(o.WI),g.Y36(l.V6),g.Y36(f.sK),g.Y36(c.Ct))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-remove-manager-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content","",4,"ngIf"],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""],[1,"mr-auto","ml-auto"]],template:function(e,t){1&e&&(g.TgZ(0,"div"),g.TgZ(1,"h1",0),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.YNc(4,G,13,9,"div",1),g.YNc(5,Y,1,0,"mat-spinner",2),g.TgZ(6,"div",3),g.TgZ(7,"button",4),g.NdJ("click",function(){return t.onCancel()}),g._uU(8),g.ALo(9,"translate"),g.qZA(),g.TgZ(10,"button",5),g.NdJ("click",function(){return t.onSubmit()}),g._uU(11),g.ALo(12,"translate"),g.qZA(),g.qZA(),g.qZA()),2&e&&(g.Tol(t.theme),g.xp6(2),g.Oqu(g.lcZ(3,9,"DIALOGS.REMOVE_MANAGERS.TITLE")),g.xp6(2),g.Q6J("ngIf",!t.loading),g.xp6(1),g.Q6J("ngIf",t.loading),g.xp6(3),g.hij(" ",g.lcZ(9,11,"DIALOGS.REMOVE_MANAGERS.CANCEL")," "),g.xp6(2),g.Q6J("disabled",t.loading),g.xp6(1),g.hij(" ",g.lcZ(12,13,"DIALOGS.REMOVE_MANAGERS.DELETE")," "))},directives:[o.uh,A.O5,o.H8,b.lW,o.xY,D.BZ,D.w1,D.fO,D.Dz,D.as,D.nj,D.ge,D.ev,D.XQ,D.Gk,E.$g],pipes:[f.X$],styles:[""]}),e}();function J(e,t){1&e&&g._UZ(0,"mat-spinner",6)}function Q(e,t){1&e&&g._UZ(0,"th",15)}function z(e,t){if(1&e&&(g.TgZ(0,"td",16),g._uU(1),g.qZA()),2&e){var i=t.$implicit;g.xp6(1),g.hij(" ",i.name,"")}}function P(e,t){1&e&&g._UZ(0,"tr",17)}function V(e,t){1&e&&g._UZ(0,"tr",18)}function j(e,t){if(1&e&&(g.TgZ(0,"div",7),g.TgZ(1,"p"),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"div",8),g._uU(5),g.ALo(6,"translate"),g.qZA(),g.TgZ(7,"table",9),g.ynx(8,10),g.YNc(9,Q,1,0,"th",11),g.YNc(10,z,2,1,"td",12),g.BQk(),g.YNc(11,P,1,0,"tr",13),g.YNc(12,V,1,0,"tr",14),g.qZA(),g.qZA()),2&e){var i=g.oxw();g.xp6(2),g.hij(" ",g.lcZ(3,5,"DIALOGS.REMOVE_GROUPS.DESCRIPTION")," "),g.xp6(3),g.hij(" ",g.lcZ(6,7,"DIALOGS.REMOVE_GROUPS.ASK")," "),g.xp6(2),g.Q6J("dataSource",i.dataSource),g.xp6(4),g.Q6J("matHeaderRowDef",i.displayedColumns),g.xp6(1),g.Q6J("matRowDefColumns",i.displayedColumns)}}var F=function(){var e=function(){function e(t,n,a,r,s){i(this,e),this.dialogRef=t,this.data=n,this.notificator=a,this.translate=r,this.authzService=s,this.displayedColumns=["name"]}return a(e,[{key:"ngOnInit",value:function(){this.dataSource=new D.by(this.data.groups),this.theme=this.data.theme}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}},{key:"onSubmit",value:function(){var e=this;this.loading=!0,this.authzService.unsetRoleWithGroupComplementaryObject({role:this.data.role,authorizedGroups:this.data.groups.map(function(e){return e.id}),complementaryObject:this.data.complementaryObject}).subscribe(function(){e.translate.get("DIALOGS.REMOVE_GROUPS.SUCCESS").subscribe(function(t){e.notificator.showSuccess(t),e.loading=!1,e.dialogRef.close(!0)},function(){return e.loading=!1})},function(){return e.loading=!1})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(o.so),g.Y36(o.WI),g.Y36(l.V6),g.Y36(f.sK),g.Y36(c.Ct))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-remove-group-manager-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(g.TgZ(0,"div"),g.TgZ(1,"h1",0),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.YNc(4,J,1,0,"mat-spinner",1),g.YNc(5,j,13,9,"div",2),g.TgZ(6,"div",3),g.TgZ(7,"button",4),g.NdJ("click",function(){return t.onCancel()}),g._uU(8),g.ALo(9,"translate"),g.qZA(),g.TgZ(10,"button",5),g.NdJ("click",function(){return t.onSubmit()}),g._uU(11),g.ALo(12,"translate"),g.qZA(),g.qZA(),g.qZA()),2&e&&(g.Tol(t.theme),g.xp6(2),g.Oqu(g.lcZ(3,9,"DIALOGS.REMOVE_GROUPS.TITLE")),g.xp6(2),g.Q6J("ngIf",t.loading),g.xp6(1),g.Q6J("ngIf",!t.loading),g.xp6(3),g.hij(" ",g.lcZ(9,11,"DIALOGS.REMOVE_GROUPS.CANCEL")," "),g.xp6(2),g.Q6J("disabled",t.loading),g.xp6(1),g.hij(" ",g.lcZ(12,13,"DIALOGS.REMOVE_GROUPS.DELETE")," "))},directives:[o.uh,A.O5,o.H8,b.lW,E.$g,o.xY,D.BZ,D.w1,D.fO,D.Dz,D.as,D.nj,D.ge,D.ev,D.XQ,D.Gk],pipes:[f.X$],styles:[""]}),e}(),H=r(56238),B=r(79996),$=r(40084),X=r(91058),W=r(78364);function K(e,t){if(1&e&&(g.TgZ(0,"mat-option",17),g._uU(1),g.ALo(2,"displayedRole"),g.qZA()),2&e){var i=t.$implicit;g.Q6J("value",i),g.xp6(1),g.Oqu(g.lcZ(2,2,i))}}function ee(e,t){if(1&e&&(g.TgZ(0,"mat-option",17),g._uU(1),g.qZA()),2&e){var i=t.$implicit;g.Q6J("value",i),g.xp6(1),g.hij(" ",i.name," ")}}function te(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"perun-web-apps-debounce-filter",18),g.NdJ("filter",function(e){return g.CHM(i),g.oxw().applyFilter(e)}),g.ALo(1,"translate"),g.qZA()}2&e&&g.s9C("placeholder",g.lcZ(1,1,"DIALOGS.ADD_GROUPS.FILTER_GROUPS"))}function ie(e,t){1&e&&g._UZ(0,"mat-spinner",19)}var ne=function(){return["select","id","name","description"]};function ae(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"div",20),g.TgZ(1,"perun-web-apps-groups-list",21),g.NdJ("page",function(e){return g.CHM(i),g.oxw().pageChanged(e)}),g.qZA(),g.qZA()}if(2&e){var n=g.oxw();g.xp6(1),g.Q6J("pageSize",n.pageSize)("disableRouting",!0)("displayedColumns",g.DdM(7,ne))("selection",n.selection)("filter",n.filterValue)("groups",n.groups)("disableMembers",!1)}}var re=function(){var e=function(){function e(t,n,a,r,o,l,c,d,g,f){var h=this;i(this,e),this.dialogRef=t,this.data=n,this.authzService=a,this.voService=r,this.groupService=o,this.translate=l,this.notificator=c,this.route=d,this.tableConfigService=g,this.router=f,this.searchString="",this.selection=new s.Ov(!0,[]),this.groups=[],this.vos=[],this.filterValue="",this.myControl=new p.NI,this.firstSearchDone=!1,this.tableId=u.kZ,l.get("DIALOGS.ADD_GROUPS.TITLE").subscribe(function(e){return h.title=e}),l.get("DIALOGS.ADD_GROUPS.SUCCESS").subscribe(function(e){return h.successMessage=e})}return a(e,[{key:"displayFn",value:function(e){return e?e.name:null}},{key:"onCancel",value:function(){this.dialogRef.close()}},{key:"onSubmit",value:function(){var e=this;this.loading=!0,this.authzService.setRoleWithGroupComplementaryObject({role:this.selectedRole,authorizedGroups:this.selection.selected.map(function(e){return e.id}),complementaryObject:this.data.complementaryObject}).subscribe(function(){e.notificator.showSuccess(e.successMessage),e.loading=!1,e.dialogRef.close()},function(){return e.loading=!1})}},{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.theme=this.data.theme,this.voService.getMyVos().subscribe(function(t){e.filteredOptions=e.myControl.valueChanges.pipe((0,H.O)(""),(0,B.U)(function(t){return e._filter(t)})),e.vos=t,e.loading=!1},function(){return e.loading=!1})}},{key:"_filter",value:function(e){var t="string"==typeof e?e.toLowerCase():e.name.toLowerCase;return this.vos.filter(function(e){return e.name.toLowerCase().includes(t)})}},{key:"showVoGroups",value:function(e){var t=this;this.loading=!0,this.groupService.getAllGroups(e.option.value.id).subscribe(function(e){t.groups=e,t.loading=!1,t.firstSearchDone=!0},function(){return t.loading=!1})}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}},{key:"applyFilter",value:function(e){this.filterValue=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.Y36(o.so),g.Y36(o.WI),g.Y36(c.Ct),g.Y36(c.YF),g.Y36(c.ff),g.Y36(f.sK),g.Y36(l.V6),g.Y36(h.gz),g.Y36(u.dB),g.Y36(h.F0))},e.\u0275cmp=g.Xpm({type:e,selectors:[["app-add-group-manager-dialog"]],decls:33,vars:33,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"mr-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"mr-2","w-75"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"placeholder","filter",4,"ngIf"],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[3,"value"],[3,"placeholder","filter"],[1,"mr-auto","ml-auto"],[1,"mt-3"],[3,"pageSize","disableRouting","displayedColumns","selection","filter","groups","disableMembers","page"]],template:function(e,t){if(1&e&&(g.TgZ(0,"div"),g.TgZ(1,"h1",0),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"div",1),g.TgZ(5,"div",2),g.TgZ(6,"mat-form-field",3),g.TgZ(7,"mat-label"),g._uU(8),g.ALo(9,"translate"),g.qZA(),g.TgZ(10,"mat-select",4),g.NdJ("valueChange",function(e){return t.selectedRole=e}),g.YNc(11,K,3,4,"mat-option",5),g.qZA(),g.qZA(),g.TgZ(12,"mat-form-field",6),g.TgZ(13,"mat-label"),g._uU(14),g.ALo(15,"translate"),g.qZA(),g._UZ(16,"input",7),g.ALo(17,"translate"),g.TgZ(18,"mat-autocomplete",8,9),g.NdJ("optionSelected",function(e){return t.showVoGroups(e)}),g.YNc(20,ee,2,2,"mat-option",5),g.ALo(21,"async"),g.qZA(),g.qZA(),g.qZA(),g.YNc(22,te,2,3,"perun-web-apps-debounce-filter",10),g.TgZ(23,"div",11),g.YNc(24,ie,1,0,"mat-spinner",12),g.qZA(),g.YNc(25,ae,2,8,"div",13),g.qZA(),g.TgZ(26,"div",14),g.TgZ(27,"button",15),g.NdJ("click",function(){return t.onCancel()}),g._uU(28),g.ALo(29,"translate"),g.qZA(),g.TgZ(30,"button",16),g.NdJ("click",function(){return t.onSubmit()}),g._uU(31),g.ALo(32,"translate"),g.qZA(),g.qZA(),g.qZA()),2&e){var i=g.MAs(19);g.Tol(t.theme),g.xp6(2),g.Oqu(g.lcZ(3,19,"DIALOGS.ADD_GROUPS.TITLE")),g.xp6(6),g.Oqu(g.lcZ(9,21,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),g.xp6(2),g.Q6J("value",t.selectedRole),g.xp6(1),g.Q6J("ngForOf",t.availableRoles),g.xp6(3),g.Oqu(g.lcZ(15,23,"DIALOGS.ADD_GROUPS.SELECT_VO")),g.xp6(2),g.s9C("placeholder",g.lcZ(17,25,"DIALOGS.ADD_GROUPS.SELECT_VO")),g.Q6J("formControl",t.myControl)("matAutocomplete",i),g.xp6(2),g.Q6J("displayWith",t.displayFn),g.xp6(2),g.Q6J("ngForOf",g.lcZ(21,27,t.filteredOptions)),g.xp6(2),g.Q6J("ngIf",null!==t.groups&&t.groups.length>0&&!t.loading),g.xp6(2),g.Q6J("ngIf",t.loading),g.xp6(1),g.Q6J("ngIf",null!==t.groups&&!t.loading),g.xp6(3),g.hij(" ",g.lcZ(29,29,"DIALOGS.ADD_MANAGERS.CANCEL")," "),g.xp6(2),g.Q6J("disabled",0===t.selection.selected.length||t.loading),g.xp6(1),g.hij(" ",g.lcZ(32,31,"DIALOGS.ADD_MANAGERS.CREATE")," ")}},directives:[o.uh,o.xY,m.KE,m.hX,v.gD,A.sg,S.Nt,p.Fj,$.ZL,p.JJ,p.oH,$.XC,A.O5,o.H8,b.lW,R.ey,X.P,E.$g,W.W],pipes:[f.X$,A.Ov,T],styles:[""]}),e}(),se=r(27613),oe=r(55109),le=r(59403);function ce(e,t){1&e&&(g._uU(0),g.ALo(1,"translate")),2&e&&g.hij(" ",g.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.USER")," ")}function ue(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"perun-web-apps-refresh-button",11),g.NdJ("refresh",function(){return g.CHM(i),g.oxw(2).refreshUsers()}),g.qZA()}}function de(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"button",12),g.NdJ("click",function(){return g.CHM(i),g.oxw(2).addManager()}),g._uU(1),g.ALo(2,"translate"),g.qZA()}2&e&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function pe(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"button",13),g.NdJ("click",function(){return g.CHM(i),g.oxw(2).removeManager()}),g._uU(1),g.ALo(2,"translate"),g.qZA()}if(2&e){var n=g.oxw(2);g.Q6J("disabled",0===n.selectionUsers.selected.length),g.xp6(1),g.hij(" ",g.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function ge(e,t){if(1&e&&(g.TgZ(0,"mat-option",17),g._uU(1),g.ALo(2,"displayedRole"),g.qZA()),2&e){var i=t.$implicit;g.Q6J("value",i),g.xp6(1),g.Oqu(g.lcZ(2,2,i))}}function fe(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"mat-form-field",14),g.TgZ(1,"mat-label"),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"mat-select",15),g.NdJ("valueChange",function(e){return g.CHM(i),g.oxw(2).selectedRole=e})("selectionChange",function(){return g.CHM(i),g.oxw(2).refreshUsers()}),g.YNc(5,ge,3,4,"mat-option",16),g.qZA(),g.qZA()}if(2&e){var n=g.oxw(2);g.xp6(2),g.Oqu(g.lcZ(3,3,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),g.xp6(2),g.Q6J("value",n.selectedRole),g.xp6(1),g.Q6J("ngForOf",n.availableRoles)}}function he(e,t){1&e&&g._UZ(0,"mat-spinner",18)}var me=function(){return["select","id","name","email","logins","organization"]},ve=function(){return["id","name","email","logins","organization"]};function Ae(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"app-users-list",20),g.NdJ("page",function(e){return g.CHM(i),g.oxw(3).pageChanged(e)}),g.qZA()}if(2&e){var n=g.oxw(3);g.Q6J("pageSize",n.pageSize)("users",n.managers)("disableRouting",!n.routeAuth)("displayedColumns",n.manageAuth?g.DdM(5,me):g.DdM(6,ve))("selection",n.selectionUsers)}}function Se(e,t){if(1&e&&(g.TgZ(0,"div"),g.YNc(1,Ae,1,7,"app-users-list",19),g.qZA()),2&e){var i=g.oxw(2);g.xp6(1),g.Q6J("ngIf",i.managers)}}function be(e,t){if(1&e&&(g.YNc(0,ue,1,0,"perun-web-apps-refresh-button",5),g.YNc(1,de,3,3,"button",6),g.YNc(2,pe,3,4,"button",7),g.YNc(3,fe,6,5,"mat-form-field",8),g.YNc(4,he,1,0,"mat-spinner",9),g.YNc(5,Se,2,1,"div",10)),2&e){var i=g.oxw();g.Q6J("ngIf",!i.loading),g.xp6(1),g.Q6J("ngIf",!i.loading&&i.manageAuth),g.xp6(1),g.Q6J("ngIf",!i.loading&&i.manageAuth),g.xp6(1),g.Q6J("ngIf",!i.loading),g.xp6(1),g.Q6J("ngIf",i.loading),g.xp6(1),g.Q6J("ngIf",!i.loading)}}function Re(e,t){1&e&&(g._uU(0),g.ALo(1,"translate")),2&e&&g.hij(" ",g.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.GROUP")," ")}function Ee(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"perun-web-apps-refresh-button",11),g.NdJ("refresh",function(){return g.CHM(i),g.oxw(2).refreshGroups()}),g.qZA()}}function Ze(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"button",12),g.NdJ("click",function(){return g.CHM(i),g.oxw(2).addGroup()}),g._uU(1),g.ALo(2,"translate"),g.qZA()}2&e&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function Ie(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"button",13),g.NdJ("click",function(){return g.CHM(i),g.oxw(2).removeGroup()}),g._uU(1),g.ALo(2,"translate"),g.qZA()}if(2&e){var n=g.oxw(2);g.Q6J("disabled",0===n.selectionGroups.selected.length),g.xp6(1),g.hij(" ",g.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function Te(e,t){if(1&e&&(g.TgZ(0,"mat-option",17),g._uU(1),g.ALo(2,"displayedRole"),g.qZA()),2&e){var i=t.$implicit;g.Q6J("value",i),g.xp6(1),g.Oqu(g.lcZ(2,2,i))}}function Oe(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"mat-form-field",14),g.TgZ(1,"mat-label"),g._uU(2),g.ALo(3,"translate"),g.qZA(),g.TgZ(4,"mat-select",15),g.NdJ("valueChange",function(e){return g.CHM(i),g.oxw(2).selectedRole=e})("selectionChange",function(){return g.CHM(i),g.oxw(2).refreshGroups()}),g.YNc(5,Te,3,4,"mat-option",16),g.qZA(),g.qZA()}if(2&e){var n=g.oxw(2);g.xp6(2),g.Oqu(g.lcZ(3,3,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),g.xp6(2),g.Q6J("value",n.selectedRole),g.xp6(1),g.Q6J("ngForOf",n.availableRoles)}}function Ce(e,t){1&e&&g._UZ(0,"mat-spinner",18)}var _e=function(){return["select","id","vo","name","description"]},ye=function(){return["id","vo","name","description"]};function xe(e,t){if(1&e){var i=g.EpF();g.TgZ(0,"perun-web-apps-groups-list",22),g.NdJ("page",function(e){return g.CHM(i),g.oxw(3).pageChanged(e)}),g.qZA()}if(2&e){var n=g.oxw(3);g.Q6J("pageSize",n.pageSize)("displayedColumns",n.manageAuth?g.DdM(5,_e):g.DdM(6,ye))("groups",n.groups)("selection",n.selectionGroups)("disableMembers",!1)}}function Ne(e,t){if(1&e&&(g.TgZ(0,"div"),g.YNc(1,xe,1,7,"perun-web-apps-groups-list",21),g.qZA()),2&e){var i=g.oxw(2);g.xp6(1),g.Q6J("ngIf",i.groups)}}function we(e,t){if(1&e&&(g.YNc(0,Ee,1,0,"perun-web-apps-refresh-button",5),g.YNc(1,Ze,3,3,"button",6),g.YNc(2,Ie,3,4,"button",7),g.YNc(3,Oe,6,5,"mat-form-field",8),g.YNc(4,Ce,1,0,"mat-spinner",9),g.YNc(5,Ne,2,1,"div",10)),2&e){var i=g.oxw();g.Q6J("ngIf",!i.loading),g.xp6(1),g.Q6J("ngIf",!i.loading&&i.manageAuth),g.xp6(1),g.Q6J("ngIf",!i.loading&&i.manageAuth),g.xp6(1),g.Q6J("ngIf",!i.loading),g.xp6(1),g.Q6J("ngIf",i.loading),g.xp6(1),g.Q6J("ngIf",!i.loading)}}function De(e,t){1&e&&(g.TgZ(0,"app-alert",23),g._uU(1),g.ALo(2,"translate"),g.qZA()),2&e&&(g.xp6(1),g.hij(" ",g.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.NO_AVAILABLE_ROLES"),"\n"))}var Ue=function(){var t=function(){function t(e,n,a,r,o){i(this,t),this.dialog=e,this.tableConfigService=n,this.authzService=a,this.storeService=r,this.guiAuthResolver=o,this.groups=null,this.managers=null,this.selectionUsers=new s.Ov(!0,[]),this.selectionGroups=new s.Ov(!0,[]),this.selectedMode="",this.loading=!1,this.tableId=u.HC,this.availableRolesPrivileges=new Map}return a(t,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.guiAuthResolver.getRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(function(t){return e.availableRolesPrivileges.get(t).readAuth}),0!==this.availableRoles.length&&(this.selectedRole=this.availableRoles[0]),this.routeAuth=this.guiAuthResolver.isPerunAdmin(),this.refreshUsers()}},{key:"changeRolePrivileges",value:function(){this.manageAuth=this.availableRolesPrivileges.get(this.selectedRole).manageAuth,this.roleModes=this.availableRolesPrivileges.get(this.selectedRole).modes;var t,i=!1,n=e(this.roleModes);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(this.selectedMode===a.toLowerCase()){i=!0;break}}}catch(r){n.e(r)}finally{n.f()}i||(this.selectedMode=this.roleModes[0].toLowerCase())}},{key:"tabChanged",value:function(e){this.loading=!0,0===e.index?(this.selectedMode="user",this.refreshUsers()):(this.selectedMode="group",this.refreshGroups())}},{key:"refreshUsers",value:function(){var e=this;this.loading=!0,this.changeRolePrivileges();var t=[d.r.USER_DEF_ORGANIZATION,d.r.USER_DEF_PREFERRED_MAIL];t=t.concat(this.storeService.getLoginAttributeNames()),this.authzService.getAuthzRichAdmins(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType,t,!1,!0).subscribe(function(t){e.managers=t,e.selectionUsers.clear(),e.loading=!1},function(){e.loading=!1})}},{key:"refreshGroups",value:function(){var e=this;this.loading=!0,this.changeRolePrivileges(),this.authzService.getAuthzAdminGroups(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType).subscribe(function(t){e.groups=t,e.selectionGroups.clear(),e.loading=!1},function(){e.loading=!1})}},{key:"addManager",value:function(){var e=this,t=(0,se.kZ)();t.width="1000px",t.data={complementaryObject:this.complementaryObject,theme:this.theme,availableRoles:this.availableRoles,selectedRole:this.selectedRole},this.dialog.open(w,t).afterClosed().subscribe(function(t){t&&e.refreshUsers()})}},{key:"removeManager",value:function(){var e=this,t=(0,se.kZ)();t.width="450px",t.data={managers:this.selectionUsers.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(q,t).afterClosed().subscribe(function(t){t&&e.refreshUsers()})}},{key:"removeGroup",value:function(){var e=this,t=(0,se.kZ)();t.width="450px",t.data={groups:this.selectionGroups.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(F,t).afterClosed().subscribe(function(t){t&&e.refreshGroups()})}},{key:"addGroup",value:function(){var e=this,t=(0,se.kZ)();t.width="1000px",t.data={complementaryObject:this.complementaryObject,availableRoles:this.availableRoles,theme:this.theme,selectedRole:this.selectedRole},this.dialog.open(re,t).afterClosed().subscribe(function(t){t&&e.refreshGroups()})}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),t}();return t.\u0275fac=function(e){return new(e||t)(g.Y36(o.uw),g.Y36(u.dB),g.Y36(c.Ct),g.Y36(l.d6),g.Y36(l.x4))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-managers-page"]],hostVars:2,hostBindings:function(e,t){2&e&&g.ekj("router-component",t.true)},inputs:{complementaryObject:"complementaryObject",availableRoles:"availableRoles",complementaryObjectType:"complementaryObjectType",theme:"theme"},decls:11,vars:4,consts:[[1,"page-subtitle"],[3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["alert_type","warn",4,"ngIf"],["class","mt-2",3,"refresh",4,"ngIf"],["mat-flat-button","","color","accent","class","mr-2 mt-2",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2 mt-2",3,"disabled","click",4,"ngIf"],["class","mr-2 mt-2",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],[4,"ngIf"],[1,"mt-2",3,"refresh"],["mat-flat-button","","color","accent",1,"mr-2","mt-2",3,"click"],["mat-flat-button","","color","warn",1,"mr-2","mt-2",3,"disabled","click"],[1,"mr-2","mt-2"],[3,"value","valueChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"ml-auto","mr-auto"],[3,"pageSize","users","disableRouting","displayedColumns","selection","page",4,"ngIf"],[3,"pageSize","users","disableRouting","displayedColumns","selection","page"],[3,"pageSize","displayedColumns","groups","selection","disableMembers","page",4,"ngIf"],[3,"pageSize","displayedColumns","groups","selection","disableMembers","page"],["alert_type","warn"]],template:function(e,t){1&e&&(g.TgZ(0,"h1",0),g._uU(1),g.ALo(2,"translate"),g.qZA(),g.TgZ(3,"mat-tab-group",1),g.NdJ("selectedTabChange",function(e){return t.tabChanged(e)}),g.TgZ(4,"mat-tab"),g.YNc(5,ce,2,3,"ng-template",2),g.YNc(6,be,6,6,"ng-template",3),g.qZA(),g.TgZ(7,"mat-tab"),g.YNc(8,Re,2,3,"ng-template",2),g.YNc(9,we,6,6,"ng-template",3),g.qZA(),g.qZA(),g.YNc(10,De,3,3,"app-alert",4)),2&e&&(g.xp6(1),g.hij(" ",g.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.TITLE"),"\n"),g.xp6(9),g.Q6J("ngIf",0===t.availableRoles.length))},directives:[oe.SP,oe.uX,oe.uD,oe.Vc,A.O5,le.t,b.lW,m.KE,m.hX,v.gD,A.sg,R.ey,E.$g,I.C,W.W,Z.w],pipes:[f.X$,T],styles:[""]}),t}()},91721:function(e,t,n){"use strict";n.d(t,{Q:function(){return Y}});var r=n(31572),s=n(58623),o=n(67033),l=n(4230),c=n(27613),u=n(88426),d=n(82819),p=n(61511),g=n(29236),f=n(43691),h=n(36922),m=n(84534),v=n(57629),A=n(39571),S=n(48160);function b(e,t){if(1&e){var i=r.EpF();r.TgZ(0,"th",16),r.TgZ(1,"mat-checkbox",17),r.NdJ("change",function(e){r.CHM(i);var t=r.oxw();return e?t.masterToggle():null}),r.qZA(),r.qZA()}if(2&e){var n=r.oxw();r.xp6(1),r.Q6J("aria-label",n.checkboxLabel())("checked",n.selection.hasValue()&&n.isAllSelected())("indeterminate",n.selection.hasValue()&&!n.isAllSelected())}}function R(e,t){if(1&e){var i=r.EpF();r.TgZ(0,"td",18),r.TgZ(1,"mat-checkbox",19),r.NdJ("change",function(e){var t=r.CHM(i).$implicit,n=r.oxw();return e?n.selection.toggle(t):null})("click",function(e){return e.stopPropagation()}),r.qZA(),r.qZA()}if(2&e){var n=t.$implicit,a=r.oxw();r.xp6(1),r.Q6J("aria-label",a.checkboxLabel(n))("checked",a.selection.isSelected(n))}}function E(e,t){1&e&&(r.TgZ(0,"th",20),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"SHARED.COMPONENTS.SERVICES_LIST.ID")))}function Z(e,t){if(1&e&&(r.TgZ(0,"td",18),r._uU(1),r.qZA()),2&e){var i=t.$implicit;r.xp6(1),r.Oqu(i.id)}}function I(e,t){1&e&&(r.TgZ(0,"th",20),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"SHARED.COMPONENTS.SERVICES_LIST.NAME")))}function T(e,t){if(1&e&&(r.TgZ(0,"td",21),r._uU(1),r.qZA()),2&e){var i=t.$implicit;r.xp6(1),r.Oqu(i.name)}}function O(e,t){1&e&&r._UZ(0,"th",16)}function C(e,t){1&e&&(r.TgZ(0,"mat-icon",23),r.ALo(1,"translate"),r._uU(2," check_circle_outline "),r.qZA()),2&e&&r.s9C("matTooltip",r.lcZ(1,1,"SHARED.COMPONENTS.SERVICES_LIST.ENABLED"))}function _(e,t){1&e&&(r.TgZ(0,"mat-icon",23),r.ALo(1,"translate"),r._uU(2," block "),r.qZA()),2&e&&r.s9C("matTooltip",r.lcZ(1,1,"SHARED.COMPONENTS.SERVICES_LIST.DISABLED"))}function y(e,t){if(1&e&&(r.TgZ(0,"td",21),r.YNc(1,C,3,3,"mat-icon",22),r.YNc(2,_,3,3,"mat-icon",22),r.qZA()),2&e){var i=t.$implicit;r.xp6(1),r.Q6J("ngIf",i.enabled),r.xp6(1),r.Q6J("ngIf",!i.enabled)}}function x(e,t){1&e&&(r.TgZ(0,"th",16),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"SHARED.COMPONENTS.SERVICES_LIST.SCRIPT")))}function N(e,t){if(1&e&&(r.TgZ(0,"td",21),r._uU(1),r.qZA()),2&e){var i=t.$implicit;r.xp6(1),r.Oqu(i.script)}}function w(e,t){1&e&&(r.TgZ(0,"th",20),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.Oqu(r.lcZ(2,1,"SHARED.COMPONENTS.SERVICES_LIST.DESCRIPTION")))}function D(e,t){if(1&e&&(r.TgZ(0,"td",21),r._uU(1),r.qZA()),2&e){var i=t.$implicit;r.xp6(1),r.Oqu(i.description)}}function U(e,t){1&e&&r._UZ(0,"tr",24)}var L=function(e){return["/admin/services",e]};function k(e,t){if(1&e&&r._UZ(0,"tr",25),2&e){var i=t.$implicit,n=r.oxw();r.ekj("cursor-pointer",!n.disableRouting)("disable-outline",n.disableRouting),r.Q6J("perunWebAppsMiddleClickRouterLink",n.disableRouting?null:r.VKq(6,L,i.id))("routerLink",n.disableRouting?null:r.VKq(8,L,i.id))}}function M(e,t){1&e&&(r.TgZ(0,"app-alert",26),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}function G(e,t){1&e&&(r.TgZ(0,"app-alert",26),r._uU(1),r.ALo(2,"translate"),r.qZA()),2&e&&(r.xp6(1),r.hij(" ",r.lcZ(2,1,"SHARED.COMPONENTS.SERVICES_LIST.NO_SERVICES_WARNING"),"\n"))}var Y=function(){var e=function(){function e(t,n){i(this,e),this.authResolver=t,this.tableCheckbox=n,this.services=[],this.filterValue="",this.pageSize=10,this.displayedColumns=["select","id","name","enabled","script","description"],this.selection=new l.Ov(!0,[]),this.disableRouting=!1,this.page=new r.vpe,this.pageSizeOptions=c.f7}return a(e,[{key:"matSort",set:function(e){this.sort=e,this.setDataSource()}},{key:"ngOnChanges",value:function(e){this.authResolver.isPerunAdmin()||(this.displayedColumns=this.displayedColumns.filter(function(e){return"id"!==e})),this.dataSource=new o.by(this.services),this.setDataSource()}},{key:"getDataForColumn",value:function(e,t){switch(t){case"id":return e.id.toString();case"name":return e.name;case"enabled":return e.enabled?"true":"false";case"script":return e.script;case"description":return e.description;default:return""}}},{key:"exportData",value:function(e){(0,c.O6)((0,c.Xn)(this.dataSource.filteredData,this.displayedColumns,this.getDataForColumn,this),e)}},{key:"setDataSource",value:function(){var e=this;this.dataSource&&(this.dataSource.filterPredicate=function(t,i){return(0,c.Sd)(t,i,e.displayedColumns,e.getDataForColumn,e)},this.dataSource.sortData=function(t,i){return(0,c.pR)(t,i,e.getDataForColumn,e)},this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue)}},{key:"isAllSelected",value:function(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}},{key:"masterToggle",value:function(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.pageSize,this.child.paginator.pageIndex,!1)}},{key:"checkboxLabel",value:function(e){return e?"".concat(this.selection.isSelected(e)?"deselect":"select"," row ").concat(e.id+1):(this.isAllSelected()?"select":"deselect")+" all"}},{key:"ngAfterViewInit",value:function(){this.dataSource.paginator=this.child.paginator}}]),e}();return e.\u0275fac=function(t){return new(t||e)(r.Y36(u.x4),r.Y36(u.UA))},e.\u0275cmp=r.Xpm({type:e,selectors:[["app-services-list"]],viewQuery:function(e,t){var i;(1&e&&(r.Gf(s.YE,7),r.Gf(c.l9,7)),2&e)&&(r.iGM(i=r.CRH())&&(t.matSort=i.first),r.iGM(i=r.CRH())&&(t.child=i.first))},inputs:{services:"services",filterValue:"filterValue",pageSize:"pageSize",displayedColumns:"displayedColumns",selection:"selection",disableRouting:"disableRouting"},outputs:{page:"page"},features:[r.TTD],decls:25,vars:9,consts:[[1,"card","mt-3",3,"hidden"],[3,"dataLength","pageSizeOptions","pageSize","exportData","page"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","name"],["mat-cell","",4,"matCellDef"],["matColumnDef","enabled"],["matColumnDef","script"],["matColumnDef","description"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",3,"cursor-pointer","disable-outline","perunWebAppsMiddleClickRouterLink","routerLink",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["class","align-bottom",3,"matTooltip",4,"ngIf"],[1,"align-bottom",3,"matTooltip"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item",3,"perunWebAppsMiddleClickRouterLink","routerLink"],["alert_type","warn"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r.TgZ(1,"perun-web-apps-table-wrapper",1),r.NdJ("exportData",function(e){return t.exportData(e)})("page",function(e){return t.page.emit(e)}),r.TgZ(2,"table",2),r.ynx(3,3),r.YNc(4,b,2,3,"th",4),r.YNc(5,R,2,2,"td",5),r.BQk(),r.ynx(6,6),r.YNc(7,E,3,3,"th",7),r.YNc(8,Z,2,1,"td",5),r.BQk(),r.ynx(9,8),r.YNc(10,I,3,3,"th",7),r.YNc(11,T,2,1,"td",9),r.BQk(),r.ynx(12,10),r.YNc(13,O,1,0,"th",4),r.YNc(14,y,3,2,"td",9),r.BQk(),r.ynx(15,11),r.YNc(16,x,3,3,"th",4),r.YNc(17,N,2,1,"td",9),r.BQk(),r.ynx(18,12),r.YNc(19,w,3,3,"th",7),r.YNc(20,D,2,1,"td",9),r.BQk(),r.YNc(21,U,1,0,"tr",13),r.YNc(22,k,1,10,"tr",14),r.qZA(),r.qZA(),r.qZA(),r.YNc(23,M,3,3,"app-alert",15),r.YNc(24,G,3,3,"app-alert",15)),2&e&&(r.Q6J("hidden",void 0===t.services||0===t.services.length||0===t.dataSource.filteredData.length),r.xp6(1),r.Q6J("dataLength",t.dataSource.filteredData.length)("pageSizeOptions",t.pageSizeOptions)("pageSize",t.pageSize),r.xp6(1),r.Q6J("dataSource",t.dataSource),r.xp6(19),r.Q6J("matHeaderRowDef",t.displayedColumns),r.xp6(1),r.Q6J("matRowDefColumns",t.displayedColumns),r.xp6(1),r.Q6J("ngIf",0===t.dataSource.filteredData.length&&void 0!==t.services&&0!==t.services.length),r.xp6(1),r.Q6J("ngIf",void 0===t.services||0===t.services.length))},directives:[d.l,o.BZ,s.YE,o.w1,o.fO,o.Dz,o.as,o.nj,p.O5,o.ge,g.oG,o.ev,s.nU,f.Hw,h.gM,o.XQ,o.Gk,m.YH,v.rH,A.w],pipes:[S.X$],styles:[".cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.disable-outline[_ngcontent-%COMP%]{outline:none!important}"]}),e}()}}])}();