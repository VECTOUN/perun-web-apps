(self.webpackChunkperun_web_apps=self.webpackChunkperun_web_apps||[]).push([[739],{95142:function(e,t,i){"use strict";i.d(t,{y:function(){return b}});var s=i(33642),a=i(60611),o=i(88426),n=i(31572),r=i(57629),l=i(61511),c=i(59403),u=i(19139),d=i(67806),p=i(4252),h=i(48160);function g(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"perun-web-apps-refresh-button",5),n.NdJ("refresh",function(){return n.CHM(e),n.oxw().refreshTable()}),n.qZA()}}function m(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"perun-web-apps-immediate-filter",6),n.NdJ("filter",function(t){return n.CHM(e),n.oxw().applyFilter(t)}),n.qZA()}2&e&&n.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_MEMBERS.FILTER")}function f(e,t){1&e&&n._UZ(0,"mat-spinner",7)}const A=function(){return["id","fullName"]};function S(e,t){if(1&e){const e=n.EpF();n.TgZ(0,"perun-web-apps-members-list",8),n.NdJ("page",function(t){return n.CHM(e),n.oxw().pageChanged(t)})("updateTable",function(){return n.CHM(e),n.oxw().refreshTable()}),n.qZA()}if(2&e){const e=n.oxw();n.Q6J("disableRouting",!e.routeAuth)("filter",e.filterValue)("displayedColumns",n.DdM(5,A))("members",e.members)("pageSize",e.pageSize)}}let b=(()=>{class e{constructor(e,t,i,s){this.route=e,this.resourceService=t,this.tableConfigService=i,this.authResolver=s,this.loading=!1,this.filterValue="",this.tableId=a.iQ}ngOnInit(){this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe(e=>{this.resourceId=e.resourceId,this.refreshTable()})}refreshTable(){this.loading=!0,this.resourceService.getAssignedRichMembers(this.resourceId).subscribe(e=>{this.members=e,this.setAuthRights(),this.loading=!1})}setAuthRights(){0!==this.members.length&&(this.routeAuth=this.authResolver.isAuthorized("getMemberById_int_policy",[this.members[0]]))}applyFilter(e){this.filterValue=e}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(r.gz),n.Y36(s.xk),n.Y36(a.dB),n.Y36(o.x4))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-resource-assigned-members"]],decls:7,vars:7,consts:[[1,"page-subtitle"],[3,"refresh",4,"ngIf"],[3,"placeholder","filter",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],[3,"disableRouting","filter","displayedColumns","members","pageSize","page","updateTable",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],[1,"ml-auto","mr-auto"],[3,"disableRouting","filter","displayedColumns","members","pageSize","page","updateTable"]],template:function(e,t){1&e&&(n.TgZ(0,"h1",0),n._uU(1),n.ALo(2,"translate"),n.qZA(),n.YNc(3,g,1,0,"perun-web-apps-refresh-button",1),n.YNc(4,m,1,1,"perun-web-apps-immediate-filter",2),n.YNc(5,f,1,0,"mat-spinner",3),n.YNc(6,S,1,6,"perun-web-apps-members-list",4)),2&e&&(n.xp6(1),n.Oqu(n.lcZ(2,5,"RESOURCE_DETAIL.ASSIGNED_MEMBERS.TITLE")),n.xp6(2),n.Q6J("ngIf",!t.loading),n.xp6(1),n.Q6J("ngIf",!t.loading),n.xp6(1),n.Q6J("ngIf",t.loading),n.xp6(1),n.Q6J("ngIf",!t.loading))},directives:[l.O5,c.t,u.L,d.$g,p.O],pipes:[h.X$],styles:[""]}),e})()},75374:function(e,t,i){"use strict";i.d(t,{D:function(){return y}});var s=i(33642),a=i(60611),o=i(4230),n=i(27613),r=i(84608),l=i(88426),c=i(31572),u=i(48160),d=i(61511),p=i(15980),h=i(67806),g=i(91058),m=i(91721);function f(e,t){1&e&&c._UZ(0,"mat-spinner",6)}function A(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"app-services-list",10),c.NdJ("page",function(t){return c.CHM(e),c.oxw(2).pageChanged(t)}),c.qZA()}if(2&e){const e=c.oxw(2);c.Q6J("pageSize",e.pageSize)("disableRouting",!0)("services",e.unAssignedServices)("filterValue",e.filterValue)("selection",e.selection)}}function S(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"div",7),c.TgZ(1,"perun-web-apps-debounce-filter",8),c.NdJ("filter",function(t){return c.CHM(e),c.oxw().applyFilter(t)}),c.ALo(2,"translate"),c.qZA(),c.YNc(3,A,1,5,"app-services-list",9),c.qZA()}if(2&e){const e=c.oxw();c.xp6(1),c.s9C("placeholder",c.lcZ(2,2,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.FILTER_DESCRIPTION")),c.xp6(2),c.Q6J("ngIf",!e.loading)}}let b=(()=>{class e{constructor(e,t,i,s,n,r,l){this.dialogRef=e,this.data=t,this.notificator=i,this.translate=s,this.resourceManager=n,this.servicesManager=r,this.tableConfigService=l,this.loading=!1,this.selection=new o.Ov(!0,[]),this.tableId=a.DR,this.filterValue=""}ngOnInit(){this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.theme=this.data.theme,this.resourceManager.getAssignedServicesToResource(this.data.resourceId).subscribe(e=>{this.servicesManager.getServices().subscribe(t=>{this.unAssignedServices=t;for(const i of e)for(const e of t)i.id===e.id&&this.unAssignedServices.splice(this.unAssignedServices.indexOf(e),1);this.filteredServices=this.unAssignedServices,this.loading=!1})})}onCancel(){this.dialogRef.close()}onAdd(){this.loading=!0;const e=[];for(const t of this.selection.selected)e.push(t.id);this.resourceManager.assignServices(this.data.resourceId,e).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.SUCCESS_MESSAGE").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close(!0)})},()=>this.loading=!1)}applyFilter(e){this.filterValue=e}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(r.so),c.Y36(r.WI),c.Y36(l.V6),c.Y36(u.sK),c.Y36(s.xk),c.Y36(s.KK),c.Y36(a.dB))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-perun-web-apps-assign-service-to-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[3,"placeholder","filter"],[3,"pageSize","disableRouting","services","filterValue","selection","page",4,"ngIf"],[3,"pageSize","disableRouting","services","filterValue","selection","page"]],template:function(e,t){1&e&&(c.TgZ(0,"div"),c.TgZ(1,"h1",0),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.YNc(4,f,1,0,"mat-spinner",1),c.YNc(5,S,4,4,"div",2),c.TgZ(6,"div",3),c.TgZ(7,"button",4),c.NdJ("click",function(){return t.onCancel()}),c._uU(8),c.ALo(9,"translate"),c.qZA(),c.TgZ(10,"button",5),c.NdJ("click",function(){return t.onAdd()}),c._uU(11),c.ALo(12,"translate"),c.qZA(),c.qZA(),c.qZA()),2&e&&(c.Tol(t.theme),c.xp6(2),c.Oqu(c.lcZ(3,9,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.TITLE")),c.xp6(2),c.Q6J("ngIf",t.loading),c.xp6(1),c.Q6J("ngIf",!t.loading),c.xp6(3),c.hij(" ",c.lcZ(9,11,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.CANCEL_BUTTON")," "),c.xp6(2),c.Q6J("disabled",0===t.selection.selected.length||t.loading),c.xp6(1),c.hij(" ",c.lcZ(12,13,"DIALOGS.ASSIGN_SERVICE_TO_RESOURCE.ADD_BUTTON")," "))},directives:[r.uh,d.O5,r.H8,p.lW,h.$g,r.xY,g.P,m.Q],pipes:[u.X$],styles:[""]}),e})();var R=i(67033);function E(e,t){1&e&&c._UZ(0,"mat-spinner",6)}function Z(e,t){1&e&&c._UZ(0,"th",15)}function I(e,t){if(1&e&&(c.TgZ(0,"td",16),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.xp6(1),c.hij(" ",e.name," ")}}function v(e,t){1&e&&c._UZ(0,"tr",17)}function T(e,t){1&e&&c._UZ(0,"tr",18)}function O(e,t){if(1&e&&(c.TgZ(0,"div",7),c.TgZ(1,"p"),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"div",8),c._uU(5),c.ALo(6,"translate"),c.qZA(),c.TgZ(7,"table",9),c.ynx(8,10),c.YNc(9,Z,1,0,"th",11),c.YNc(10,I,2,1,"td",12),c.BQk(),c.YNc(11,v,1,0,"tr",13),c.YNc(12,T,1,0,"tr",14),c.qZA(),c.qZA()),2&e){const e=c.oxw();c.xp6(2),c.hij(" ",c.lcZ(3,5,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DESCRIPTION")," "),c.xp6(3),c.hij(" ",c.lcZ(6,7,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.ASK")," "),c.xp6(2),c.Q6J("dataSource",e.dataSource),c.xp6(4),c.Q6J("matHeaderRowDef",e.displayedColumns),c.xp6(1),c.Q6J("matRowDefColumns",e.displayedColumns)}}let C=(()=>{class e{constructor(e,t,i,s,a){this.dialogRef=e,this.data=t,this.notificator=i,this.translate=s,this.resourcesManager=a,this.displayedColumns=["name"]}ngOnInit(){this.theme=this.data.theme,this.dataSource=new R.by(this.data.services)}onSubmit(){this.loading=!0;const e=[];for(const t of this.data.services)e.push(t.id);this.resourcesManager.removeServices(this.data.resourceId,e).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close(!0)})},()=>this.loading=!1)}onCancel(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(r.so),c.Y36(r.WI),c.Y36(l.V6),c.Y36(u.sK),c.Y36(s.xk))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-perun-web-apps-remove-service-from-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(c.TgZ(0,"div"),c.TgZ(1,"h1",0),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.YNc(4,E,1,0,"mat-spinner",1),c.YNc(5,O,13,9,"div",2),c.TgZ(6,"div",3),c.TgZ(7,"button",4),c.NdJ("click",function(){return t.onCancel()}),c._uU(8),c.ALo(9,"translate"),c.qZA(),c.TgZ(10,"button",5),c.NdJ("click",function(){return t.onSubmit()}),c._uU(11),c.ALo(12,"translate"),c.qZA(),c.qZA(),c.qZA()),2&e&&(c.Tol(t.theme),c.xp6(2),c.Oqu(c.lcZ(3,9,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.TITLE")),c.xp6(2),c.Q6J("ngIf",t.loading),c.xp6(1),c.Q6J("ngIf",!t.loading),c.xp6(3),c.hij(" ",c.lcZ(9,11,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.CANCEL")," "),c.xp6(2),c.Q6J("disabled",t.loading),c.xp6(1),c.hij(" ",c.lcZ(12,13,"DIALOGS.REMOVE_SERVICE_FROM_RESOURCE.DELETE")," "))},directives:[r.uh,d.O5,r.H8,p.lW,h.$g,r.xY,R.BZ,R.w1,R.fO,R.Dz,R.as,R.nj,R.ge,R.ev,R.XQ,R.Gk],pipes:[u.X$],styles:[""]}),e})();var _=i(57629),x=i(59403),N=i(19139);function D(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",7),c.NdJ("click",function(){return c.CHM(e),c.oxw().addService()}),c._uU(1),c.ALo(2,"translate"),c.qZA()}2&e&&(c.xp6(1),c.hij(" ",c.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_SERVICES.ADD_SERVICE"),"\n"))}function w(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"button",8),c.NdJ("click",function(){return c.CHM(e),c.oxw().removeServices()}),c._uU(1),c.ALo(2,"translate"),c.qZA()}if(2&e){const e=c.oxw();c.Q6J("disabled",0===e.selected.selected.length),c.xp6(1),c.hij(" ",c.lcZ(2,2,"RESOURCE_DETAIL.ASSIGNED_SERVICES.REMOVE_SERVICE"),"\n")}}function U(e,t){1&e&&c._UZ(0,"mat-spinner",9)}function L(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"app-services-list",10),c.NdJ("page",function(t){return c.CHM(e),c.oxw().pageChanged(t)}),c.qZA()}if(2&e){const e=c.oxw();c.Q6J("pageSize",e.pageSize)("services",e.assignedServices)("selection",e.selected)("filterValue",e.filterValue)("displayedColumns",e.displayedColumns)("disableRouting",!e.serviceRoutingAuth)}}let y=(()=>{class e{constructor(e,t,i,s,n){this.route=e,this.resourcesManager=t,this.tableConfigService=i,this.dialog=s,this.guiAuthResolver=n,this.assignedServices=[],this.selected=new o.Ov(!0,[]),this.tableId=a.uC,this.filterValue="",this.displayedColumns=["select","id","name","enabled","script","description"]}ngOnInit(){this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe(e=>{this.resourceId=e.resourceId,this.resourcesManager.getResourceById(this.resourceId).subscribe(e=>{this.resource=e,this.getDataForAuthorization(),this.loadAllServices()})})}loadAllServices(){this.loading=!0,this.resourcesManager.getAssignedServicesToResource(this.resourceId).subscribe(e=>{this.assignedServices=e,this.selected.clear(),this.loading=!1})}addService(){const e=(0,n.kZ)();e.width="800px",e.data={theme:"resource-theme",resourceId:this.resourceId},this.dialog.open(b,e).afterClosed().subscribe(e=>{e&&this.loadAllServices()})}removeServices(){const e=(0,n.kZ)();e.width="500px",e.data={theme:"resource-theme",resourceId:this.resourceId,services:this.selected.selected},this.dialog.open(C,e).afterClosed().subscribe(e=>{e&&this.loadAllServices()})}applyFilter(e){this.filterValue=e}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}getDataForAuthorization(){this.assignServiceAuth=this.guiAuthResolver.isAuthorized("assignServices_Resource_List<Service>_policy",[this.resource]),this.removeServiceAuth=this.guiAuthResolver.isAuthorized("removeServices_Resource_List<Service>_policy",[this.resource]),this.displayedColumns=this.removeServiceAuth?["select","id","name","enabled","script","description"]:["id","name","enabled","script","description"],this.serviceRoutingAuth=this.guiAuthResolver.isPerunAdmin()}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(_.gz),c.Y36(s.xk),c.Y36(a.dB),c.Y36(r.uw),c.Y36(l.x4))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-perun-web-apps-resource-assigned-services"]],decls:9,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","ml-2",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","services","selection","filterValue","displayedColumns","disableRouting","page",4,"ngIf"],["color","accent","mat-flat-button","",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"pageSize","services","selection","filterValue","displayedColumns","disableRouting","page"]],template:function(e,t){1&e&&(c.TgZ(0,"h1",0),c._uU(1),c.ALo(2,"translate"),c.qZA(),c.TgZ(3,"perun-web-apps-refresh-button",1),c.NdJ("refresh",function(){return t.loadAllServices()}),c.qZA(),c.YNc(4,D,3,3,"button",2),c.YNc(5,w,3,4,"button",3),c.TgZ(6,"perun-web-apps-immediate-filter",4),c.NdJ("filter",function(e){return t.applyFilter(e)}),c.qZA(),c.YNc(7,U,1,0,"mat-spinner",5),c.YNc(8,L,1,6,"app-services-list",6)),2&e&&(c.xp6(1),c.Oqu(c.lcZ(2,6,"RESOURCE_DETAIL.ASSIGNED_SERVICES.TITLE")),c.xp6(3),c.Q6J("ngIf",!t.loadingResource&&t.assignServiceAuth),c.xp6(1),c.Q6J("ngIf",!t.loadingResource&&t.removeServiceAuth),c.xp6(1),c.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_SERVICES.FILTER_SERVICES"),c.xp6(1),c.Q6J("ngIf",t.loading),c.xp6(1),c.Q6J("ngIf",!t.loading))},directives:[x.t,d.O5,N.L,p.lW,h.$g,m.Q],pipes:[u.X$],styles:[""]}),e})()},79472:function(e,t,i){"use strict";i.d(t,{X:function(){return R}});var s=i(88426),a=i(33642),o=i(31572),n=i(57629),r=i(55109),l=i(61511),c=i(541),u=i(69012),d=i(48160);function p(e,t){1&e&&(o._uU(0),o.ALo(1,"translate")),2&e&&o.hij(" ",o.lcZ(1,1,"RESOURCE_DETAIL.ENTITY")," ")}function h(e,t){if(1&e&&o._UZ(0,"app-one-entity-attribute-page",4),2&e){const e=o.oxw();o.Q6J("entity","resource")("entityId",e.resourceId)}}function g(e,t){1&e&&(o._uU(0),o.ALo(1,"translate"),o.ALo(2,"translate")),2&e&&o.AsE(" ",o.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",o.lcZ(2,4,"MEMBER_DETAIL.ENTITY")," ")}function m(e,t){if(1&e&&o._UZ(0,"app-two-entity-attribute-page",5),2&e){const e=o.oxw(2);o.Q6J("firstEntity","resource")("firstEntityId",e.resourceId)("secondEntity","member")}}function f(e,t){1&e&&(o.TgZ(0,"mat-tab"),o.YNc(1,g,3,6,"ng-template",1),o.YNc(2,m,1,3,"ng-template",2),o.qZA())}function A(e,t){1&e&&(o._uU(0),o.ALo(1,"translate"),o.ALo(2,"translate")),2&e&&o.AsE(" ",o.lcZ(1,2,"RESOURCE_DETAIL.ENTITY")," - ",o.lcZ(2,4,"GROUP_DETAIL.ENTITY")," ")}function S(e,t){if(1&e&&o._UZ(0,"app-two-entity-attribute-page",5),2&e){const e=o.oxw(2);o.Q6J("firstEntity","resource")("firstEntityId",e.resourceId)("secondEntity","group")}}function b(e,t){1&e&&(o.TgZ(0,"mat-tab"),o.YNc(1,A,3,6,"ng-template",1),o.YNc(2,S,1,3,"ng-template",2),o.qZA())}let R=(()=>{class e{constructor(e,t,i){this.route=e,this.authResolver=t,this.resourceManager=i}ngOnInit(){this.route.parent.params.subscribe(e=>{this.resourceId=parseInt(e.resourceId,10),this.resourceManager.getResourceById(this.resourceId).subscribe(e=>{this.resource=e,this.resourceGroupAttAuth=this.authResolver.isAuthorized("getAssignedGroups_Resource_policy",[this.resource]),this.resourceMemberAttAuth=this.authResolver.isAuthorized("getAssignedRichMembers_Resource_policy",[this.resource])})})}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(n.gz),o.Y36(s.x4),o.Y36(a.xk))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-resource-attributes"]],hostVars:2,hostBindings:function(e,t){2&e&&o.ekj("router-component",t.true)},decls:10,vars:5,consts:[[1,"page-subtitle"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entity","entityId"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(e,t){1&e&&(o.TgZ(0,"div"),o.TgZ(1,"h1",0),o._uU(2),o.ALo(3,"translate"),o.qZA(),o.TgZ(4,"mat-tab-group"),o.TgZ(5,"mat-tab"),o.YNc(6,p,2,3,"ng-template",1),o.YNc(7,h,1,2,"ng-template",2),o.qZA(),o.YNc(8,f,3,0,"mat-tab",3),o.YNc(9,b,3,0,"mat-tab",3),o.qZA(),o.qZA()),2&e&&(o.xp6(2),o.Oqu(o.lcZ(3,3,"RESOURCE_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),o.xp6(6),o.Q6J("ngIf",t.resourceMemberAttAuth),o.xp6(1),o.Q6J("ngIf",t.resourceGroupAttAuth))},directives:[r.SP,r.uX,r.uD,r.Vc,l.O5,c.t,u.Y],pipes:[d.X$],styles:[""]}),e})()},72920:function(e,t,i){"use strict";i.d(t,{b:function(){return y}});var s=i(17),a=i(75585),o=i(33642),n=i(27613),r=i(88426),l=i(22280),c=i(81954),u=i(95909),d=i(31572),p=i(57629),h=i(48958),g=i(84608),m=i(66297),f=i(61511),A=i(67806),S=i(43691),b=i(36922),R=i(21575),E=i(15980),Z=i(48160);function I(e,t){1&e&&d._UZ(0,"mat-spinner",3)}function v(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"button",15),d.NdJ("click",function(){return d.CHM(e),d.oxw(2).editResource()}),d.TgZ(1,"mat-icon"),d._uU(2,"edit"),d.qZA(),d.qZA()}}function T(e,t){if(1&e){const e=d.EpF();d.TgZ(0,"button",16),d.NdJ("click",function(){return d.CHM(e),d.oxw(2).deleteResource()}),d.TgZ(1,"mat-icon"),d._uU(2,"delete_forever"),d.qZA(),d.qZA()}}const O=function(e){return["/organizations",e]};function C(e,t){if(1&e&&(d.TgZ(0,"a",8),d._uU(1),d.qZA()),2&e){const e=d.oxw(2);d.Q6J("routerLink",d.VKq(2,O,e.resource.vo.id)),d.xp6(1),d.Oqu(e.resource.vo.name)}}function _(e,t){if(1&e&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&e){const e=d.oxw(2);d.xp6(1),d.hij(" ",e.resource.vo.name," ")}}const x=function(e){return["/facilities",e]};function N(e,t){if(1&e&&(d.TgZ(0,"a",8),d._uU(1),d.qZA()),2&e){const e=d.oxw(2);d.Q6J("routerLink",d.VKq(2,x,e.resource.facilityId)),d.xp6(1),d.Oqu(e.resource.facility.name)}}function D(e,t){if(1&e&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&e){const e=d.oxw(2);d.xp6(1),d.hij(" ",e.resource.facility.name," ")}}const w=function(){return{color:"black"}},U=function(e){return[e]};function L(e,t){if(1&e&&(d.TgZ(0,"div"),d.TgZ(1,"div",4),d._UZ(2,"mat-icon",5),d.ALo(3,"translate"),d.TgZ(4,"div",6),d.TgZ(5,"div",7),d.TgZ(6,"a",8),d._uU(7),d.qZA(),d.TgZ(8,"span",9),d._uU(9),d.qZA(),d.YNc(10,v,3,0,"button",10),d.YNc(11,T,3,0,"button",11),d.qZA(),d.TgZ(12,"div"),d._uU(13),d.ALo(14,"translate"),d.qZA(),d.TgZ(15,"span",12),d._uU(16),d.ALo(17,"translate"),d.ALo(18,"translate"),d.YNc(19,C,2,4,"a",13),d.YNc(20,_,2,1,"span",2),d._uU(21),d.ALo(22,"translate"),d.YNc(23,N,2,4,"a",14),d.YNc(24,D,2,1,"span",2),d._uU(25),d.ALo(26,"translate"),d.qZA(),d.qZA(),d.qZA(),d._UZ(27,"app-animated-router-outlet"),d.qZA()),2&e){const e=d.oxw();d.xp6(2),d.s9C("matTooltip",d.lcZ(3,20,"RESOURCE_DETAIL.ENTITY")),d.Q6J("ngStyle",d.DdM(32,w)),d.xp6(4),d.Q6J("routerLink",d.VKq(33,U,e.baseUrl)),d.xp6(1),d.hij(" ",e.resource.name," "),d.xp6(2),d.hij(" \xa0#",e.resource.id," "),d.xp6(1),d.Q6J("ngIf",e.editResourceAuth),d.xp6(1),d.Q6J("ngIf",e.deleteAuth),d.xp6(2),d.AsE(" ",d.lcZ(14,22,"RESOURCE_DETAIL.UUID"),": ",e.resource.uuid," "),d.xp6(3),d.AsE(" ",d.lcZ(17,24,"RESOURCE_DETAIL.ENTITY"),", ",d.lcZ(18,26,"RESOURCE_DETAIL.VO"),": "),d.xp6(3),d.Q6J("ngIf",e.voLinkAuth),d.xp6(1),d.Q6J("ngIf",!e.voLinkAuth),d.xp6(1),d.AsE(" #",e.resource.voId,", ",d.lcZ(22,28,"RESOURCE_DETAIL.FACILITY"),": "),d.xp6(2),d.Q6J("ngIf",e.facilityLinkAuth),d.xp6(1),d.Q6J("ngIf",!e.facilityLinkAuth),d.xp6(1),d.lnq(" #",e.resource.facilityId,", ",d.lcZ(26,30,"RESOURCE_DETAIL.DESCRIPTION"),": ",e.resource.description," ")}}let y=(()=>{class e{constructor(e,t,i,s,a,o,n,r,l){this.route=e,this.facilityManager=t,this.vosManagerService=i,this.resourcesManager=s,this.sideMenuService=a,this.sideMenuItemService=o,this.dialog=n,this.guiAuthResolver=r,this.router=l,this.deleteAuth=!1,this.baseUrl="",this.loading=!1}ngOnInit(){this.loading=!0,this.route.params.subscribe(e=>{this.resourcesManager.getRichResourceById(e.resourceId).subscribe(e=>{this.resource=e,this.setAuth(),"facilities"===this.route.parent.snapshot.url[0].path?(this.baseUrl=(new l.r5).transform(e,!1),this.facilityManager.getFacilityById(e.facilityId).subscribe(t=>{const i=this.sideMenuItemService.parseFacility(t),s=this.sideMenuItemService.parseResource(e,!1);this.sideMenuService.setFacilityMenuItems([i,s]),this.loading=!1},()=>this.loading=!1)):(this.baseUrl=(new l.r5).transform(e,!0),this.vosManagerService.getVoById(e.voId).subscribe(t=>{const i=this.sideMenuItemService.parseVo(t),s=this.sideMenuItemService.parseResource(e,!0);this.sideMenuService.setAccessMenuItems([i,s]),this.loading=!1},()=>this.loading=!1)),(0,n.sF)("resources",this.resource)})})}setAuth(){this.facilityLinkAuth=this.guiAuthResolver.isAuthorized("getFacilityById_int_policy",[this.resource]),this.editResourceAuth=this.guiAuthResolver.isAuthorized("updateResource_Resource_policy",[this.resource]),this.voLinkAuth=this.guiAuthResolver.isAuthorized("getVoById_int_policy",[this.resource]),this.deleteAuth=this.guiAuthResolver.isAuthorized("deleteResource_Resource_policy",[this.resource])}editResource(){let e;this.resourcesManager.getResourceById(this.resource.id).subscribe(t=>{e=t;const i=(0,n.kZ)();i.width="450px",i.data={theme:"resource-theme",resource:e,dialogType:c.Eg.RESOURCE},this.dialog.open(c.rd,i).afterClosed().subscribe(e=>{e&&this.resourcesManager.getRichResourceById(this.resource.id).subscribe(e=>{this.resource=e})})})}deleteResource(){const e=(0,n.kZ)();e.width="500px",e.data={theme:"resource-theme",resources:[this.resource]},this.dialog.open(u.f,e).afterClosed().subscribe(e=>{e&&this.router.navigate(["../"],{relativeTo:this.route})})}}return e.\u0275fac=function(t){return new(t||e)(d.Y36(p.gz),d.Y36(o.IQ),d.Y36(o.YF),d.Y36(o.xk),d.Y36(h.D),d.Y36(a.V),d.Y36(g.uw),d.Y36(r.x4),d.Y36(p.F0))},e.\u0275cmp=d.Xpm({type:e,selectors:[["app-resource-detail-page"]],decls:4,vars:2,consts:[[1,"container-fluid","pl-xl-5","pr-xl-5","resource-theme"],["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-resource-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],["queryParamsHandling","merge",1,"resource-link",3,"routerLink"],[1,"text-muted"],["mat-icon-button","","aria-label","Edit resource",3,"click",4,"ngIf"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"mt-1","entity-info"],["queryParamsHandling","merge","class","resource-link",3,"routerLink",4,"ngIf"],["class","resource-link","queryParamsHandling","merge",3,"routerLink",4,"ngIf"],["mat-icon-button","","aria-label","Edit resource",3,"click"],["mat-icon-button","",3,"click"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d._UZ(1,"perun-web-apps-back-button"),d.YNc(2,I,1,0,"mat-spinner",1),d.YNc(3,L,28,35,"div",2),d.qZA()),2&e&&(d.xp6(2),d.Q6J("ngIf",t.loading),d.xp6(1),d.Q6J("ngIf",!t.loading&&void 0!==t.resource))},directives:[m.W,f.O5,A.$g,S.Hw,b.gM,f.PC,p.yS,R.A,E.lW],pipes:[Z.X$],styles:[".break-line[_ngcontent-%COMP%]{display:inline-block}"],data:{animation:[s.Ji]}}),e})()},42473:function(e,t,i){"use strict";i.d(t,{K:function(){return q}});var s=i(33642),a=i(4230),o=i(84608),n=i(67033),r=i(88426),l=i(31572),c=i(48160),u=i(61511),d=i(15980),p=i(67806);function h(e,t){1&e&&l._UZ(0,"mat-spinner",6)}function g(e,t){1&e&&l._UZ(0,"th",15)}function m(e,t){if(1&e&&(l.TgZ(0,"td",16),l._uU(1),l.qZA()),2&e){const e=t.$implicit;l.xp6(1),l.hij(" ",e.name," ")}}function f(e,t){1&e&&l._UZ(0,"tr",17)}function A(e,t){1&e&&l._UZ(0,"tr",18)}function S(e,t){if(1&e&&(l.TgZ(0,"div",7),l.TgZ(1,"p"),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.TgZ(4,"div",8),l._uU(5),l.ALo(6,"translate"),l.qZA(),l.TgZ(7,"table",9),l.ynx(8,10),l.YNc(9,g,1,0,"th",11),l.YNc(10,m,2,1,"td",12),l.BQk(),l.YNc(11,f,1,0,"tr",13),l.YNc(12,A,1,0,"tr",14),l.qZA(),l.qZA()),2&e){const e=l.oxw();l.xp6(2),l.hij(" ",l.lcZ(3,5,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DESCRIPTION")," "),l.xp6(3),l.hij(" ",l.lcZ(6,7,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.ASK")," "),l.xp6(2),l.Q6J("dataSource",e.dataSource),l.xp6(4),l.Q6J("matHeaderRowDef",e.displayedColumns),l.xp6(1),l.Q6J("matRowDefColumns",e.displayedColumns)}}let b=(()=>{class e{constructor(e,t,i,s,a){this.dialogRef=e,this.data=t,this.notificator=i,this.translate=s,this.resourceManager=a,this.displayedColumns=["name"],this.loading=!1}ngOnInit(){this.theme=this.data.theme,this.dataSource=new n.by(this.data.groups)}onCancel(){this.dialogRef.close()}onSubmit(){const e=[];for(const t of this.data.groups)e.push(t.id);this.loading=!0,this.resourceManager.removeGroupsFromResource(e,this.data.resourceId).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUP_FROM_RESOURCE.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close(!0)})},()=>this.loading=!1)}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(o.so),l.Y36(o.WI),l.Y36(r.V6),l.Y36(c.sK),l.Y36(s.xk))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-perun-web-apps-remove-group-from-resource-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(l.TgZ(0,"div"),l.TgZ(1,"h1",0),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.YNc(4,h,1,0,"mat-spinner",1),l.YNc(5,S,13,9,"div",2),l.TgZ(6,"div",3),l.TgZ(7,"button",4),l.NdJ("click",function(){return t.onCancel()}),l._uU(8),l.ALo(9,"translate"),l.qZA(),l.TgZ(10,"button",5),l.NdJ("click",function(){return t.onSubmit()}),l._uU(11),l.ALo(12,"translate"),l.qZA(),l.qZA(),l.qZA()),2&e&&(l.Tol(t.theme),l.xp6(2),l.Oqu(l.lcZ(3,9,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.TITLE")),l.xp6(2),l.Q6J("ngIf",t.loading),l.xp6(1),l.Q6J("ngIf",!t.loading),l.xp6(3),l.hij(" ",l.lcZ(9,11,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.CANCEL")," "),l.xp6(2),l.Q6J("disabled",t.loading),l.xp6(1),l.hij(" ",l.lcZ(12,13,"DIALOGS.REMOVE_GROUP_FROM_RESOURCE.DELETE")," "))},directives:[o.uh,u.O5,o.H8,d.lW,p.$g,o.xY,n.BZ,n.w1,n.fO,n.Dz,n.as,n.nj,n.ge,n.ev,n.XQ,n.Gk],pipes:[c.X$],styles:[""]}),e})();var R=i(60611),E=i(36922),Z=i(91058),I=i(78364);function v(e,t){1&e&&l._UZ(0,"mat-spinner",6)}const T=function(){return["select","id","name","description"]};function O(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",7),l.TgZ(1,"perun-web-apps-debounce-filter",8),l.NdJ("filter",function(t){return l.CHM(e),l.oxw().applyFilter(t)}),l.ALo(2,"translate"),l.qZA(),l.TgZ(3,"perun-web-apps-groups-list",9),l.NdJ("page",function(t){return l.CHM(e),l.oxw().pageChanged(t)}),l.qZA(),l.qZA()}if(2&e){const e=l.oxw();l.xp6(1),l.s9C("placeholder",l.lcZ(2,8,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.FILTER_DESCRIPTION")),l.xp6(2),l.Q6J("pageSize",e.pageSize)("groups",e.unAssignedGroups)("selection",e.selection)("filter",e.filterValue)("displayedColumns",l.DdM(10,T))("disableRouting",!0)("disableMembers",!1)}}let C=(()=>{class e{constructor(e,t,i,s,o,n,r,l){this.dialogRef=e,this.data=t,this.notificator=i,this.translate=s,this.resourceManager=o,this.tableConfigService=n,this.groupService=r,this.guiAuthResolver=l,this.loading=!1,this.checkGroups=!1,this.selection=new a.Ov(!0,[]),this.filterValue="",this.tableId=R.cL}ngOnInit(){this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.theme=this.data.theme,this.resource=this.data.resource,this.resourceManager.getAssignedGroups(this.resource.id).subscribe(e=>{this.groupService.getAllGroups(this.resource.voId).subscribe(t=>{this.unAssignedGroups=t;for(const i of e)for(const e of t)i.id===e.id&&this.unAssignedGroups.splice(this.unAssignedGroups.indexOf(e),1);this.loading=!1},()=>this.loading=!1)},()=>this.loading=!1)}onCancel(){this.dialogRef.close()}onAdd(){if(this.checkGroups);else{this.loading=!0;const e=[];for(const t of this.selection.selected)e.push(t.id);this.resourceManager.assignGroupsToResource(e,this.resource.id).subscribe(()=>{this.translate.get("DIALOGS.ASSIGN_GROUP_TO_RESOURCE.SUCCESS_MESSAGE").subscribe(e=>{this.notificator.showSuccess(e),this.dialogRef.close(!0)})},()=>this.loading=!1)}}applyFilter(e){this.filterValue=e}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}canAddGroups(){let e=!0;return this.selection.selected.forEach(t=>{this.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",[this.resource,t])||(e=!1)}),e}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(o.so),l.Y36(o.WI),l.Y36(r.V6),l.Y36(c.sK),l.Y36(s.xk),l.Y36(R.dB),l.Y36(s.ff),l.Y36(r.x4))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-perun-web-apps-assign-group-to-resource-dialog"]],decls:14,vars:19,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","","class","dialog-container",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent","matTooltipPosition","above",1,"ml-2",3,"disabled","matTooltipDisabled","matTooltip","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content","",1,"dialog-container"],[3,"placeholder","filter"],[3,"pageSize","groups","selection","filter","displayedColumns","disableRouting","disableMembers","page"]],template:function(e,t){1&e&&(l.TgZ(0,"div"),l.TgZ(1,"h1",0),l._uU(2),l.ALo(3,"translate"),l.qZA(),l.YNc(4,v,1,0,"mat-spinner",1),l.YNc(5,O,4,11,"div",2),l.TgZ(6,"div",3),l.TgZ(7,"button",4),l.NdJ("click",function(){return t.onCancel()}),l._uU(8),l.ALo(9,"translate"),l.qZA(),l.TgZ(10,"button",5),l.NdJ("click",function(){return t.onAdd()}),l.ALo(11,"translate"),l._uU(12),l.ALo(13,"translate"),l.qZA(),l.qZA(),l.qZA()),2&e&&(l.Tol(t.theme),l.xp6(2),l.Oqu(l.lcZ(3,11,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.TITLE")),l.xp6(2),l.Q6J("ngIf",t.loading),l.xp6(1),l.Q6J("ngIf",!t.loading),l.xp6(3),l.hij(" ",l.lcZ(9,13,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.CANCEL_BUTTON")," "),l.xp6(2),l.s9C("matTooltip",l.lcZ(11,15,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ADD_TOOLTIP")),l.Q6J("disabled",0===t.selection.selected.length||!t.canAddGroups()||t.loading)("matTooltipDisabled",t.canAddGroups()),l.xp6(2),l.hij(" ",l.lcZ(13,17,"DIALOGS.ASSIGN_GROUP_TO_RESOURCE.ADD_BUTTON")," "))},directives:[o.uh,u.O5,o.H8,d.lW,E.gM,p.$g,o.xY,Z.P,I.W],pipes:[c.X$],styles:[""]}),e})();var _=i(27613),x=i(57629),N=i(59403),D=i(39571);const w=["checkbox"];function U(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"button",9),l.NdJ("click",function(){return l.CHM(e),l.oxw().addGroup()}),l._uU(1),l.ALo(2,"translate"),l.qZA()}2&e&&(l.xp6(1),l.hij(" ",l.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_GROUPS.ADD_GROUP"),"\n"))}function L(e,t){1&e&&l._UZ(0,"mat-spinner",10)}const y=function(e){return[e]},M=function(){return["select","id","name","description","status"]};function G(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"div",11),l.TgZ(1,"perun-web-apps-groups-list",12),l.NdJ("page",function(t){return l.CHM(e),l.oxw().pageChanged(t)}),l.qZA(),l.qZA()}if(2&e){const e=l.oxw();l.xp6(1),l.Q6J("pageSize",e.pageSize)("groups",e.assignedGroups)("filter",e.filteredValue)("selection",e.selected)("disableMembers",!1)("disableRouting",!e.guiAuthResolver.isAuthorized("getGroupById_int_policy",l.VKq(7,y,e.assignedGroups[0])))("displayedColumns",l.DdM(9,M))}}function Y(e,t){1&e&&(l.TgZ(0,"app-alert",13),l._uU(1),l.ALo(2,"translate"),l.qZA()),2&e&&(l.xp6(1),l.hij(" ",l.lcZ(2,1,"RESOURCE_DETAIL.ASSIGNED_GROUPS.NO_GROUPS"),"\n"))}let q=(()=>{class e{constructor(e,t,i,s,o,n){this.route=e,this.resourcesManager=t,this.vosManagerService=i,this.tableConfigService=s,this.dialog=o,this.guiAuthResolver=n,this.assignedGroups=[],this.selected=new a.Ov(!0,[]),this.filteredValue="",this.tableId=R.Ad}ngOnInit(){this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.loading=!0,this.route.parent.params.subscribe(e=>{this.resourceId=e.resourceId,this.getDataForAuthorization(),this.loadAllGroups()})}loadAllGroups(){this.loading=!0,this.resourcesManager.getGroupAssignments(this.resourceId).subscribe(e=>{this.assignedGroups=e.map(e=>{const t=e.enrichedGroup.group;return t.status=e.status,t}),this.selected.clear(),this.loading=!1})}addGroup(){const e=(0,_.kZ)();e.width="800px",e.data={theme:"resource-theme",resource:this.resource},this.dialog.open(C,e).afterClosed().subscribe(e=>{e&&this.loadAllGroups()})}removeGroups(){const e=(0,_.kZ)();e.width="500px",e.data={resourceId:this.resourceId,groups:this.selected.selected,theme:"resource-theme"},this.dialog.open(b,e).afterClosed().subscribe(e=>{e&&this.loadAllGroups()})}canRemoveGroups(){let e=!0;return this.selected.selected.forEach(t=>{this.guiAuthResolver.isAuthorized("removeGroupsFromResource_List<Group>_Resource_policy",[this.resource,t])||(e=!1)}),e}applyFilter(e){this.filteredValue=e}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}getDataForAuthorization(){this.loadingResource=!0,this.resourcesManager.getResourceById(this.resourceId).subscribe(e=>{this.resource=e,this.loadingResource=!1})}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(x.gz),l.Y36(s.xk),l.Y36(s.YF),l.Y36(R.dB),l.Y36(o.uw),l.Y36(r.x4))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-perun-web-apps-resource-groups"]],viewQuery:function(e,t){if(1&e&&l.Gf(w,7),2&e){let e;l.iGM(e=l.CRH())&&(t.checkbox=e.first)}},decls:14,vars:18,consts:[[1,"page-subtitle"],[3,"refresh"],["color","accent","mat-flat-button","",3,"click",4,"ngIf"],["color","warn","mat-flat-button","",1,"ml-2","mr-2",3,"disabled","click"],[3,"matTooltipDisabled","matTooltip"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["alert_type","warn",4,"ngIf"],["color","accent","mat-flat-button","",3,"click"],[1,"ml-auto","mr-auto"],[1,"mt-3"],[3,"pageSize","groups","filter","selection","disableMembers","disableRouting","displayedColumns","page"],["alert_type","warn"]],template:function(e,t){1&e&&(l.TgZ(0,"h1",0),l._uU(1),l.ALo(2,"translate"),l.qZA(),l.TgZ(3,"perun-web-apps-refresh-button",1),l.NdJ("refresh",function(){return t.loadAllGroups()}),l.qZA(),l.YNc(4,U,3,3,"button",2),l.TgZ(5,"button",3),l.NdJ("click",function(){return t.removeGroups()}),l.TgZ(6,"span",4),l.ALo(7,"translate"),l._uU(8),l.ALo(9,"translate"),l.qZA(),l.qZA(),l.TgZ(10,"perun-web-apps-debounce-filter",5),l.NdJ("filter",function(e){return t.applyFilter(e)}),l.qZA(),l.YNc(11,L,1,0,"mat-spinner",6),l.YNc(12,G,2,10,"div",7),l.YNc(13,Y,3,3,"app-alert",8)),2&e&&(l.xp6(1),l.Oqu(l.lcZ(2,10,"RESOURCE_DETAIL.ASSIGNED_GROUPS.TITLE")),l.xp6(3),l.Q6J("ngIf",!t.loadingResource&&t.guiAuthResolver.isAuthorized("assignGroupsToResource_List<Group>_Resource_policy",l.VKq(16,y,t.resource))),l.xp6(1),l.Q6J("disabled",0===t.selected.selected.length||!t.canRemoveGroups()),l.xp6(1),l.s9C("matTooltip",l.lcZ(7,12,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_TOOLTIP")),l.Q6J("matTooltipDisabled",t.canRemoveGroups()),l.xp6(2),l.hij(" ",l.lcZ(9,14,"RESOURCE_DETAIL.ASSIGNED_GROUPS.REMOVE_GROUP")," "),l.xp6(2),l.Q6J("placeholder","RESOURCE_DETAIL.ASSIGNED_GROUPS.FILTER_GROUPS"),l.xp6(1),l.Q6J("ngIf",t.loading),l.xp6(1),l.Q6J("ngIf",!t.loading&&0!==t.assignedGroups.length),l.xp6(1),l.Q6J("ngIf",0===t.assignedGroups.length&&!t.loading))},directives:[N.t,u.O5,d.lW,E.gM,Z.P,p.$g,I.W,D.w],pipes:[c.X$],styles:[""]}),e})()},76527:function(e,t,i){"use strict";i.d(t,{H:function(){return p}});var s=i(33642),a=i(88426),o=i(31572),n=i(57629),r=i(61511),l=i(67806),c=i(8557);function u(e,t){1&e&&o._UZ(0,"mat-spinner",2)}function d(e,t){if(1&e&&(o.TgZ(0,"div"),o._UZ(1,"perun-web-apps-menu-buttons-field",3),o.qZA()),2&e){const e=o.oxw();o.xp6(1),o.Q6J("items",e.navItems)("size","small")}}let p=(()=>{class e{constructor(e,t,i){this.resourcesManager=e,this.route=t,this.guiAuthResolver=i,this.navItems=[],this.loading=!1}ngOnInit(){this.loading=!0,this.route.params.subscribe(e=>{this.resourcesManager.getResourceById(e.resourceId).subscribe(e=>{this.resource=e,this.initItems("facilities"!==this.route.parent.parent.snapshot.url[0].path),this.loading=!1},()=>this.loading=!1)})}initItems(e){const t=e?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`;this.navItems=[],this.guiAuthResolver.isAuthorized("getAssignedGroups_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-group",url:`${t}/resources/${this.resource.id}/groups`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_GROUPS",style:"resource-btn"}),this.guiAuthResolver.isAuthorized("getAssignedServices_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-service",url:`/${t}/resources/${this.resource.id}/services`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_SERVICES",style:"resource-btn"}),this.guiAuthResolver.isAuthorized("getAssignedMembers_Resource_policy",[this.resource])&&this.navItems.push({cssIcon:"perun-user",url:`${t}/resources/${this.resource.id}/members`,label:"MENU_ITEMS.RESOURCE.ASSIGNED_MEMBERS",style:"resource-btn"}),this.navItems.push({cssIcon:"perun-attributes",url:`${t}/resources/${this.resource.id}/attributes`,label:"MENU_ITEMS.RESOURCE.ATTRIBUTES",style:"resource-btn"}),this.guiAuthResolver.isManagerPagePrivileged(this.resource)&&this.navItems.push({cssIcon:"perun-settings2",url:`${t}/resources/${this.resource.id}/settings`,label:"MENU_ITEMS.RESOURCE.SETTINGS",style:"resource-btn"})}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(s.xk),o.Y36(n.gz),o.Y36(a.x4))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-resource-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&o.ekj("router-component",t.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(o.YNc(0,u,1,0,"mat-spinner",0),o.YNc(1,d,2,2,"div",1)),2&e&&(o.Q6J("ngIf",t.loading),o.xp6(1),o.Q6J("ngIf",!t.loading))},directives:[r.O5,l.$g,c.L],styles:[""]}),e})()},64359:function(e,t,i){"use strict";i.d(t,{O:function(){return u}});var s=i(33642),a=i(88426),o=i(31572),n=i(57629),r=i(61511),l=i(489);function c(e,t){if(1&e&&o._UZ(0,"app-managers-page",1),2&e){const e=o.oxw();o.Q6J("complementaryObject",e.resource)("complementaryObjectType",e.type)("theme",e.theme)("availableRoles",e.availableRoles)}}let u=(()=>{class e{constructor(e,t,i){this.route=e,this.resourceService=t,this.guiAuthResolver=i,this.availableRoles=[],this.type="Resource",this.theme="resource-theme"}ngOnInit(){this.route.parent.parent.params.subscribe(e=>{this.resourceService.getResourceById(e.resourceId).subscribe(e=>{this.resource=e})}),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Resource")}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(n.gz),o.Y36(s.xk),o.Y36(a.x4))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-resource-settings-managers"]],decls:1,vars:1,consts:[[3,"complementaryObject","complementaryObjectType","theme","availableRoles",4,"ngIf"],[3,"complementaryObject","complementaryObjectType","theme","availableRoles"]],template:function(e,t){1&e&&o.YNc(0,c,1,4,"app-managers-page",0),2&e&&o.Q6J("ngIf",t.resource)},directives:[r.O5,l.s],styles:[""]}),e})()},22927:function(e,t,i){"use strict";i.d(t,{h:function(){return p}});var s=i(33642),a=i(88426),o=i(31572),n=i(57629),r=i(61511),l=i(67806),c=i(8557);function u(e,t){1&e&&o._UZ(0,"mat-spinner",2)}function d(e,t){if(1&e&&(o.TgZ(0,"div"),o._UZ(1,"perun-web-apps-menu-buttons-field",3),o.qZA()),2&e){const e=o.oxw();o.xp6(1),o.Q6J("items",e.items)("size","small")}}let p=(()=>{class e{constructor(e,t,i){this.route=e,this.resourceManager=t,this.authResolver=i,this.items=[],this.loading=!1}ngOnInit(){this.loading=!0,this.route.parent.parent.params.subscribe(e=>{this.resourceManager.getResourceById(e.resourceId).subscribe(e=>{this.resource=e,this.initItems("facilities"!==this.route.parent.parent.parent.snapshot.url[0].path),this.loading=!1},()=>this.loading=!1)})}initItems(e){this.items=[],this.authResolver.isManagerPagePrivileged(this.resource)&&this.items.push({cssIcon:"perun-manager",url:`${e?`/organizations/${this.resource.voId}`:`/facilities/${this.resource.facilityId}`}/resources/${this.resource.id}/settings/managers`,label:"MENU_ITEMS.RESOURCE.MANAGERS",style:"resource-btn"})}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(n.gz),o.Y36(s.xk),o.Y36(a.x4))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-resource-settings-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&o.ekj("router-component",t.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(o.YNc(0,u,1,0,"mat-spinner",0),o.YNc(1,d,2,2,"div",1)),2&e&&(o.Q6J("ngIf",t.loading),o.xp6(1),o.Q6J("ngIf",!t.loading))},directives:[r.O5,l.$g,c.L],styles:[""]}),e})()},77968:function(e,t,i){"use strict";i.d(t,{t:function(){return n}});var s=i(17),a=i(31572),o=i(21575);let n=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-resource-settings"]],hostVars:2,hostBindings:function(e,t){2&e&&a.ekj("router-component",t.true)},decls:1,vars:0,template:function(e,t){1&e&&a._UZ(0,"app-animated-router-outlet")},directives:[o.A],styles:[""],data:{animation:[s.Ji]}}),e})()},489:function(e,t,i){"use strict";i.d(t,{s:function(){return De}});var s=i(4230),a=i(84608),o=i(88426),n=i(33642),r=i(60611),l=i(67004),c=i(16073),u=i(31572),d=i(48160),p=i(57629),h=i(66283),g=i(4786),m=i(61511),f=i(80340),A=i(15980),S=i(71522),b=i(67806),R=i(39571),E=i(86593);let Z=(()=>{class e{constructor(e){this.translate=e,this.prefix="ROLES."}transform(e,t){const i=this.prefix.concat(e);return this.translate.instant(i)}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(d.sK,16))},e.\u0275pipe=u.Yjl({name:"displayedRole",type:e,pure:!0}),e})();function I(e,t){if(1&e&&(u.TgZ(0,"mat-option",15),u._uU(1),u.ALo(2,"displayedRole"),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e),u.xp6(1),u.Oqu(u.lcZ(2,2,e))}}function v(e,t){1&e&&u._UZ(0,"mat-spinner",16)}function T(e,t){1&e&&(u.TgZ(0,"app-alert",20),u._uU(1),u.ALo(2,"translate"),u.qZA()),2&e&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"DIALOGS.ADD_MANAGERS.NO_USERS_FOUND")," "))}const O=function(){return["select","id","name","email","logins","organization"]};function C(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"app-users-list",21),u.NdJ("page",function(t){return u.CHM(e),u.oxw(2).pageChanged(t)}),u.qZA()}if(2&e){const e=u.oxw(2);u.Q6J("pageSize",e.pageSize)("disableRouting",!0)("selection",e.selection)("displayedColumns",u.DdM(5,O))("users",e.users)}}function _(e,t){if(1&e&&(u.TgZ(0,"div",17),u.YNc(1,T,3,3,"app-alert",18),u.YNc(2,C,1,6,"app-users-list",19),u.qZA()),2&e){const e=u.oxw();u.xp6(1),u.Q6J("ngIf",0===e.users.length&&e.firstSearchDone),u.xp6(1),u.Q6J("ngIf",0!==e.users.length)}}let x=(()=>{class e{constructor(e,t,i,a,o,n,l,c,u,d){this.dialogRef=e,this.data=t,this.authzService=i,this.usersService=a,this.translate=o,this.notificator=n,this.storeService=l,this.route=c,this.router=u,this.tableConfigService=d,this.selection=new s.Ov(!0,[]),this.users=[],this.firstSearchDone=!1,this.tableId=r.H2,o.get("DIALOGS.ADD_MANAGERS.TITLE").subscribe(e=>this.title=e),o.get("DIALOGS.ADD_MANAGERS.SUCCESS").subscribe(e=>this.successMessage=e)}ngOnInit(){this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.theme=this.data.theme,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.searchCtrl=new c.NI("",[c.kI.required,c.kI.pattern(".*[\\S]+.*")])}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.setRoleWithUserComplementaryObject({role:this.selectedRole,users:this.selection.selected.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)}onSearchByString(){if(this.searchCtrl.invalid)return void this.searchCtrl.markAllAsTouched();this.loading=!0,this.selection.clear();let e=[l.r.USER_DEF_ORGANIZATION,l.r.USER_DEF_PREFERRED_MAIL];e=e.concat(this.storeService.getLoginAttributeNames()),this.usersService.findRichUsersWithAttributes(this.searchCtrl.value,e).subscribe(e=>{this.users=e,this.loading=!1,this.firstSearchDone=!0},()=>this.loading=!1)}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(a.so),u.Y36(a.WI),u.Y36(n.Ct),u.Y36(n.Fv),u.Y36(d.sK),u.Y36(o.V6),u.Y36(o.d6),u.Y36(p.gz),u.Y36(p.F0),u.Y36(r.dB))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-add-manager-dialog"]],decls:32,vars:31,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"mr-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"mr-2","w-100"],["matInput","","autocomplete","false",3,"placeholder","formControl","keyup.enter"],["mat-flat-button","","color","accent",1,"ml-auto",3,"disabled","click"],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[3,"value"],[1,"mr-auto","ml-auto"],[1,"mt-3"],["alert_type","warn",4,"ngIf"],[3,"pageSize","disableRouting","selection","displayedColumns","users","page",4,"ngIf"],["alert_type","warn"],[3,"pageSize","disableRouting","selection","displayedColumns","users","page"]],template:function(e,t){1&e&&(u.TgZ(0,"div"),u.TgZ(1,"h1",0),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"div",1),u.TgZ(5,"div",2),u.TgZ(6,"mat-form-field",3),u.TgZ(7,"mat-label"),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.TgZ(10,"mat-select",4),u.NdJ("valueChange",function(e){return t.selectedRole=e}),u.YNc(11,I,3,4,"mat-option",5),u.qZA(),u.qZA(),u.TgZ(12,"mat-form-field",6),u.TgZ(13,"label"),u.TgZ(14,"input",7),u.NdJ("keyup.enter",function(){return t.onSearchByString()}),u.ALo(15,"translate"),u.qZA(),u.qZA(),u.TgZ(16,"mat-error"),u._uU(17),u.ALo(18,"translate"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(19,"button",8),u.NdJ("click",function(){return t.onSearchByString()}),u._uU(20),u.ALo(21,"translate"),u.qZA(),u.TgZ(22,"div",9),u.YNc(23,v,1,0,"mat-spinner",10),u.qZA(),u.YNc(24,_,3,2,"div",11),u.qZA(),u.TgZ(25,"div",12),u.TgZ(26,"button",13),u.NdJ("click",function(){return t.onCancel()}),u._uU(27),u.ALo(28,"translate"),u.qZA(),u.TgZ(29,"button",14),u.NdJ("click",function(){return t.onSubmit()}),u._uU(30),u.ALo(31,"translate"),u.qZA(),u.qZA(),u.qZA()),2&e&&(u.Tol(t.theme),u.xp6(2),u.Oqu(u.lcZ(3,17,"DIALOGS.ADD_MANAGERS.TITLE")),u.xp6(6),u.Oqu(u.lcZ(9,19,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),u.xp6(2),u.Q6J("value",t.selectedRole),u.xp6(1),u.Q6J("ngForOf",t.availableRoles),u.xp6(3),u.s9C("placeholder",u.lcZ(15,21,"DIALOGS.ADD_MANAGERS.DESCRIPTION")),u.Q6J("formControl",t.searchCtrl),u.xp6(3),u.hij(" ",u.lcZ(18,23,"DIALOGS.ADD_MANAGERS.EMPTY_SEARCH_MESSAGE")," "),u.xp6(2),u.Q6J("disabled",t.loading),u.xp6(1),u.hij(" ",u.lcZ(21,25,"DIALOGS.ADD_MANAGERS.SEARCH")," "),u.xp6(3),u.Q6J("ngIf",t.loading),u.xp6(1),u.Q6J("ngIf",null!==t.users&&!t.loading),u.xp6(3),u.hij(" ",u.lcZ(28,27,"DIALOGS.ADD_MANAGERS.CANCEL")," "),u.xp6(2),u.Q6J("disabled",0===t.selection.selected.length||void 0===t.selectedRole||t.loading),u.xp6(1),u.hij(" ",u.lcZ(31,29,"DIALOGS.ADD_MANAGERS.CREATE")," "))},directives:[a.uh,a.xY,h.KE,h.hX,g.gD,m.sg,f.Nt,c.Fj,c.JJ,c.oH,h.TO,A.lW,m.O5,a.H8,S.ey,b.$g,R.w,E.C],pipes:[d.X$,Z],styles:[".inline-dialog-items[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]}),e})();var N=i(67033);function D(e,t){1&e&&u._UZ(0,"th",14)}function w(e,t){if(1&e&&(u.TgZ(0,"td",15),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.xp6(1),u.AsE(" ",e.firstName," ",e.lastName,"")}}function U(e,t){1&e&&u._UZ(0,"tr",16)}function L(e,t){1&e&&u._UZ(0,"tr",17)}function y(e,t){if(1&e&&(u.TgZ(0,"div",6),u.TgZ(1,"p"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"div",7),u._uU(5),u.ALo(6,"translate"),u.qZA(),u.TgZ(7,"table",8),u.ynx(8,9),u.YNc(9,D,1,0,"th",10),u.YNc(10,w,2,2,"td",11),u.BQk(),u.YNc(11,U,1,0,"tr",12),u.YNc(12,L,1,0,"tr",13),u.qZA(),u.qZA()),2&e){const e=u.oxw();u.xp6(2),u.hij(" ",u.lcZ(3,5,"DIALOGS.REMOVE_MANAGERS.DESCRIPTION")," "),u.xp6(3),u.hij(" ",u.lcZ(6,7,"DIALOGS.REMOVE_MANAGERS.ASK")," "),u.xp6(2),u.Q6J("dataSource",e.dataSource),u.xp6(4),u.Q6J("matHeaderRowDef",e.displayedColumns),u.xp6(1),u.Q6J("matRowDefColumns",e.displayedColumns)}}function M(e,t){1&e&&u._UZ(0,"mat-spinner",18)}let G=(()=>{class e{constructor(e,t,i,s,a){this.dialogRef=e,this.data=t,this.notificator=i,this.translate=s,this.authzService=a,this.displayedColumns=["name"]}ngOnInit(){this.dataSource=new N.by(this.data.managers),this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithUserComplementaryObject({role:this.data.role,users:this.data.managers.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_MANAGERS.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)},()=>this.loading=!1)}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(a.so),u.Y36(a.WI),u.Y36(o.V6),u.Y36(d.sK),u.Y36(n.Ct))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-remove-manager-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["mat-dialog-content","",4,"ngIf"],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""],[1,"mr-auto","ml-auto"]],template:function(e,t){1&e&&(u.TgZ(0,"div"),u.TgZ(1,"h1",0),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.YNc(4,y,13,9,"div",1),u.YNc(5,M,1,0,"mat-spinner",2),u.TgZ(6,"div",3),u.TgZ(7,"button",4),u.NdJ("click",function(){return t.onCancel()}),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.TgZ(10,"button",5),u.NdJ("click",function(){return t.onSubmit()}),u._uU(11),u.ALo(12,"translate"),u.qZA(),u.qZA(),u.qZA()),2&e&&(u.Tol(t.theme),u.xp6(2),u.Oqu(u.lcZ(3,9,"DIALOGS.REMOVE_MANAGERS.TITLE")),u.xp6(2),u.Q6J("ngIf",!t.loading),u.xp6(1),u.Q6J("ngIf",t.loading),u.xp6(3),u.hij(" ",u.lcZ(9,11,"DIALOGS.REMOVE_MANAGERS.CANCEL")," "),u.xp6(2),u.Q6J("disabled",t.loading),u.xp6(1),u.hij(" ",u.lcZ(12,13,"DIALOGS.REMOVE_MANAGERS.DELETE")," "))},directives:[a.uh,m.O5,a.H8,A.lW,a.xY,N.BZ,N.w1,N.fO,N.Dz,N.as,N.nj,N.ge,N.ev,N.XQ,N.Gk,b.$g],pipes:[d.X$],styles:[""]}),e})();function Y(e,t){1&e&&u._UZ(0,"mat-spinner",6)}function q(e,t){1&e&&u._UZ(0,"th",15)}function J(e,t){if(1&e&&(u.TgZ(0,"td",16),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.xp6(1),u.hij(" ",e.name,"")}}function k(e,t){1&e&&u._UZ(0,"tr",17)}function Q(e,t){1&e&&u._UZ(0,"tr",18)}function z(e,t){if(1&e&&(u.TgZ(0,"div",7),u.TgZ(1,"p"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"div",8),u._uU(5),u.ALo(6,"translate"),u.qZA(),u.TgZ(7,"table",9),u.ynx(8,10),u.YNc(9,q,1,0,"th",11),u.YNc(10,J,2,1,"td",12),u.BQk(),u.YNc(11,k,1,0,"tr",13),u.YNc(12,Q,1,0,"tr",14),u.qZA(),u.qZA()),2&e){const e=u.oxw();u.xp6(2),u.hij(" ",u.lcZ(3,5,"DIALOGS.REMOVE_GROUPS.DESCRIPTION")," "),u.xp6(3),u.hij(" ",u.lcZ(6,7,"DIALOGS.REMOVE_GROUPS.ASK")," "),u.xp6(2),u.Q6J("dataSource",e.dataSource),u.xp6(4),u.Q6J("matHeaderRowDef",e.displayedColumns),u.xp6(1),u.Q6J("matRowDefColumns",e.displayedColumns)}}let P=(()=>{class e{constructor(e,t,i,s,a){this.dialogRef=e,this.data=t,this.notificator=i,this.translate=s,this.authzService=a,this.displayedColumns=["name"]}ngOnInit(){this.dataSource=new N.by(this.data.groups),this.theme=this.data.theme}onCancel(){this.dialogRef.close(!1)}onSubmit(){this.loading=!0,this.authzService.unsetRoleWithGroupComplementaryObject({role:this.data.role,authorizedGroups:this.data.groups.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.translate.get("DIALOGS.REMOVE_GROUPS.SUCCESS").subscribe(e=>{this.notificator.showSuccess(e),this.loading=!1,this.dialogRef.close(!0)},()=>this.loading=!1)},()=>this.loading=!1)}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(a.so),u.Y36(a.WI),u.Y36(o.V6),u.Y36(d.sK),u.Y36(n.Ct))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-remove-group-manager-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(u.TgZ(0,"div"),u.TgZ(1,"h1",0),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.YNc(4,Y,1,0,"mat-spinner",1),u.YNc(5,z,13,9,"div",2),u.TgZ(6,"div",3),u.TgZ(7,"button",4),u.NdJ("click",function(){return t.onCancel()}),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.TgZ(10,"button",5),u.NdJ("click",function(){return t.onSubmit()}),u._uU(11),u.ALo(12,"translate"),u.qZA(),u.qZA(),u.qZA()),2&e&&(u.Tol(t.theme),u.xp6(2),u.Oqu(u.lcZ(3,9,"DIALOGS.REMOVE_GROUPS.TITLE")),u.xp6(2),u.Q6J("ngIf",t.loading),u.xp6(1),u.Q6J("ngIf",!t.loading),u.xp6(3),u.hij(" ",u.lcZ(9,11,"DIALOGS.REMOVE_GROUPS.CANCEL")," "),u.xp6(2),u.Q6J("disabled",t.loading),u.xp6(1),u.hij(" ",u.lcZ(12,13,"DIALOGS.REMOVE_GROUPS.DELETE")," "))},directives:[a.uh,m.O5,a.H8,A.lW,b.$g,a.xY,N.BZ,N.w1,N.fO,N.Dz,N.as,N.nj,N.ge,N.ev,N.XQ,N.Gk],pipes:[d.X$],styles:[""]}),e})();var V=i(56238),F=i(79996),j=i(40084),H=i(91058),$=i(78364);function B(e,t){if(1&e&&(u.TgZ(0,"mat-option",17),u._uU(1),u.ALo(2,"displayedRole"),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e),u.xp6(1),u.Oqu(u.lcZ(2,2,e))}}function X(e,t){if(1&e&&(u.TgZ(0,"mat-option",17),u._uU(1),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e),u.xp6(1),u.hij(" ",e.name," ")}}function W(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"perun-web-apps-debounce-filter",18),u.NdJ("filter",function(t){return u.CHM(e),u.oxw().applyFilter(t)}),u.ALo(1,"translate"),u.qZA()}2&e&&u.s9C("placeholder",u.lcZ(1,1,"DIALOGS.ADD_GROUPS.FILTER_GROUPS"))}function K(e,t){1&e&&u._UZ(0,"mat-spinner",19)}const ee=function(){return["select","id","name","description"]};function te(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"div",20),u.TgZ(1,"perun-web-apps-groups-list",21),u.NdJ("page",function(t){return u.CHM(e),u.oxw().pageChanged(t)}),u.qZA(),u.qZA()}if(2&e){const e=u.oxw();u.xp6(1),u.Q6J("pageSize",e.pageSize)("disableRouting",!0)("displayedColumns",u.DdM(7,ee))("selection",e.selection)("filter",e.filterValue)("groups",e.groups)("disableMembers",!1)}}let ie=(()=>{class e{constructor(e,t,i,a,o,n,l,u,d,p){this.dialogRef=e,this.data=t,this.authzService=i,this.voService=a,this.groupService=o,this.translate=n,this.notificator=l,this.route=u,this.tableConfigService=d,this.router=p,this.searchString="",this.selection=new s.Ov(!0,[]),this.groups=[],this.vos=[],this.filterValue="",this.myControl=new c.NI,this.firstSearchDone=!1,this.tableId=r.kZ,n.get("DIALOGS.ADD_GROUPS.TITLE").subscribe(e=>this.title=e),n.get("DIALOGS.ADD_GROUPS.SUCCESS").subscribe(e=>this.successMessage=e)}displayFn(e){return e?e.name:null}onCancel(){this.dialogRef.close()}onSubmit(){this.loading=!0,this.authzService.setRoleWithGroupComplementaryObject({role:this.selectedRole,authorizedGroups:this.selection.selected.map(e=>e.id),complementaryObject:this.data.complementaryObject}).subscribe(()=>{this.notificator.showSuccess(this.successMessage),this.loading=!1,this.dialogRef.close()},()=>this.loading=!1)}ngOnInit(){this.loading=!0,this.availableRoles=this.data.availableRoles,this.selectedRole=this.data.selectedRole,this.theme=this.data.theme,this.voService.getMyVos().subscribe(e=>{this.filteredOptions=this.myControl.valueChanges.pipe((0,V.O)(""),(0,F.U)(e=>this._filter(e))),this.vos=e,this.loading=!1},()=>this.loading=!1)}_filter(e){const t="string"==typeof e?e.toLowerCase():e.name.toLowerCase;return this.vos.filter(e=>e.name.toLowerCase().includes(t))}showVoGroups(e){this.loading=!0,this.groupService.getAllGroups(e.option.value.id).subscribe(e=>{this.groups=e,this.loading=!1,this.firstSearchDone=!0},()=>this.loading=!1)}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}applyFilter(e){this.filterValue=e}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(a.so),u.Y36(a.WI),u.Y36(n.Ct),u.Y36(n.YF),u.Y36(n.ff),u.Y36(d.sK),u.Y36(o.V6),u.Y36(p.gz),u.Y36(r.dB),u.Y36(p.F0))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-add-group-manager-dialog"]],decls:33,vars:33,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"inline-dialog-items"],[1,"mr-2"],[3,"value","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"mr-2","w-75"],["type","text","aria-label","Assignee","matInput","",3,"placeholder","formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"placeholder","filter",4,"ngIf"],[1,"overflow-hidden"],["class","mr-auto ml-auto",4,"ngIf"],["class","mt-3",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[3,"value"],[3,"placeholder","filter"],[1,"mr-auto","ml-auto"],[1,"mt-3"],[3,"pageSize","disableRouting","displayedColumns","selection","filter","groups","disableMembers","page"]],template:function(e,t){if(1&e&&(u.TgZ(0,"div"),u.TgZ(1,"h1",0),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"div",1),u.TgZ(5,"div",2),u.TgZ(6,"mat-form-field",3),u.TgZ(7,"mat-label"),u._uU(8),u.ALo(9,"translate"),u.qZA(),u.TgZ(10,"mat-select",4),u.NdJ("valueChange",function(e){return t.selectedRole=e}),u.YNc(11,B,3,4,"mat-option",5),u.qZA(),u.qZA(),u.TgZ(12,"mat-form-field",6),u.TgZ(13,"mat-label"),u._uU(14),u.ALo(15,"translate"),u.qZA(),u._UZ(16,"input",7),u.ALo(17,"translate"),u.TgZ(18,"mat-autocomplete",8,9),u.NdJ("optionSelected",function(e){return t.showVoGroups(e)}),u.YNc(20,X,2,2,"mat-option",5),u.ALo(21,"async"),u.qZA(),u.qZA(),u.qZA(),u.YNc(22,W,2,3,"perun-web-apps-debounce-filter",10),u.TgZ(23,"div",11),u.YNc(24,K,1,0,"mat-spinner",12),u.qZA(),u.YNc(25,te,2,8,"div",13),u.qZA(),u.TgZ(26,"div",14),u.TgZ(27,"button",15),u.NdJ("click",function(){return t.onCancel()}),u._uU(28),u.ALo(29,"translate"),u.qZA(),u.TgZ(30,"button",16),u.NdJ("click",function(){return t.onSubmit()}),u._uU(31),u.ALo(32,"translate"),u.qZA(),u.qZA(),u.qZA()),2&e){const e=u.MAs(19);u.Tol(t.theme),u.xp6(2),u.Oqu(u.lcZ(3,19,"DIALOGS.ADD_GROUPS.TITLE")),u.xp6(6),u.Oqu(u.lcZ(9,21,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),u.xp6(2),u.Q6J("value",t.selectedRole),u.xp6(1),u.Q6J("ngForOf",t.availableRoles),u.xp6(3),u.Oqu(u.lcZ(15,23,"DIALOGS.ADD_GROUPS.SELECT_VO")),u.xp6(2),u.s9C("placeholder",u.lcZ(17,25,"DIALOGS.ADD_GROUPS.SELECT_VO")),u.Q6J("formControl",t.myControl)("matAutocomplete",e),u.xp6(2),u.Q6J("displayWith",t.displayFn),u.xp6(2),u.Q6J("ngForOf",u.lcZ(21,27,t.filteredOptions)),u.xp6(2),u.Q6J("ngIf",null!==t.groups&&t.groups.length>0&&!t.loading),u.xp6(2),u.Q6J("ngIf",t.loading),u.xp6(1),u.Q6J("ngIf",null!==t.groups&&!t.loading),u.xp6(3),u.hij(" ",u.lcZ(29,29,"DIALOGS.ADD_MANAGERS.CANCEL")," "),u.xp6(2),u.Q6J("disabled",0===t.selection.selected.length||t.loading),u.xp6(1),u.hij(" ",u.lcZ(32,31,"DIALOGS.ADD_MANAGERS.CREATE")," ")}},directives:[a.uh,a.xY,h.KE,h.hX,g.gD,m.sg,f.Nt,c.Fj,j.ZL,c.JJ,c.oH,j.XC,m.O5,a.H8,A.lW,S.ey,H.P,b.$g,$.W],pipes:[d.X$,m.Ov,Z],styles:[""]}),e})();var se=i(27613),ae=i(55109),oe=i(59403);function ne(e,t){1&e&&(u._uU(0),u.ALo(1,"translate")),2&e&&u.hij(" ",u.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.USER")," ")}function re(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"perun-web-apps-refresh-button",11),u.NdJ("refresh",function(){return u.CHM(e),u.oxw(2).refreshUsers()}),u.qZA()}}function le(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",12),u.NdJ("click",function(){return u.CHM(e),u.oxw(2).addManager()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}2&e&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function ce(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",13),u.NdJ("click",function(){return u.CHM(e),u.oxw(2).removeManager()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}if(2&e){const e=u.oxw(2);u.Q6J("disabled",0===e.selectionUsers.selected.length),u.xp6(1),u.hij(" ",u.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function ue(e,t){if(1&e&&(u.TgZ(0,"mat-option",17),u._uU(1),u.ALo(2,"displayedRole"),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e),u.xp6(1),u.Oqu(u.lcZ(2,2,e))}}function de(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"mat-form-field",14),u.TgZ(1,"mat-label"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"mat-select",15),u.NdJ("valueChange",function(t){return u.CHM(e),u.oxw(2).selectedRole=t})("selectionChange",function(){return u.CHM(e),u.oxw(2).refreshUsers()}),u.YNc(5,ue,3,4,"mat-option",16),u.qZA(),u.qZA()}if(2&e){const e=u.oxw(2);u.xp6(2),u.Oqu(u.lcZ(3,3,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),u.xp6(2),u.Q6J("value",e.selectedRole),u.xp6(1),u.Q6J("ngForOf",e.availableRoles)}}function pe(e,t){1&e&&u._UZ(0,"mat-spinner",18)}const he=function(){return["select","id","name","email","logins","organization"]},ge=function(){return["id","name","email","logins","organization"]};function me(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"app-users-list",20),u.NdJ("page",function(t){return u.CHM(e),u.oxw(3).pageChanged(t)}),u.qZA()}if(2&e){const e=u.oxw(3);u.Q6J("pageSize",e.pageSize)("users",e.managers)("disableRouting",!e.routeAuth)("displayedColumns",e.manageAuth?u.DdM(5,he):u.DdM(6,ge))("selection",e.selectionUsers)}}function fe(e,t){if(1&e&&(u.TgZ(0,"div"),u.YNc(1,me,1,7,"app-users-list",19),u.qZA()),2&e){const e=u.oxw(2);u.xp6(1),u.Q6J("ngIf",e.managers)}}function Ae(e,t){if(1&e&&(u.YNc(0,re,1,0,"perun-web-apps-refresh-button",5),u.YNc(1,le,3,3,"button",6),u.YNc(2,ce,3,4,"button",7),u.YNc(3,de,6,5,"mat-form-field",8),u.YNc(4,pe,1,0,"mat-spinner",9),u.YNc(5,fe,2,1,"div",10)),2&e){const e=u.oxw();u.Q6J("ngIf",!e.loading),u.xp6(1),u.Q6J("ngIf",!e.loading&&e.manageAuth),u.xp6(1),u.Q6J("ngIf",!e.loading&&e.manageAuth),u.xp6(1),u.Q6J("ngIf",!e.loading),u.xp6(1),u.Q6J("ngIf",e.loading),u.xp6(1),u.Q6J("ngIf",!e.loading)}}function Se(e,t){1&e&&(u._uU(0),u.ALo(1,"translate")),2&e&&u.hij(" ",u.lcZ(1,1,"SHARED.COMPONENTS.MANAGERS_PAGE.GROUP")," ")}function be(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"perun-web-apps-refresh-button",11),u.NdJ("refresh",function(){return u.CHM(e),u.oxw(2).refreshGroups()}),u.qZA()}}function Re(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",12),u.NdJ("click",function(){return u.CHM(e),u.oxw(2).addGroup()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}2&e&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.ADD")," "))}function Ee(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"button",13),u.NdJ("click",function(){return u.CHM(e),u.oxw(2).removeGroup()}),u._uU(1),u.ALo(2,"translate"),u.qZA()}if(2&e){const e=u.oxw(2);u.Q6J("disabled",0===e.selectionGroups.selected.length),u.xp6(1),u.hij(" ",u.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.REMOVE")," ")}}function Ze(e,t){if(1&e&&(u.TgZ(0,"mat-option",17),u._uU(1),u.ALo(2,"displayedRole"),u.qZA()),2&e){const e=t.$implicit;u.Q6J("value",e),u.xp6(1),u.Oqu(u.lcZ(2,2,e))}}function Ie(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"mat-form-field",14),u.TgZ(1,"mat-label"),u._uU(2),u.ALo(3,"translate"),u.qZA(),u.TgZ(4,"mat-select",15),u.NdJ("valueChange",function(t){return u.CHM(e),u.oxw(2).selectedRole=t})("selectionChange",function(){return u.CHM(e),u.oxw(2).refreshGroups()}),u.YNc(5,Ze,3,4,"mat-option",16),u.qZA(),u.qZA()}if(2&e){const e=u.oxw(2);u.xp6(2),u.Oqu(u.lcZ(3,3,"SHARED.COMPONENTS.MANAGERS_PAGE.SELECT_ROLE")),u.xp6(2),u.Q6J("value",e.selectedRole),u.xp6(1),u.Q6J("ngForOf",e.availableRoles)}}function ve(e,t){1&e&&u._UZ(0,"mat-spinner",18)}const Te=function(){return["select","id","vo","name","description"]},Oe=function(){return["id","vo","name","description"]};function Ce(e,t){if(1&e){const e=u.EpF();u.TgZ(0,"perun-web-apps-groups-list",22),u.NdJ("page",function(t){return u.CHM(e),u.oxw(3).pageChanged(t)}),u.qZA()}if(2&e){const e=u.oxw(3);u.Q6J("pageSize",e.pageSize)("displayedColumns",e.manageAuth?u.DdM(5,Te):u.DdM(6,Oe))("groups",e.groups)("selection",e.selectionGroups)("disableMembers",!1)}}function _e(e,t){if(1&e&&(u.TgZ(0,"div"),u.YNc(1,Ce,1,7,"perun-web-apps-groups-list",21),u.qZA()),2&e){const e=u.oxw(2);u.xp6(1),u.Q6J("ngIf",e.groups)}}function xe(e,t){if(1&e&&(u.YNc(0,be,1,0,"perun-web-apps-refresh-button",5),u.YNc(1,Re,3,3,"button",6),u.YNc(2,Ee,3,4,"button",7),u.YNc(3,Ie,6,5,"mat-form-field",8),u.YNc(4,ve,1,0,"mat-spinner",9),u.YNc(5,_e,2,1,"div",10)),2&e){const e=u.oxw();u.Q6J("ngIf",!e.loading),u.xp6(1),u.Q6J("ngIf",!e.loading&&e.manageAuth),u.xp6(1),u.Q6J("ngIf",!e.loading&&e.manageAuth),u.xp6(1),u.Q6J("ngIf",!e.loading),u.xp6(1),u.Q6J("ngIf",e.loading),u.xp6(1),u.Q6J("ngIf",!e.loading)}}function Ne(e,t){1&e&&(u.TgZ(0,"app-alert",23),u._uU(1),u.ALo(2,"translate"),u.qZA()),2&e&&(u.xp6(1),u.hij(" ",u.lcZ(2,1,"SHARED.COMPONENTS.MANAGERS_PAGE.NO_AVAILABLE_ROLES"),"\n"))}let De=(()=>{class e{constructor(e,t,i,a,o){this.dialog=e,this.tableConfigService=t,this.authzService=i,this.storeService=a,this.guiAuthResolver=o,this.groups=null,this.managers=null,this.selectionUsers=new s.Ov(!0,[]),this.selectionGroups=new s.Ov(!0,[]),this.selectedMode="",this.loading=!1,this.tableId=r.HC,this.availableRolesPrivileges=new Map}ngOnInit(){this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.guiAuthResolver.getRolesAuthorization(this.availableRoles,this.complementaryObject,this.availableRolesPrivileges),this.availableRoles=this.availableRoles.filter(e=>this.availableRolesPrivileges.get(e).readAuth),0!==this.availableRoles.length&&(this.selectedRole=this.availableRoles[0]),this.routeAuth=this.guiAuthResolver.isPerunAdmin(),this.refreshUsers()}changeRolePrivileges(){this.manageAuth=this.availableRolesPrivileges.get(this.selectedRole).manageAuth,this.roleModes=this.availableRolesPrivileges.get(this.selectedRole).modes;let e=!1;for(const t of this.roleModes)if(this.selectedMode===t.toLowerCase()){e=!0;break}e||(this.selectedMode=this.roleModes[0].toLowerCase())}tabChanged(e){this.loading=!0,0===e.index?(this.selectedMode="user",this.refreshUsers()):(this.selectedMode="group",this.refreshGroups())}refreshUsers(){this.loading=!0,this.changeRolePrivileges();let e=[l.r.USER_DEF_ORGANIZATION,l.r.USER_DEF_PREFERRED_MAIL];e=e.concat(this.storeService.getLoginAttributeNames()),this.authzService.getAuthzRichAdmins(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType,e,!1,!0).subscribe(e=>{this.managers=e,this.selectionUsers.clear(),this.loading=!1},()=>{this.loading=!1})}refreshGroups(){this.loading=!0,this.changeRolePrivileges(),this.authzService.getAuthzAdminGroups(this.selectedRole,this.complementaryObject.id,this.complementaryObjectType).subscribe(e=>{this.groups=e,this.selectionGroups.clear(),this.loading=!1},()=>{this.loading=!1})}addManager(){const e=(0,se.kZ)();e.width="1000px",e.data={complementaryObject:this.complementaryObject,theme:this.theme,availableRoles:this.availableRoles,selectedRole:this.selectedRole},this.dialog.open(x,e).afterClosed().subscribe(e=>{e&&this.refreshUsers()})}removeManager(){const e=(0,se.kZ)();e.width="450px",e.data={managers:this.selectionUsers.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(G,e).afterClosed().subscribe(e=>{e&&this.refreshUsers()})}removeGroup(){const e=(0,se.kZ)();e.width="450px",e.data={groups:this.selectionGroups.selected,complementaryObject:this.complementaryObject,role:this.selectedRole,theme:this.theme},this.dialog.open(P,e).afterClosed().subscribe(e=>{e&&this.refreshGroups()})}addGroup(){const e=(0,se.kZ)();e.width="1000px",e.data={complementaryObject:this.complementaryObject,availableRoles:this.availableRoles,theme:this.theme,selectedRole:this.selectedRole},this.dialog.open(ie,e).afterClosed().subscribe(e=>{e&&this.refreshGroups()})}pageChanged(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(u.Y36(a.uw),u.Y36(r.dB),u.Y36(n.Ct),u.Y36(o.d6),u.Y36(o.x4))},e.\u0275cmp=u.Xpm({type:e,selectors:[["app-managers-page"]],hostVars:2,hostBindings:function(e,t){2&e&&u.ekj("router-component",t.true)},inputs:{complementaryObject:"complementaryObject",availableRoles:"availableRoles",complementaryObjectType:"complementaryObjectType",theme:"theme"},decls:11,vars:4,consts:[[1,"page-subtitle"],[3,"selectedTabChange"],["matTabLabel",""],["matTabContent",""],["alert_type","warn",4,"ngIf"],["class","mt-2",3,"refresh",4,"ngIf"],["mat-flat-button","","color","accent","class","mr-2 mt-2",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2 mt-2",3,"disabled","click",4,"ngIf"],["class","mr-2 mt-2",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],[4,"ngIf"],[1,"mt-2",3,"refresh"],["mat-flat-button","","color","accent",1,"mr-2","mt-2",3,"click"],["mat-flat-button","","color","warn",1,"mr-2","mt-2",3,"disabled","click"],[1,"mr-2","mt-2"],[3,"value","valueChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"ml-auto","mr-auto"],[3,"pageSize","users","disableRouting","displayedColumns","selection","page",4,"ngIf"],[3,"pageSize","users","disableRouting","displayedColumns","selection","page"],[3,"pageSize","displayedColumns","groups","selection","disableMembers","page",4,"ngIf"],[3,"pageSize","displayedColumns","groups","selection","disableMembers","page"],["alert_type","warn"]],template:function(e,t){1&e&&(u.TgZ(0,"h1",0),u._uU(1),u.ALo(2,"translate"),u.qZA(),u.TgZ(3,"mat-tab-group",1),u.NdJ("selectedTabChange",function(e){return t.tabChanged(e)}),u.TgZ(4,"mat-tab"),u.YNc(5,ne,2,3,"ng-template",2),u.YNc(6,Ae,6,6,"ng-template",3),u.qZA(),u.TgZ(7,"mat-tab"),u.YNc(8,Se,2,3,"ng-template",2),u.YNc(9,xe,6,6,"ng-template",3),u.qZA(),u.qZA(),u.YNc(10,Ne,3,3,"app-alert",4)),2&e&&(u.xp6(1),u.hij(" ",u.lcZ(2,2,"SHARED.COMPONENTS.MANAGERS_PAGE.TITLE"),"\n"),u.xp6(9),u.Q6J("ngIf",0===t.availableRoles.length))},directives:[ae.SP,ae.uX,ae.uD,ae.Vc,m.O5,oe.t,A.lW,h.KE,h.hX,g.gD,m.sg,S.ey,b.$g,E.C,$.W,R.w],pipes:[d.X$,Z],styles:[""]}),e})()},91721:function(e,t,i){"use strict";i.d(t,{Q:function(){return G}});var s=i(31572),a=i(58623),o=i(67033),n=i(4230),r=i(27613),l=i(88426),c=i(82819),u=i(61511),d=i(29236),p=i(43691),h=i(36922),g=i(84534),m=i(57629),f=i(39571),A=i(48160);function S(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"th",16),s.TgZ(1,"mat-checkbox",17),s.NdJ("change",function(t){s.CHM(e);const i=s.oxw();return t?i.masterToggle():null}),s.qZA(),s.qZA()}if(2&e){const e=s.oxw();s.xp6(1),s.Q6J("aria-label",e.checkboxLabel())("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())}}function b(e,t){if(1&e){const e=s.EpF();s.TgZ(0,"td",18),s.TgZ(1,"mat-checkbox",19),s.NdJ("change",function(t){const i=s.CHM(e).$implicit,a=s.oxw();return t?a.selection.toggle(i):null})("click",function(e){return e.stopPropagation()}),s.qZA(),s.qZA()}if(2&e){const e=t.$implicit,i=s.oxw();s.xp6(1),s.Q6J("aria-label",i.checkboxLabel(e))("checked",i.selection.isSelected(e))}}function R(e,t){1&e&&(s.TgZ(0,"th",20),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e&&(s.xp6(1),s.Oqu(s.lcZ(2,1,"SHARED.COMPONENTS.SERVICES_LIST.ID")))}function E(e,t){if(1&e&&(s.TgZ(0,"td",18),s._uU(1),s.qZA()),2&e){const e=t.$implicit;s.xp6(1),s.Oqu(e.id)}}function Z(e,t){1&e&&(s.TgZ(0,"th",20),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e&&(s.xp6(1),s.Oqu(s.lcZ(2,1,"SHARED.COMPONENTS.SERVICES_LIST.NAME")))}function I(e,t){if(1&e&&(s.TgZ(0,"td",21),s._uU(1),s.qZA()),2&e){const e=t.$implicit;s.xp6(1),s.Oqu(e.name)}}function v(e,t){1&e&&s._UZ(0,"th",16)}function T(e,t){1&e&&(s.TgZ(0,"mat-icon",23),s.ALo(1,"translate"),s._uU(2," check_circle_outline "),s.qZA()),2&e&&s.s9C("matTooltip",s.lcZ(1,1,"SHARED.COMPONENTS.SERVICES_LIST.ENABLED"))}function O(e,t){1&e&&(s.TgZ(0,"mat-icon",23),s.ALo(1,"translate"),s._uU(2," block "),s.qZA()),2&e&&s.s9C("matTooltip",s.lcZ(1,1,"SHARED.COMPONENTS.SERVICES_LIST.DISABLED"))}function C(e,t){if(1&e&&(s.TgZ(0,"td",21),s.YNc(1,T,3,3,"mat-icon",22),s.YNc(2,O,3,3,"mat-icon",22),s.qZA()),2&e){const e=t.$implicit;s.xp6(1),s.Q6J("ngIf",e.enabled),s.xp6(1),s.Q6J("ngIf",!e.enabled)}}function _(e,t){1&e&&(s.TgZ(0,"th",16),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e&&(s.xp6(1),s.Oqu(s.lcZ(2,1,"SHARED.COMPONENTS.SERVICES_LIST.SCRIPT")))}function x(e,t){if(1&e&&(s.TgZ(0,"td",21),s._uU(1),s.qZA()),2&e){const e=t.$implicit;s.xp6(1),s.Oqu(e.script)}}function N(e,t){1&e&&(s.TgZ(0,"th",20),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e&&(s.xp6(1),s.Oqu(s.lcZ(2,1,"SHARED.COMPONENTS.SERVICES_LIST.DESCRIPTION")))}function D(e,t){if(1&e&&(s.TgZ(0,"td",21),s._uU(1),s.qZA()),2&e){const e=t.$implicit;s.xp6(1),s.Oqu(e.description)}}function w(e,t){1&e&&s._UZ(0,"tr",24)}const U=function(e){return["/admin/services",e]};function L(e,t){if(1&e&&s._UZ(0,"tr",25),2&e){const e=t.$implicit,i=s.oxw();s.ekj("cursor-pointer",!i.disableRouting)("disable-outline",i.disableRouting),s.Q6J("perunWebAppsMiddleClickRouterLink",i.disableRouting?null:s.VKq(6,U,e.id))("routerLink",i.disableRouting?null:s.VKq(8,U,e.id))}}function y(e,t){1&e&&(s.TgZ(0,"app-alert",26),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}function M(e,t){1&e&&(s.TgZ(0,"app-alert",26),s._uU(1),s.ALo(2,"translate"),s.qZA()),2&e&&(s.xp6(1),s.hij(" ",s.lcZ(2,1,"SHARED.COMPONENTS.SERVICES_LIST.NO_SERVICES_WARNING"),"\n"))}let G=(()=>{class e{constructor(e,t){this.authResolver=e,this.tableCheckbox=t,this.services=[],this.filterValue="",this.pageSize=10,this.displayedColumns=["select","id","name","enabled","script","description"],this.selection=new n.Ov(!0,[]),this.disableRouting=!1,this.page=new s.vpe,this.pageSizeOptions=r.f7}set matSort(e){this.sort=e,this.setDataSource()}ngOnChanges(e){this.authResolver.isPerunAdmin()||(this.displayedColumns=this.displayedColumns.filter(e=>"id"!==e)),this.dataSource=new o.by(this.services),this.setDataSource()}getDataForColumn(e,t){switch(t){case"id":return e.id.toString();case"name":return e.name;case"enabled":return e.enabled?"true":"false";case"script":return e.script;case"description":return e.description;default:return""}}exportData(e){(0,r.O6)((0,r.Xn)(this.dataSource.filteredData,this.displayedColumns,this.getDataForColumn,this),e)}setDataSource(){this.dataSource&&(this.dataSource.filterPredicate=(e,t)=>(0,r.Sd)(e,t,this.displayedColumns,this.getDataForColumn,this),this.dataSource.sortData=(e,t)=>(0,r.pR)(e,t,this.getDataForColumn,this),this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue)}isAllSelected(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}masterToggle(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.pageSize,this.child.paginator.pageIndex,!1)}checkboxLabel(e){return e?`${this.selection.isSelected(e)?"deselect":"select"} row ${e.id+1}`:(this.isAllSelected()?"select":"deselect")+" all"}ngAfterViewInit(){this.dataSource.paginator=this.child.paginator}}return e.\u0275fac=function(t){return new(t||e)(s.Y36(l.x4),s.Y36(l.UA))},e.\u0275cmp=s.Xpm({type:e,selectors:[["app-services-list"]],viewQuery:function(e,t){if(1&e&&(s.Gf(a.YE,7),s.Gf(r.l9,7)),2&e){let e;s.iGM(e=s.CRH())&&(t.matSort=e.first),s.iGM(e=s.CRH())&&(t.child=e.first)}},inputs:{services:"services",filterValue:"filterValue",pageSize:"pageSize",displayedColumns:"displayedColumns",selection:"selection",disableRouting:"disableRouting"},outputs:{page:"page"},features:[s.TTD],decls:25,vars:9,consts:[[1,"card","mt-3",3,"hidden"],[3,"dataLength","pageSizeOptions","pageSize","exportData","page"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","name"],["mat-cell","",4,"matCellDef"],["matColumnDef","enabled"],["matColumnDef","script"],["matColumnDef","description"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",3,"cursor-pointer","disable-outline","perunWebAppsMiddleClickRouterLink","routerLink",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["class","align-bottom",3,"matTooltip",4,"ngIf"],[1,"align-bottom",3,"matTooltip"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item",3,"perunWebAppsMiddleClickRouterLink","routerLink"],["alert_type","warn"]],template:function(e,t){1&e&&(s.TgZ(0,"div",0),s.TgZ(1,"perun-web-apps-table-wrapper",1),s.NdJ("exportData",function(e){return t.exportData(e)})("page",function(e){return t.page.emit(e)}),s.TgZ(2,"table",2),s.ynx(3,3),s.YNc(4,S,2,3,"th",4),s.YNc(5,b,2,2,"td",5),s.BQk(),s.ynx(6,6),s.YNc(7,R,3,3,"th",7),s.YNc(8,E,2,1,"td",5),s.BQk(),s.ynx(9,8),s.YNc(10,Z,3,3,"th",7),s.YNc(11,I,2,1,"td",9),s.BQk(),s.ynx(12,10),s.YNc(13,v,1,0,"th",4),s.YNc(14,C,3,2,"td",9),s.BQk(),s.ynx(15,11),s.YNc(16,_,3,3,"th",4),s.YNc(17,x,2,1,"td",9),s.BQk(),s.ynx(18,12),s.YNc(19,N,3,3,"th",7),s.YNc(20,D,2,1,"td",9),s.BQk(),s.YNc(21,w,1,0,"tr",13),s.YNc(22,L,1,10,"tr",14),s.qZA(),s.qZA(),s.qZA(),s.YNc(23,y,3,3,"app-alert",15),s.YNc(24,M,3,3,"app-alert",15)),2&e&&(s.Q6J("hidden",void 0===t.services||0===t.services.length||0===t.dataSource.filteredData.length),s.xp6(1),s.Q6J("dataLength",t.dataSource.filteredData.length)("pageSizeOptions",t.pageSizeOptions)("pageSize",t.pageSize),s.xp6(1),s.Q6J("dataSource",t.dataSource),s.xp6(19),s.Q6J("matHeaderRowDef",t.displayedColumns),s.xp6(1),s.Q6J("matRowDefColumns",t.displayedColumns),s.xp6(1),s.Q6J("ngIf",0===t.dataSource.filteredData.length&&void 0!==t.services&&0!==t.services.length),s.xp6(1),s.Q6J("ngIf",void 0===t.services||0===t.services.length))},directives:[c.l,o.BZ,a.YE,o.w1,o.fO,o.Dz,o.as,o.nj,u.O5,o.ge,d.oG,o.ev,a.nU,p.Hw,h.gM,o.XQ,o.Gk,g.YH,m.rH,f.w],pipes:[A.X$],styles:[".cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}.disable-outline[_ngcontent-%COMP%]{outline:none!important}"]}),e})()}}]);