!function(){function e(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==i)return;var a,n,s=[],l=!0,o=!1;try{for(i=i.call(e);!(l=(a=i.next()).done)&&(s.push(a.value),!t||s.length!==t);l=!0);}catch(r){o=!0,n=r}finally{try{l||null==i.return||i.return()}finally{if(o)throw n}}return s}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=a(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,s=function(){};return{s:s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,r=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){r=!0,l=e},f:function(){try{o||null==i.return||i.return()}finally{if(r)throw l}}}}function a(e,t){if(e){if("string"==typeof e)return n(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(e,t):void 0}}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function o(e,t,i){return t&&l(e.prototype,t),i&&l(e,i),e}(self.webpackChunkperun_web_apps=self.webpackChunkperun_web_apps||[]).push([[300],{55300:function(a,n,l){"use strict";l.r(n),l.d(n,{FacilitiesModule:function(){return Fn}});var r=l(61511),c=l(57629),u=l(73916),d=l(17),h=l(75585),f=l(33642),p=l(27613),g=l(88426),m=l(81954),S=l(30570),A=l(31572),v=l(84608),T=l(48958),I=l(66297),y=l(67806),b=l(43691),E=l(36922),C=l(21575),Z=l(15980),_=l(48160);function k(e,t){1&e&&A._UZ(0,"mat-spinner",3)}function L(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",12),A.NdJ("click",function(){return A.CHM(i),A.oxw(2).editFacility()}),A.TgZ(1,"mat-icon"),A._uU(2,"edit"),A.qZA(),A.qZA()}}function x(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",12),A.NdJ("click",function(){return A.CHM(i),A.oxw(2).deleteFacility()}),A.TgZ(1,"mat-icon"),A._uU(2,"delete_forever"),A.qZA(),A.qZA()}}var O=function(){return{color:"black"}},D=function(e){return["/facilities",e]};function R(e,t){if(1&e&&(A.TgZ(0,"div"),A.TgZ(1,"div",4),A._UZ(2,"mat-icon",5),A.ALo(3,"translate"),A.TgZ(4,"div",6),A.TgZ(5,"div",7),A.TgZ(6,"a",8),A._uU(7),A.qZA(),A.TgZ(8,"span",9),A._uU(9),A.qZA(),A.YNc(10,L,3,0,"button",10),A.YNc(11,x,3,0,"button",10),A.qZA(),A.TgZ(12,"span",11),A._uU(13),A.ALo(14,"translate"),A.ALo(15,"translate"),A.qZA(),A.qZA(),A.qZA(),A._UZ(16,"app-animated-router-outlet"),A.qZA()),2&e){var i=A.oxw();A.xp6(2),A.s9C("matTooltip",A.lcZ(3,10,"FACILITY_DETAIL.ENTITY")),A.Q6J("ngStyle",A.DdM(16,O)),A.xp6(4),A.Q6J("routerLink",A.VKq(17,D,i.facility.id)),A.xp6(1),A.Oqu(i.facility.name),A.xp6(2),A.hij(" \xa0#",i.facility.id," "),A.xp6(1),A.Q6J("ngIf",i.editFacilityAuth),A.xp6(1),A.Q6J("ngIf",i.deleteAuth),A.xp6(2),A.lnq(" ",A.lcZ(14,12,"FACILITY_DETAIL.ENTITY"),", ",A.lcZ(15,14,"FACILITY_DETAIL.DESCRIPTION"),": ",i.facility.description," ")}}var N=function(){var e=function(){function e(t,i,a,n,l,o,r){s(this,e),this.dialog=t,this.facilityManager=i,this.route=a,this.sideMenuService=n,this.sideMenuItemService=l,this.guiAuthResolver=o,this.router=r,this.editFacilityAuth=!1,this.deleteAuth=!1,this.loading=!1}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.params.subscribe(function(t){e.facilityManager.getFacilityById(t.facilityId).subscribe(function(t){e.facility=t;var i=e.sideMenuItemService.parseFacility(t);e.sideMenuService.setFacilityMenuItems([i]),e.editFacilityAuth=e.guiAuthResolver.isAuthorized("updateFacility_Facility_policy",[e.facility]),e.deleteAuth=e.guiAuthResolver.isAuthorized("deleteFacility_Facility_Boolean_policy",[e.facility]),(0,p.sF)("facilities",e.facility),(0,p.XI)(e.facility),e.loading=!1},function(){return e.loading=!1})})}},{key:"editFacility",value:function(){var e=this,t=(0,p.kZ)();t.width="450px",t.data={theme:"facility-theme",facility:this.facility,dialogType:m.Eg.FACILITY},this.dialog.open(m.rd,t).afterClosed().subscribe(function(t){t&&e.facilityManager.getFacilityById(e.facility.id).subscribe(function(t){e.facility=t})})}},{key:"deleteFacility",value:function(){var e=this,t=(0,p.kZ)();t.width="500px",t.data={theme:"facility-theme",facility:this.facility},this.dialog.open(S.Y,t).afterClosed().subscribe(function(t){t&&e.router.navigate([""])})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(v.uw),A.Y36(f.IQ),A.Y36(c.gz),A.Y36(T.D),A.Y36(h.V),A.Y36(g.x4),A.Y36(c.F0))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-detail-page"]],decls:4,vars:2,consts:[[1,"container-fluid","pl-xl-5","pr-xl-5","facility-theme"],["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[1,"d-flex","page-title-headtitle"],["svgIcon","perun-facility-black",1,"perun-icon","perun-icon-detail",3,"matTooltip","ngStyle"],[1,"page-title-block"],[1,"page-title-headline","d-flex","align-items-center"],["queryParamsHandling","merge",1,"facility-link",3,"routerLink"],[1,"text-muted"],["mat-icon-button","",3,"click",4,"ngIf"],[1,"mt-1","entity-info"],["mat-icon-button","",3,"click"]],template:function(e,t){1&e&&(A.TgZ(0,"div",0),A._UZ(1,"perun-web-apps-back-button"),A.YNc(2,k,1,0,"mat-spinner",1),A.YNc(3,R,17,19,"div",2),A.qZA()),2&e&&(A.xp6(2),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading&&void 0!==t.facility))},directives:[I.W,r.O5,y.$g,b.Hw,E.gM,r.PC,c.yS,C.A,Z.lW],pipes:[_.X$],styles:[""],data:{animation:[d.Ji]}}),e}(),w=l(8557);function Y(e,t){1&e&&A._UZ(0,"mat-spinner",2)}function M(e,t){if(1&e&&(A.TgZ(0,"div"),A._UZ(1,"perun-web-apps-menu-buttons-field",3),A.qZA()),2&e){var i=A.oxw();A.xp6(1),A.Q6J("items",i.navItems)("size","small")}}var F=function(){var e=function(){function e(t,i,a){s(this,e),this.facilityManager=t,this.route=i,this.authResolver=a,this.navItems=[],this.loading=!1}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.params.subscribe(function(t){e.facilityManager.getFacilityById(t.facilityId).subscribe(function(t){e.facility=t,e.initItems(),e.loading=!1},function(){return e.loading=!1})})}},{key:"initItems",value:function(){this.navItems=[],this.authResolver.isAuthorized("getAssignedRichResources_Facility_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-manage-facility",url:"/facilities/".concat(this.facility.id,"/resources"),label:"MENU_ITEMS.FACILITY.RESOURCES",style:"facility-btn"}),this.authResolver.isAuthorized("getAssignedUsers_Facility_Service_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-user",url:"/facilities/".concat(this.facility.id,"/allowed-users"),label:"MENU_ITEMS.FACILITY.ALLOWED_USERS",style:"facility-btn"}),this.authResolver.isAuthorized("getAllowedGroups_Facility_Vo_Service_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-group",url:"/facilities/".concat(this.facility.id,"/allowed-groups"),label:"MENU_ITEMS.FACILITY.ALLOWED_GROUPS",style:"facility-btn"}),this.authResolver.isAuthorized("getFacilityServicesState_Facility_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-service-status",url:"/facilities/".concat(this.facility.id,"/services-status"),label:"MENU_ITEMS.FACILITY.SERVICES_STATUS",style:"facility-btn"}),this.authResolver.isAuthorized("getAllRichDestinations_Facility_policy",[this.facility])&&this.navItems.push({cssIcon:"perun-service_destination",url:"/facilities/".concat(this.facility.id,"/services-destinations"),label:"MENU_ITEMS.FACILITY.SERVICES_DESTINATIONS",style:"facility-btn"}),this.authResolver.isFacilityAdmin()&&this.navItems.push({cssIcon:"perun-hosts",url:"/facilities/".concat(this.facility.id,"/hosts"),label:"MENU_ITEMS.FACILITY.HOSTS",style:"facility-btn"}),this.navItems.push({cssIcon:"perun-attributes",url:"/facilities/".concat(this.facility.id,"/attributes"),label:"MENU_ITEMS.FACILITY.ATTRIBUTES",style:"facility-btn"}),(this.authResolver.isAuthorized("getBansForFacility_int_policy",[this.facility])||this.authResolver.isManagerPagePrivileged(this.facility)||this.authResolver.isAuthorized("getOwners_Facility_policy",[this.facility])||this.authResolver.isAuthorized("getAssignedSecurityTeams_Facility_policy",[this.facility]))&&this.navItems.push({cssIcon:"perun-settings2",url:"/facilities/".concat(this.facility.id,"/settings"),label:"MENU_ITEMS.FACILITY.SETTINGS",style:"facility-btn"})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(f.IQ),A.Y36(c.gz),A.Y36(g.x4))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&A.ekj("router-component",t.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(A.YNc(0,Y,1,0,"mat-spinner",0),A.YNc(1,M,2,2,"div",1)),2&e&&(A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[r.O5,y.$g,w.L],styles:[""]}),e}(),q=l(64467),U=l(39124),J=l(72920),Q=l(76527),z=function(){var e=function(){function e(){s(this,e)}return o(e,[{key:"ngOnInit",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-settings"]],hostVars:2,hostBindings:function(e,t){2&e&&A.ekj("router-component",t.true)},decls:1,vars:0,template:function(e,t){1&e&&A._UZ(0,"app-animated-router-outlet")},directives:[C.A],styles:[""],data:{animation:[d.Ji]}}),e}();function H(e,t){1&e&&A._UZ(0,"mat-spinner",2)}function V(e,t){if(1&e&&(A.TgZ(0,"div"),A._UZ(1,"perun-web-apps-menu-buttons-field",3),A.qZA()),2&e){var i=A.oxw();A.xp6(1),A.Q6J("items",i.items)("size","small")}}var B=function(){var e=function(){function e(t,i,a){s(this,e),this.route=t,this.facilityManager=i,this.authResolver=a,this.items=[],this.loading=!1}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.route.parent.parent.params.subscribe(function(t){e.facilityManager.getFacilityById(t.facilityId).subscribe(function(t){e.facility=t,e.initItems(),e.loading=!1},function(){return e.loading=!1})})}},{key:"initItems",value:function(){this.items=[],this.authResolver.isAuthorized("getOwners_Facility_policy",[this.facility])&&this.items.push({cssIcon:"perun-owner-grey",url:"/facilities/".concat(this.facility.id,"/settings/owners"),label:"MENU_ITEMS.FACILITY.OWNERS",style:"facility-btn"}),this.authResolver.isManagerPagePrivileged(this.facility)&&this.items.push({cssIcon:"perun-manager",url:"/facilities/".concat(this.facility.id,"/settings/managers"),label:"MENU_ITEMS.FACILITY.MANAGERS",style:"facility-btn"}),this.authResolver.isAuthorized("getAssignedSecurityTeams_Facility_policy",[this.facility])&&this.items.push({cssIcon:"perun-security-teams",url:"/facilities/".concat(this.facility.id,"/settings/security-teams"),label:"MENU_ITEMS.FACILITY.SECURITY_TEAMS",style:"facility-btn"}),this.authResolver.isAuthorized("getBansForFacility_int_policy",[this.facility])&&this.items.push({cssIcon:"perun-black-list",url:"/facilities/".concat(this.facility.id,"/settings/blacklist"),label:"MENU_ITEMS.FACILITY.BLACKLIST",style:"facility-btn"})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(c.gz),A.Y36(f.IQ),A.Y36(g.x4))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-settings-overview"]],hostVars:2,hostBindings:function(e,t){2&e&&A.ekj("router-component",t.true)},decls:2,vars:2,consts:[["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[3,"items","size"]],template:function(e,t){1&e&&(A.YNc(0,H,1,0,"mat-spinner",0),A.YNc(1,V,2,2,"div",1)),2&e&&(A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[r.O5,y.$g,w.L],styles:[""]}),e}(),P=l(55109),G=l(541),$=l(69012);function j(e,t){1&e&&(A._uU(0),A.ALo(1,"translate")),2&e&&A.hij(" ",A.lcZ(1,1,"FACILITY_DETAIL.ENTITY")," ")}function K(e,t){if(1&e&&A._UZ(0,"app-one-entity-attribute-page",4),2&e){var i=A.oxw();A.Q6J("entity","facility")("entityId",i.facilityId)}}function W(e,t){1&e&&(A._uU(0),A.ALo(1,"translate"),A.ALo(2,"translate")),2&e&&A.AsE(" ",A.lcZ(1,2,"FACILITY_DETAIL.ENTITY")," - ",A.lcZ(2,4,"ADMIN_USER.ENTITY")," ")}function X(e,t){if(1&e&&A._UZ(0,"app-two-entity-attribute-page",5),2&e){var i=A.oxw(2);A.Q6J("firstEntity","facility")("firstEntityId",i.facilityId)("secondEntity","user")}}function ee(e,t){1&e&&(A.TgZ(0,"mat-tab"),A.YNc(1,W,3,6,"ng-template",1),A.YNc(2,X,1,3,"ng-template",2),A.qZA())}var te=function(){var e=function(){function e(t,i){s(this,e),this.route=t,this.authResolver=i}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.route.parent.params.subscribe(function(t){e.facilityId=t.facilityId,e.facilityUserAttAuth=e.authResolver.isAuthorized("getAssignedUsers_Facility_policy",[{id:e.facilityId,beanName:"Facility"}])})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(c.gz),A.Y36(g.x4))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-attributes"]],hostVars:2,hostBindings:function(e,t){2&e&&A.ekj("router-component",t.true)},decls:9,vars:4,consts:[[1,"page-subtitle"],["matTabLabel",""],["matTabContent",""],[4,"ngIf"],[3,"entity","entityId"],[3,"firstEntity","firstEntityId","secondEntity"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"mat-tab-group"),A.TgZ(5,"mat-tab"),A.YNc(6,j,2,3,"ng-template",1),A.YNc(7,K,1,2,"ng-template",2),A.qZA(),A.YNc(8,ee,3,0,"mat-tab",3),A.qZA(),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,2,"FACILITY_DETAIL.SETTINGS.ATTRIBUTES.TITLE")),A.xp6(6),A.Q6J("ngIf",t.facilityUserAttAuth))},directives:[P.SP,P.uX,P.uD,P.Vc,r.O5,G.t,$.Y],pipes:[_.X$],styles:[""]}),e}(),ie=l(77968),ae=l(22927),ne=l(79472),se=l(42473),le=l(16073),oe=l(56238),re=l(79996),ce=l(22280),ue=l(29236),de=l(66283),he=l(80340),fe=l(40084),pe=l(71522),ge=l(22196);function me(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-option",10),A.NdJ("onSelectionChange",function(){var e=A.CHM(i).$implicit;return A.oxw(3).onSelectedService(e)}),A._uU(1),A.qZA()}if(2&e){var a=t.$implicit;A.Q6J("value",a),A.xp6(1),A.hij(" ",a.name," ")}}function Se(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-form-field",6),A.TgZ(1,"input",7),A.NdJ("keyup",function(e){return A.CHM(i),A.oxw(2).updatedSerVal(e)}),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"mat-autocomplete",8,9),A.TgZ(5,"mat-option",10),A.NdJ("onSelectionChange",function(){return A.CHM(i),A.oxw(2).onSelectedService("NOT_SELECTED")}),A._uU(6),A.ALo(7,"translate"),A.qZA(),A.TgZ(8,"mat-option",10),A.NdJ("onSelectionChange",function(){return A.CHM(i),A.oxw(2).onSelectedService("ALL")}),A._uU(9),A.ALo(10,"translate"),A.qZA(),A.YNc(11,me,2,2,"mat-option",11),A.ALo(12,"async"),A.qZA(),A.qZA()}if(2&e){var a=A.MAs(4),n=A.oxw(2);A.xp6(1),A.s9C("placeholder",A.lcZ(2,9,"FACILITY_DETAIL.SERVICE_CONFIG.SERVICE_SELECT")),A.Q6J("formControl",n.serviceField)("matAutocomplete",a),A.xp6(2),A.Q6J("displayWith",n.serviceDisplayFn.bind(n)),A.xp6(2),A.Q6J("value","NOT_SELECTED"),A.xp6(1),A.hij(" ",A.lcZ(7,11,"FACILITY_DETAIL.SERVICE_CONFIG.NOT_SELECTED")," "),A.xp6(2),A.Q6J("value","ALL"),A.xp6(1),A.hij(" ",A.lcZ(10,13,"FACILITY_DETAIL.SERVICE_CONFIG.ALL")," "),A.xp6(2),A.Q6J("ngForOf",A.lcZ(12,15,n.filteredServices))}}function Ae(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-option",10),A.NdJ("onSelectionChange",function(){var e=A.CHM(i).$implicit;return A.oxw(3).onSelectedResource(e)}),A._uU(1),A.qZA()}if(2&e){var a=t.$implicit;A.Q6J("value",a),A.xp6(1),A.hij(" ",a.name," ")}}function ve(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-form-field",6),A.TgZ(1,"input",12),A.NdJ("keyup",function(e){return A.CHM(i),A.oxw(2).updatedResVal(e)}),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"mat-autocomplete",8,9),A.YNc(5,Ae,2,2,"mat-option",11),A.ALo(6,"async"),A.qZA(),A.qZA()}if(2&e){var a=A.MAs(4),n=A.oxw(2);A.xp6(1),A.s9C("placeholder",A.lcZ(2,5,"FACILITY_DETAIL.SERVICE_CONFIG.RES_SELECT")),A.Q6J("matAutocomplete",a)("formControl",n.resourceField),A.xp6(2),A.Q6J("displayWith",n.resourceDisplayFn.bind(n)),A.xp6(2),A.Q6J("ngForOf",A.lcZ(6,7,n.filteredResources))}}function Te(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-option",10),A.NdJ("onSelectionChange",function(){var e=A.CHM(i).$implicit;return A.oxw(3).onSelectedGroup(e)}),A._uU(1),A.qZA()}if(2&e){var a=t.$implicit;A.Q6J("value",a),A.xp6(1),A.hij(" ",a.name," ")}}function Ie(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-form-field",6),A.TgZ(1,"input",12),A.NdJ("keyup",function(e){return A.CHM(i),A.oxw(2).updatedGroupVal(e)}),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"mat-autocomplete",13,9),A.YNc(5,Te,2,2,"mat-option",11),A.ALo(6,"async"),A.qZA(),A.qZA()}if(2&e){var a=A.MAs(4),n=A.oxw(2);A.xp6(1),A.s9C("placeholder",A.lcZ(2,5,"FACILITY_DETAIL.SERVICE_CONFIG.GROUP_SELECT")),A.Q6J("matAutocomplete",a)("formControl",n.groupField),A.xp6(2),A.Q6J("displayWith",n.groupDisplayFn.bind(n)),A.xp6(2),A.Q6J("ngForOf",A.lcZ(6,7,n.filteredGroups))}}function ye(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-option",10),A.NdJ("onSelectionChange",function(){var e=A.CHM(i).$implicit;return A.oxw(3).onSelectedMember(e)}),A._uU(1),A.ALo(2,"userFullName"),A.qZA()}if(2&e){var a=t.$implicit;A.Q6J("value",a),A.xp6(1),A.hij(" ",A.lcZ(2,2,a.user)," ")}}function be(e,t){if(1&e&&(A.TgZ(0,"mat-form-field",6),A._UZ(1,"input",14),A.ALo(2,"translate"),A.TgZ(3,"mat-autocomplete",8,9),A.YNc(5,ye,3,4,"mat-option",11),A.ALo(6,"async"),A.qZA(),A.qZA()),2&e){var i=A.MAs(4),a=A.oxw(2);A.xp6(1),A.s9C("placeholder",A.lcZ(2,5,"FACILITY_DETAIL.SERVICE_CONFIG.MEMBER_SELECT")),A.Q6J("formControl",a.memberField)("matAutocomplete",i),A.xp6(2),A.Q6J("displayWith",a.memberDisplayFn.bind(a)),A.xp6(2),A.Q6J("ngForOf",A.lcZ(6,7,a.filteredMembers))}}function Ee(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"div",3),A.YNc(1,Se,13,17,"mat-form-field",4),A.TgZ(2,"mat-checkbox",5),A.NdJ("change",function(e){return A.CHM(i),A.oxw().onOfferAllServices(e)}),A._uU(3),A.ALo(4,"translate"),A.qZA(),A.YNc(5,ve,7,9,"mat-form-field",4),A.YNc(6,Ie,7,9,"mat-form-field",4),A.YNc(7,be,7,9,"mat-form-field",4),A.qZA()}if(2&e){var a=A.oxw();A.xp6(1),A.Q6J("ngIf",void 0!==a.services),A.xp6(2),A.hij(" ",A.lcZ(4,5,"FACILITY_DETAIL.SERVICE_CONFIG.ALL_SERVICES")," "),A.xp6(2),A.Q6J("ngIf",void 0!==a.resources&&0!=a.resources.length),A.xp6(1),A.Q6J("ngIf",void 0!==a.selectedResource&&void 0!==a.groups&&0!=a.groups.length),A.xp6(1),A.Q6J("ngIf",void 0!==a.selectedGroup&&void 0!==a.members&&0!==a.members.length)}}function Ce(e,t){if(1&e&&A._UZ(0,"perun-web-apps-service-configurator",15),2&e){var i=A.oxw();A.Q6J("facility",i.facility)("resource",i.selectedResource)("group",i.selectedGroup)("service",i.selectedService)("member",i.selectedMember)}}var Ze=function(){var e=function(){function e(t,i,a,n,l,o,r){var c=this;s(this,e),this.route=t,this.facilityManager=i,this.resourceManager=a,this.serviceManager=n,this.membersManager=l,this.namePipe=o,this.translate=r,this.selectedService="NOT_SELECTED",this.attrNames=[],this.serviceField=new le.NI,this.resourceField=new le.NI,this.groupField=new le.NI,this.memberField=new le.NI,this.allowedStatuses=["INVALID","VALID"],this.translate.get("FACILITY_DETAIL.SERVICE_CONFIG.ALL").subscribe(function(e){return c.serviceAllTranslation=e}),this.translate.get("FACILITY_DETAIL.SERVICE_CONFIG.NOT_SELECTED").subscribe(function(e){return c.serviceNotSelectedTranslation=e})}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.route.parent.params.subscribe(function(t){e.facilityManager.getFacilityById(t.facilityId).subscribe(function(t){e.facility=t,e.facilityManager.getAssignedResourcesForFacility(t.id).subscribe(function(t){return e.resources=t}),e.serviceManager.getAssignedServices(t.id).subscribe(function(t){return e.services=t})})}),this.filteredServices=this.serviceField.valueChanges.pipe((0,oe.O)(""),(0,re.U)(function(t){return e._filterServices(t)})),this.filteredResources=this.resourceField.valueChanges.pipe((0,oe.O)(""),(0,re.U)(function(t){return e._filterResources(t)})),this.filteredGroups=this.groupField.valueChanges.pipe((0,oe.O)(""),(0,re.U)(function(t){return e._filterGroups(t)})),this.filteredMembers=this.memberField.valueChanges.pipe((0,oe.O)(""),(0,re.U)(function(t){return e._filterMembers(t)}))}},{key:"onSelectedService",value:function(e){this.selectedService=e}},{key:"onSelectedResource",value:function(e){var t=this;this.selectedResource=e,void 0!==this.selectedResource?(this.resourceManager.getAssignedGroups(this.selectedResource.id).subscribe(function(e){return t.groups=e}),this.selectedGroup=void 0,this.selectedMember=void 0):this.groups=void 0}},{key:"onOfferAllServices",value:function(e){var t=this;e.checked||this.serviceManager.getAssignedServices(this.facility.id).subscribe(function(e){return t.services=e})}},{key:"onSelectedGroup",value:function(e){var t=this;this.selectedGroup=e,void 0!==this.selectedGroup?(this.membersManager.getCompleteRichMembersForGroup(this.selectedGroup.id,!1,this.allowedStatuses,this.attrNames).subscribe(function(e){return t.members=e}),this.selectedMember=void 0):this.members=void 0}},{key:"onSelectedMember",value:function(e){this.selectedMember=e}},{key:"_filterServices",value:function(e){var t=e.toString().toLowerCase();return this.services.filter(function(e){return e.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)})}},{key:"_filterResources",value:function(e){var t=e.toString().toLowerCase();return this.resources.filter(function(e){return e.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)})}},{key:"_filterGroups",value:function(e){var t=e.toString().toLowerCase();return this.groups.filter(function(e){return e.name.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(t)})}},{key:"_filterMembers",value:function(e){var t=this,i=e.toString().toLowerCase();return this.members.filter(function(e){return t.namePipe.transform(e.user).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").includes(i)})}},{key:"serviceDisplayFn",value:function(e){if(null!==e)return"ALL"===e?this.serviceAllTranslation:"NOT_SELECTED"===e?this.serviceNotSelectedTranslation:e.name}},{key:"resourceDisplayFn",value:function(e){if(null!==e)return e.name}},{key:"groupDisplayFn",value:function(e){if(null!==e)return e.name}},{key:"memberDisplayFn",value:function(e){if(null!==e)return this.namePipe.transform(e.user)}},{key:"updatedSerVal",value:function(e){""===e.target.value&&(this.selectedService="NOT_SELECTED")}},{key:"updatedResVal",value:function(e){""===e.target.value&&(this.groups=void 0,this.members=void 0)}},{key:"updatedGroupVal",value:function(e){""===e.target.value&&(this.members=void 0)}},{key:"updatedMemVal",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(c.gz),A.Y36(f.IQ),A.Y36(f.xk),A.Y36(f.KK),A.Y36(f.uq),A.Y36(ce.dp),A.Y36(_.sK))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-service-config"]],decls:6,vars:5,consts:[[1,"page-subtitle"],["class","col-12 col-lg-6 mb-2",4,"ngIf"],[3,"facility","resource","group","service","member",4,"ngIf"],[1,"col-12","col-lg-6","mb-2"],["class","w-100",4,"ngIf"],[3,"change"],[1,"w-100"],["type","text","matInput","",3,"placeholder","formControl","matAutocomplete","keyup"],["autoActiveFirstOption","",3,"displayWith"],["auto","matAutocomplete"],[3,"value","onSelectionChange"],[3,"value","onSelectionChange",4,"ngFor","ngForOf"],["type","text","matInput","",3,"placeholder","matAutocomplete","formControl","keyup"],["autoActiveFirstOption","",3,"ngClass","displayWith"],["type","text","matInput","",3,"placeholder","formControl","matAutocomplete"],[3,"facility","resource","group","service","member"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.YNc(4,Ee,8,7,"div",1),A.YNc(5,Ce,1,5,"perun-web-apps-service-configurator",2),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,3,"FACILITY_DETAIL.SERVICE_CONFIG.TITLE")),A.xp6(2),A.Q6J("ngIf",!!t.facility),A.xp6(1),A.Q6J("ngIf",!!t.facility))},directives:[r.O5,ue.oG,de.KE,he.Nt,le.Fj,fe.ZL,le.JJ,le.oH,fe.XC,pe.ey,r.sg,r.mk],pipes:[_.X$,r.Ov,ge.d],styles:[""]}),e}(),_e=l(489);function ke(e,t){if(1&e&&A._UZ(0,"app-managers-page",1),2&e){var i=A.oxw();A.Q6J("complementaryObject",i.facility)("complementaryObjectType",i.type)("theme",i.theme)("availableRoles",i.availableRoles)}}var Le=function(){var e=function(){function e(t,i,a){s(this,e),this.facilityService=t,this.route=i,this.guiAuthResolver=a,this.availableRoles=[],this.selected="user",this.type="Facility",this.theme="facility-theme"}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.route.parent.parent.params.subscribe(function(t){e.facilityService.getFacilityById(t.facilityId).subscribe(function(t){e.facility=t})}),this.guiAuthResolver.assignAvailableRoles(this.availableRoles,"Facility")}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(f.IQ),A.Y36(c.gz),A.Y36(g.x4))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-perun-web-apps-facility-settings-managers"]],hostVars:2,hostBindings:function(e,t){2&e&&A.ekj("router-component",t.true)},decls:1,vars:1,consts:[[3,"complementaryObject","complementaryObjectType","theme","availableRoles",4,"ngIf"],[3,"complementaryObject","complementaryObjectType","theme","availableRoles"]],template:function(e,t){1&e&&A.YNc(0,ke,1,4,"app-managers-page",0),2&e&&A.Q6J("ngIf",t.facility)},directives:[r.O5,_e.s],styles:[""]}),e}(),xe=l(60611),Oe=l(4230),De=l(60547),Re=l(4786);function Ne(e,t){1&e&&A._UZ(0,"mat-spinner",6)}function we(e,t){1&e&&(A.TgZ(0,"mat-option",19),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"DIALOGS.ADD_SERVICE_DESTINATION.SELECTION_ALL")))}function Ye(e,t){1&e&&(A.TgZ(0,"mat-option",20),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"DIALOGS.ADD_SERVICE_DESTINATION.NO_SERVICE")))}function Me(e,t){if(1&e&&(A.TgZ(0,"mat-option",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.Q6J("value",i),A.xp6(1),A.hij(" ",i.name," ")}}function Fe(e,t){1&e&&(A.TgZ(0,"mat-error"),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"DIALOGS.ADD_SERVICE_DESTINATION.CHOOSE_SERVICE")," "))}function qe(e,t){if(1&e&&(A.TgZ(0,"mat-option",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit,a=A.oxw(2);A.Q6J("value",i),A.xp6(1),A.hij(" ",a.getTypeForView(i)," ")}}function Ue(e,t){1&e&&(A.TgZ(0,"mat-error"),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"DIALOGS.ADD_SERVICE_DESTINATION.REQUIRED_FIELD")," "))}function Je(e,t){1&e&&(A.TgZ(0,"mat-error"),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"DIALOGS.ADD_SERVICE_DESTINATION.INVALID_DESTINATION")," "))}function Qe(e,t){if(1&e&&(A.TgZ(0,"mat-form-field",22),A._UZ(1,"input",23),A.YNc(2,Ue,3,3,"mat-error",13),A.YNc(3,Je,3,3,"mat-error",13),A.qZA()),2&e){var i=A.oxw(2);A.xp6(1),A.s9C("placeholder",i.getTypeForView(i.selectedType)),A.Q6J("formControl",i.destinationControl),A.xp6(1),A.Q6J("ngIf","host"===i.selectedType&&!i.useFacilityHost&&i.destinationControl.hasError("required")),A.xp6(1),A.Q6J("ngIf",i.destinationControl.hasError("invalidDestination"))}}function ze(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-checkbox",24),A.NdJ("ngModelChange",function(e){return A.CHM(i),A.oxw(2).useFacilityHost=e}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw(2);A.Q6J("ngModel",a.useFacilityHost),A.xp6(1),A.hij(" ",A.lcZ(2,2,"DIALOGS.ADD_SERVICE_DESTINATION.USE_FACILITY_HOST")," ")}}function He(e,t){if(1&e&&(A.TgZ(0,"mat-option",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.Q6J("value",i),A.xp6(1),A.hij(" ",i," ")}}function Ve(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"div",7),A.TgZ(1,"div",8),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"mat-form-field"),A.TgZ(5,"mat-select",9),A.ALo(6,"translate"),A.YNc(7,we,3,3,"mat-option",10),A.YNc(8,Ye,3,3,"mat-option",11),A.YNc(9,Me,2,2,"mat-option",12),A.qZA(),A.YNc(10,Fe,3,3,"mat-error",13),A.qZA(),A.TgZ(11,"mat-checkbox",14),A.NdJ("change",function(){return A.CHM(i),A.oxw().getServices()})("ngModelChange",function(e){return A.CHM(i),A.oxw().servicesOnFacility=e}),A._uU(12),A.ALo(13,"translate"),A.qZA(),A.TgZ(14,"mat-form-field"),A.TgZ(15,"mat-select",15),A.NdJ("ngModelChange",function(e){return A.CHM(i),A.oxw().selectedType=e})("selectionChange",function(){return A.CHM(i),A.oxw().destinationControl.updateValueAndValidity()}),A.ALo(16,"translate"),A.YNc(17,qe,2,2,"mat-option",12),A.qZA(),A.qZA(),A.YNc(18,Qe,4,4,"mat-form-field",16),A.YNc(19,ze,3,4,"mat-checkbox",17),A.TgZ(20,"mat-form-field"),A.TgZ(21,"mat-select",18),A.NdJ("ngModelChange",function(e){return A.CHM(i),A.oxw().selectedPropagation=e}),A.ALo(22,"translate"),A.YNc(23,He,2,2,"mat-option",12),A.qZA(),A.qZA(),A.TgZ(24,"div",8),A._uU(25),A.ALo(26,"translate"),A.qZA(),A.qZA()}if(2&e){var a=A.oxw();A.xp6(2),A.Oqu(A.lcZ(3,18,"DIALOGS.ADD_SERVICE_DESTINATION.DESCRIPTION")),A.xp6(3),A.s9C("placeholder",A.lcZ(6,20,"DIALOGS.ADD_SERVICE_DESTINATION.SERVICE")),A.Q6J("formControl",a.serviceControl),A.xp6(2),A.Q6J("ngIf",0!==a.services.length),A.xp6(1),A.Q6J("ngIf",0===a.services.length),A.xp6(1),A.Q6J("ngForOf",a.services),A.xp6(1),A.Q6J("ngIf",null==a.serviceControl.value),A.xp6(1),A.Q6J("ngModel",a.servicesOnFacility),A.xp6(1),A.Oqu(A.lcZ(13,22,"DIALOGS.ADD_SERVICE_DESTINATION.IS_SERVICES_ONLY_ON_FACILITY")),A.xp6(3),A.s9C("placeholder",A.lcZ(16,24,"DIALOGS.ADD_SERVICE_DESTINATION.TYPE")),A.Q6J("ngModel",a.selectedType),A.xp6(2),A.Q6J("ngForOf",a.types),A.xp6(1),A.Q6J("ngIf",!("host"===a.selectedType&&a.useFacilityHost)),A.xp6(1),A.Q6J("ngIf","host"===a.selectedType),A.xp6(2),A.s9C("placeholder",A.lcZ(22,26,"DIALOGS.ADD_SERVICE_DESTINATION.PROPAGATION")),A.Q6J("ngModel",a.selectedPropagation),A.xp6(2),A.Q6J("ngForOf",a.propagations),A.xp6(2),A.hij(" ",A.lcZ(26,28,"DIALOGS.ADD_SERVICE_DESTINATION.PROPAGATION_TYPE_"+a.selectedPropagation)," ")}}var Be=function(){var e=function(){function e(t,i,a,n){s(this,e),this.dialogRef=t,this.data=i,this.facilitiesManager=a,this.servicesManager=n,this.services=[],this.types=["host","user@host","user@host:port","user@host-windows","host-windows-proxy","url","email","semail","service-specific"],this.selectedType="host",this.propagations=["PARALLEL","DUMMY"],this.selectedPropagation="PARALLEL",this.useFacilityHost=!1,this.loading=!1,this.emailRegex=new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/),this.hostPattern=new RegExp("^(?!:\\/\\/)(?=.{1,255}$)((.{1,63}\\.){1,127}(?![0-9]*$)[a-z0-9-]+\\.?)$|^(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)(\\.(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)){3}$"),this.urlPattern=new RegExp("^(https?|ftp|file)://[-a-zA-Z0-9+&@#/%?=~_|!:,.;()*$']*[-a-zA-Z0-9+&@#/%=~_|()*$']$"),this.userAtHostPattern=new RegExp("^[a-z_]([a-z0-9_-]{0,31}|[a-z0-9_-]{0,30}\\$)@(?:(?!:\\/\\/)(?=.{1,255}$)((.{1,63}\\.){1,127}(?![0-9]*$)[a-z0-9-]+\\.?)$|(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)(\\.(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)){3}$)"),this.userAtHostPortPattern=new RegExp("^[a-z_]([a-z0-9_-]{0,31}|[a-z0-9_-]{0,30}\\$)@(?:(?!:\\/\\/)(?=.{1,255}$)((.{1,63}\\.){1,127}(?![0-9]*$)[a-z0-9-]+\\.?)|(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)(\\.(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)){3}):[0-9]+"),this.serviceSpecificPattern=new RegExp("^(?!-)[a-zA-Z0-9-_.:/]*$")}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.serviceControl=new le.NI(void 0,le.kI.required),this.destinationControl=new le.NI("",this.getDestinationValidator()),this.emailControl=new le.NI("",[le.kI.required,le.kI.pattern(this.emailRegex)]),this.facilitiesManager.getHosts(this.data.facility.id).subscribe(function(t){e.hosts=t,e.servicesOnFacility=!0,e.getServices(),e.loading=!1},function(){return e.loading=!1})}},{key:"getDestinationValidator",value:function(){var e=this;return function(t){if(!t.value)return null;var i;switch(e.selectedType){case"host":case"host-windows-proxy":i=e.hostPattern;break;case"email":case"semail":i=e.emailRegex;break;case"url":i=e.urlPattern;break;case"user@host":case"user@host-windows":i=e.userAtHostPattern;break;case"user@host:port":i=e.userAtHostPortPattern;break;case"service-specific":i=e.serviceSpecificPattern;break;default:return null}return i.test(t.value)?null:{invalidDestination:{value:t.value}}}}},{key:"onCancel",value:function(){this.dialogRef.close()}},{key:"onSubmit",value:function(){var e=this;this.loading=!0,"all"===this.serviceControl.value?this.useFacilityHost?this.servicesManager.addDestinationsDefinedByHostsOnFacilityWithListOfServiceAndFacility({services:this.services,facility:this.data.facility.id}).subscribe(function(){e.dialogRef.close(!0)},function(){return e.loading=!1}):this.servicesManager.addDestinationToMultipleServices({services:this.services,facility:this.data.facility.id,destination:this.destinationControl.value,type:this.selectedType,propagationType:this.selectedPropagation}).subscribe(function(){e.dialogRef.close(!0)},function(){return e.loading=!1}):this.useFacilityHost?this.servicesManager.addDestinationsDefinedByHostsOnFacilityWithServiceAndFacility(this.serviceControl.value.id,this.data.facility.id).subscribe(function(){e.dialogRef.close(!0)},function(){return e.loading=!1}):this.servicesManager.addDestination(this.serviceControl.value.id,this.data.facility.id,this.destinationControl.value,this.selectedType,this.selectedPropagation).subscribe(function(){e.dialogRef.close(!0)},function(){return e.loading=!1})}},{key:"getServices",value:function(){var e=this;this.loading=!0,this.servicesOnFacility?this.servicesManager.getAssignedServices(this.data.facility.id).subscribe(function(t){e.services=t},function(){return e.loading=!1}):this.servicesManager.getServices().subscribe(function(t){e.services=t},function(){return e.loading=!1}),this.loading=!1,this.serviceControl.setValue(void 0)}},{key:"getTypeForView",value:function(e){return"semail"===e?"Send Mail":"service-specific"===e?"Service Specific":e}},{key:"invalidDestination",value:function(){return("host"!==this.selectedType||!this.useFacilityHost)&&this.destinationControl.invalid}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(v.so),A.Y36(v.WI),A.Y36(f.IQ),A.Y36(f.KK))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-perun-web-apps-add-services-destination-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","","class","dialog-container",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content","",1,"dialog-container"],[1,"font-italic"],["required","",3,"formControl","placeholder"],["value","all",4,"ngIf"],["value","noService",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"ngModel","change","ngModelChange"],[3,"ngModel","placeholder","ngModelChange","selectionChange"],["class","w-100",4,"ngIf"],[3,"ngModel","ngModelChange",4,"ngIf"],[3,"ngModel","placeholder","ngModelChange"],["value","all"],["value","noService"],[3,"value"],[1,"w-100"],["matInput","","required","",3,"formControl","placeholder"],[3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.YNc(4,Ne,1,0,"mat-spinner",1),A.YNc(5,Ve,27,30,"div",2),A.TgZ(6,"div",3),A.TgZ(7,"button",4),A.NdJ("click",function(){return t.onCancel()}),A._uU(8),A.ALo(9,"translate"),A.qZA(),A.TgZ(10,"button",5),A.NdJ("click",function(){return t.onSubmit()}),A._uU(11),A.ALo(12,"translate"),A.qZA(),A.qZA(),A.qZA()),2&e&&(A.Tol(t.data.theme),A.xp6(2),A.Oqu(A.lcZ(3,9,"DIALOGS.ADD_SERVICE_DESTINATION.TITLE")),A.xp6(2),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(3),A.hij(" ",A.lcZ(9,11,"DIALOGS.ADD_SERVICE_DESTINATION.CANCEL")," "),A.xp6(2),A.Q6J("disabled",t.loading||t.invalidDestination()||t.serviceControl.invalid||"noService"===t.serviceControl.value),A.xp6(1),A.hij(" ",A.lcZ(12,13,"DIALOGS.ADD_SERVICE_DESTINATION.ADD")," "))},directives:[v.uh,r.O5,v.H8,Z.lW,y.$g,v.xY,de.KE,Re.gD,le.Q7,le.JJ,le.oH,r.sg,ue.oG,le.On,pe.ey,de.TO,he.Nt,le.Fj],pipes:[_.X$],styles:[""],data:{animation:[d.BQ]}}),e}(),Pe=l(59403),Ge=l(19139),$e=l(94357);function je(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",8),A.NdJ("click",function(){return A.CHM(i),A.oxw().addDestination()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"FACILITY_DETAIL.SERVICES_DESTINATIONS.ADD")," "))}function Ke(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",9),A.NdJ("click",function(){return A.CHM(i),A.oxw().removeDestination()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selected.selected.length),A.xp6(1),A.hij(" ",A.lcZ(2,2,"FACILITY_DETAIL.SERVICES_DESTINATIONS.REMOVE")," ")}}function We(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",10),A.NdJ("click",function(){return A.CHM(i),A.oxw().onAllow()}),A.TgZ(1,"mat-icon"),A._uU(2," check_circle_outline "),A.qZA(),A._uU(3),A.ALo(4,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selected.selected.length||a.allSelectedAllowed()),A.xp6(3),A.hij(" ",A.lcZ(4,2,"FACILITY_DETAIL.SERVICES_DESTINATIONS.ALLOW")," ")}}function Xe(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",10),A.NdJ("click",function(){return A.CHM(i),A.oxw().onBlock()}),A.TgZ(1,"mat-icon"),A._uU(2," block "),A.qZA(),A._uU(3),A.ALo(4,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selected.selected.length||a.allSelectedBlocked()),A.xp6(3),A.hij(" ",A.lcZ(4,2,"FACILITY_DETAIL.SERVICES_DESTINATIONS.BLOCK")," ")}}function et(e,t){1&e&&A._UZ(0,"mat-spinner",11)}function tt(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"app-perun-web-apps-destination-list",12),A.NdJ("page",function(e){return A.CHM(i),A.oxw().pageChanged(e)}),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("pageSize",a.pageSize)("filterValue",a.filterValue)("destinations",a.destinations)("selection",a.selected)("displayedColumns",a.displayedColumns)}}var it=function(){var e=function(){function e(t,i,a,n,l,o,r,c,u){s(this,e),this.dialog=t,this.facilitiesManager=i,this.servicesManager=a,this.tableConfigService=n,this.translate=l,this.notificator=o,this.route=r,this.authResolver=c,this.serviceManager=u,this.selected=new Oe.Ov(!0,[]),this.displayedColumns=["select","destinationId","service","destination","type","propagationType"],this.filterValue="",this.tableId=xe.Cf}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.loading=!0,this.route.parent.params.subscribe(function(t){e.facilitiesManager.getFacilityById(t.facilityId).subscribe(function(t){e.facility=t,e.refreshTable()})})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.servicesManager.getAllRichDestinationsForFacility(this.facility.id).subscribe(function(t){e.destinations=t,e.selected.clear(),e.setAuthRights(),e.loading=!1})}},{key:"setAuthRights",value:function(){this.addAuth=this.authResolver.isAuthorized("addDestination_Service_Facility_Destination_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeDestination_Service_Facility_Destination_policy",[this.facility]),this.allowAuth=this.authResolver.isAuthorized("unblockServiceOnDestination_Service_int_policy",[this.facility]),this.blockAuth=this.authResolver.isAuthorized("blockServiceOnDestination_Service_int_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","destinationId","service","destination","type","status","propagationType"]:["destinationId","service","destination","type","status","propagationType"]}},{key:"addDestination",value:function(){var e=this,t=(0,p.kZ)();t.width="600px",t.data={facility:this.facility,theme:"facility-theme"},this.dialog.open(Be,t).afterClosed().subscribe(function(t){t&&e.translate.get("FACILITY_DETAIL.SERVICES_DESTINATIONS.ADD_SUCCESS").subscribe(function(t){e.refreshTable(),e.notificator.showSuccess(t)})})}},{key:"removeDestination",value:function(){var e=this,t=(0,p.kZ)();t.width="600px",t.data={destinations:this.selected.selected,theme:"facility-theme"},this.dialog.open(De.u,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}},{key:"blockServiceOnDestinations",value:function(e){var t=this;if(0===e.length)return this.notificator.showSuccess(this.translate.instant("FACILITY_DETAIL.SERVICES_DESTINATIONS.BLOCK_SUCCESS")),void this.refreshTable();var i=e.pop();this.serviceManager.blockServiceOnDestination(i.service.id,i.id).subscribe(function(){t.blockServiceOnDestinations(e)},function(){return t.loading=!1})}},{key:"onBlock",value:function(){this.loading=!0,this.blockServiceOnDestinations(this.selected.selected)}},{key:"allowServiceOnDestinations",value:function(e){var t=this;if(0===e.length)return this.notificator.showSuccess(this.translate.instant("FACILITY_DETAIL.SERVICES_DESTINATIONS.ALLOW_SUCCESS")),void this.refreshTable();var i=e.pop();this.serviceManager.unblockServiceOnDestinationById(i.service.id,i.id).subscribe(function(){t.allowServiceOnDestinations(e)},function(){return t.loading=!1})}},{key:"onAllow",value:function(){this.loading=!0,this.allowServiceOnDestinations(this.selected.selected)}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}},{key:"allSelectedAllowed",value:function(){return this.selected.selected.reduce(function(e,t){return e&&!t.blocked},!0)}},{key:"allSelectedBlocked",value:function(){return this.selected.selected.reduce(function(e,t){return e&&t.blocked},!0)}}]),e}();return e.id="FacilityServicesDestinationsComponent",e.\u0275fac=function(t){return new(t||e)(A.Y36(v.uw),A.Y36(f.IQ),A.Y36(f.KK),A.Y36(xe.dB),A.Y36(_.sK),A.Y36(g.V6),A.Y36(c.gz),A.Y36(g.x4),A.Y36(f.KK))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-perun-web-apps-facility-services-destinations"]],hostVars:2,hostBindings:function(e,t){2&e&&A.ekj("router-component",t.true)},decls:12,vars:10,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent","class","mr-2",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2",3,"disabled","click",4,"ngIf"],["mat-stroked-button","","class","mr-2",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","destinations","selection","displayedColumns","page",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2",3,"click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],["mat-stroked-button","",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","destinations","selection","displayedColumns","page"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"perun-web-apps-refresh-button",1),A.NdJ("refresh",function(){return t.refreshTable()}),A.qZA(),A.YNc(5,je,3,3,"button",2),A.YNc(6,Ke,3,4,"button",3),A.YNc(7,We,5,4,"button",4),A.YNc(8,Xe,5,4,"button",4),A.TgZ(9,"perun-web-apps-immediate-filter",5),A.NdJ("filter",function(e){return t.applyFilter(e)}),A.qZA(),A.YNc(10,et,1,0,"mat-spinner",6),A.YNc(11,tt,1,5,"app-perun-web-apps-destination-list",7),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,8,"FACILITY_DETAIL.SERVICES_DESTINATIONS.TITLE")),A.xp6(3),A.Q6J("ngIf",!t.loading&&t.addAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.removeAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.allowAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.blockAuth),A.xp6(1),A.Q6J("placeholder","FACILITY_DETAIL.SERVICES_DESTINATIONS.FILTER"),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[Pe.t,r.O5,Ge.L,Z.lW,b.Hw,y.$g,$e.q],pipes:[_.X$],styles:[""]}),e}(),at=l(17767);function nt(e,t){1&e&&A._UZ(0,"mat-spinner",3)}function st(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"div"),A.TgZ(1,"perun-web-apps-immediate-filter",4),A.NdJ("filter",function(e){return A.CHM(i),A.oxw().applyFilter(e)}),A.qZA(),A.TgZ(2,"div",5),A.TgZ(3,"perun-web-apps-owners-list",6),A.NdJ("page",function(e){return A.CHM(i),A.oxw().pageChanged(e)}),A.qZA(),A.qZA(),A.TgZ(4,"div",7),A.TgZ(5,"button",8),A.NdJ("click",function(){return A.CHM(i),A.oxw().onCancel()}),A._uU(6),A.ALo(7,"translate"),A.qZA(),A.TgZ(8,"button",9),A.NdJ("click",function(){return A.CHM(i),A.oxw().onAdd()}),A._uU(9),A.ALo(10,"translate"),A.qZA(),A.qZA(),A.qZA()}if(2&e){var a=A.oxw();A.xp6(1),A.Q6J("placeholder","DIALOGS.ADD_OWNERS.FILTER"),A.xp6(2),A.Q6J("filterValue",a.filterValue)("pageSize",a.pageSize)("owners",a.owners)("selection",a.selection),A.xp6(3),A.hij(" ",A.lcZ(7,8,"DIALOGS.ADD_OWNERS.CANCEL")," "),A.xp6(2),A.Q6J("disabled",0===a.selection.selected.length||a.loading),A.xp6(1),A.hij(" ",A.lcZ(10,10,"DIALOGS.ADD_OWNERS.ADD")," ")}}var lt=function(){var e=function(){function e(t,i,a,n,l,o,r){var c=this;s(this,e),this.dialogRef=t,this.data=i,this.notificator=a,this.tableConfigService=n,this.translate=l,this.ownersManagerService=o,this.facilitiesManagerService=r,this.extSources=[],this.selection=new Oe.Ov(!0,[]),this.filterValue="",this.tableId=xe.BV,this.owners=[],this.translate.get("DIALOGS.ADD_OWNERS.SUCCESS").subscribe(function(e){return c.successMessage=e})}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.theme=this.data.theme,this.loading=!0,this.ownersManagerService.getAllOwners().subscribe(function(t){e.owners=t.filter(function(t){return!e.data.forbiddenOwners.includes(t.id)}),e.loading=!1},function(){return e.loading=!1})}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"onAdd",value:function(){var e=this;this.loading=!0,0!==this.selection.selected.length?this.facilitiesManagerService.addFacilityOwner(this.data.facilityId,this.selection.selected.pop().id).subscribe(function(){return e.onAdd()},function(){return e.loading=!1}):(this.loading=!1,this.notificator.showSuccess(this.successMessage),this.dialogRef.close(!0))}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(v.so),A.Y36(v.WI),A.Y36(g.V6),A.Y36(xe.dB),A.Y36(_.sK),A.Y36(f.aC),A.Y36(f.IQ))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-add-facility-owner-dialog"]],decls:6,vars:8,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],[4,"ngIf"],[1,"mr-auto","ml-auto"],[1,"font-size-1rem",3,"placeholder","filter"],["mat-dialog-content",""],[3,"filterValue","pageSize","owners","selection","page"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","accent","mat-flat-button","",1,"ml-2",3,"disabled","click"]],template:function(e,t){1&e&&(A.TgZ(0,"h1",0),A._uU(1),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"div"),A.YNc(4,nt,1,0,"mat-spinner",1),A.YNc(5,st,11,12,"div",2),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,6,"DIALOGS.ADD_OWNERS.TITLE")),A.xp6(2),A.Tol(t.theme),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[v.uh,r.O5,y.$g,Ge.L,v.xY,at.Q,v.H8,Z.lW],pipes:[_.X$],styles:[""]}),e}(),ot=l(67033);function rt(e,t){1&e&&A._UZ(0,"mat-spinner",6)}function ct(e,t){1&e&&A._UZ(0,"th",15)}function ut(e,t){if(1&e&&(A.TgZ(0,"td",16),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.hij(" ",i.name," ")}}function dt(e,t){1&e&&A._UZ(0,"tr",17)}function ht(e,t){1&e&&A._UZ(0,"tr",18)}function ft(e,t){if(1&e&&(A.TgZ(0,"div",7),A.TgZ(1,"p"),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"div",8),A._uU(5),A.ALo(6,"translate"),A.qZA(),A.TgZ(7,"table",9),A.ynx(8,10),A.YNc(9,ct,1,0,"th",11),A.YNc(10,ut,2,1,"td",12),A.BQk(),A.YNc(11,dt,1,0,"tr",13),A.YNc(12,ht,1,0,"tr",14),A.qZA(),A.qZA()),2&e){var i=A.oxw();A.xp6(2),A.hij(" ",A.lcZ(3,5,"DIALOGS.REMOVE_OWNERS.DESCRIPTION")," "),A.xp6(3),A.hij(" ",A.lcZ(6,7,"DIALOGS.REMOVE_OWNERS.ASK")," "),A.xp6(2),A.Q6J("dataSource",i.dataSource),A.xp6(4),A.Q6J("matHeaderRowDef",i.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",i.displayedColumns)}}var pt=function(){var e=function(){function e(t,i,a,n,l){var o=this;s(this,e),this.dialogRef=t,this.data=i,this.notificator=a,this.translate=n,this.facilitiesManagerService=l,this.displayedColumns=["name"],n.get("DIALOGS.REMOVE_OWNERS.SUCCESS").subscribe(function(e){return o.successMessage=e})}return o(e,[{key:"ngOnInit",value:function(){this.dataSource=new ot.by(this.data.owners),this.theme=this.data.theme}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}},{key:"onSubmit",value:function(){var e=this;this.loading=!0,0!==this.data.owners.length?this.facilitiesManagerService.removeFacilityOwner(this.data.facilityId,this.data.owners.pop().id).subscribe(function(){return e.onSubmit()},function(){return e.loading=!1}):(this.loading=!1,this.notificator.showSuccess(this.successMessage),this.dialogRef.close(!0))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(v.so),A.Y36(v.WI),A.Y36(g.V6),A.Y36(_.sK),A.Y36(f.IQ))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-remove-facility-owner-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["color","warn","mat-flat-button","",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["class","font-weight-bolder","mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(A.TgZ(0,"h1",0),A._uU(1),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"div"),A.YNc(4,rt,1,0,"mat-spinner",1),A.YNc(5,ft,13,9,"div",2),A.TgZ(6,"div",3),A.TgZ(7,"button",4),A.NdJ("click",function(){return t.onCancel()}),A._uU(8),A.ALo(9,"translate"),A.qZA(),A.TgZ(10,"button",5),A.NdJ("click",function(){return t.onSubmit()}),A._uU(11),A.ALo(12,"translate"),A.qZA(),A.qZA(),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,9,"DIALOGS.REMOVE_OWNERS.TITLE")),A.xp6(2),A.Tol(t.theme),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(3),A.hij(" ",A.lcZ(9,11,"DIALOGS.REMOVE_OWNERS.CANCEL")," "),A.xp6(2),A.Q6J("disabled",t.loading),A.xp6(1),A.hij(" ",A.lcZ(12,13,"DIALOGS.REMOVE_OWNERS.DELETE")," "))},directives:[v.uh,r.O5,v.H8,Z.lW,y.$g,v.xY,ot.BZ,ot.w1,ot.fO,ot.Dz,ot.as,ot.nj,ot.ge,ot.ev,ot.XQ,ot.Gk],pipes:[_.X$],styles:[""]}),e}();function gt(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"perun-web-apps-refresh-button",7),A.NdJ("refresh",function(){return A.CHM(i),A.oxw().refreshTable()}),A.qZA()}}function mt(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",8),A.NdJ("click",function(){return A.CHM(i),A.oxw().onCreate()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"FACILITY_DETAIL.SETTINGS.OWNERS.ADD"),"\n"))}function St(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",9),A.NdJ("click",function(){return A.CHM(i),A.oxw().onRemove()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selection.selected.length),A.xp6(1),A.hij(" ",A.lcZ(2,2,"FACILITY_DETAIL.SETTINGS.OWNERS.DELETE"),"\n")}}function At(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"perun-web-apps-immediate-filter",10),A.NdJ("filter",function(e){return A.CHM(i),A.oxw().applyFilter(e)}),A.qZA()}2&e&&A.Q6J("placeholder","VO_MANAGEMENT.FILTER_PLACEHOLDER")}function vt(e,t){1&e&&A._UZ(0,"mat-spinner",11)}function Tt(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"perun-web-apps-owners-list",12),A.NdJ("page",function(e){return A.CHM(i),A.oxw().pageChanged(e)}),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("pageSize",a.pageSize)("filterValue",a.filterValue)("owners",a.owners)("displayedColumns",a.displayedColumns)("selection",a.selection)}}var It=function(){var e=function(){function e(t,i,a,n,l){s(this,e),this.facilitiesManagerService=t,this.tableConfigService=i,this.route=a,this.dialog=n,this.authResolver=l,this.owners=[],this.selection=new Oe.Ov(!0,[]),this.displayedColumns=["id","name","contact","type"],this.tableId=xe.zp}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.filterValue="",this.route.parent.parent.params.subscribe(function(t){e.facilityId=parseInt(t.facilityId,10),e.facility={id:e.facilityId,beanName:"Facility"},e.refreshTable()})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.selection.clear(),this.facilitiesManagerService.getFacilityOwners(this.facilityId).subscribe(function(t){e.owners=t,e.setAuthRights(),e.loading=!1})}},{key:"setAuthRights",value:function(){this.addAuth=this.authResolver.isAuthorized("addOwner_Facility_Owner_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeOwner_Facility_Owner_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","id","name","contact","type"]:["id","name","contact","type"]}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"onCreate",value:function(){var e=this,t=(0,p.kZ)();t.width="800px",t.data={theme:"facility-theme",facilityId:this.facilityId,forbiddenOwners:this.owners.map(function(e){return e.id})},this.dialog.open(lt,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}},{key:"onRemove",value:function(){var e=this,t=(0,p.kZ)();t.width="600px",t.data={theme:"facility-theme",owners:this.selection.selected,facilityId:this.facilityId},this.dialog.open(pt,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(f.IQ),A.Y36(xe.dB),A.Y36(c.gz),A.Y36(v.uw),A.Y36(g.x4))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-settings-owners"]],decls:9,vars:9,consts:[[1,"page-subtitle"],[3,"refresh",4,"ngIf"],["class","mr-2","color","accent","mat-flat-button","",3,"click",4,"ngIf"],["class","mr-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","owners","displayedColumns","selection","page",4,"ngIf"],[3,"refresh"],["color","accent","mat-flat-button","",1,"mr-2",3,"click"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[3,"placeholder","filter"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","owners","displayedColumns","selection","page"]],template:function(e,t){1&e&&(A.TgZ(0,"h1",0),A._uU(1),A.ALo(2,"translate"),A.qZA(),A.YNc(3,gt,1,0,"perun-web-apps-refresh-button",1),A.YNc(4,mt,3,3,"button",2),A.YNc(5,St,3,4,"button",3),A.YNc(6,At,1,1,"perun-web-apps-immediate-filter",4),A.YNc(7,vt,1,0,"mat-spinner",5),A.YNc(8,Tt,1,5,"perun-web-apps-owners-list",6)),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,7,"FACILITY_DETAIL.SETTINGS.OWNERS.TITLE")),A.xp6(2),A.Q6J("ngIf",!t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.addAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.removeAuth),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[r.O5,Pe.t,Z.lW,Ge.L,y.$g,at.Q],pipes:[_.X$],styles:[""]}),e}();function yt(e,t){1&e&&A._UZ(0,"mat-spinner",7)}function bt(e,t){1&e&&(A.TgZ(0,"mat-error"),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"DIALOGS.ADD_HOST.EMPTY_MESSAGE")," "))}function Et(e,t){if(1&e&&(A.TgZ(0,"mat-error"),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e){var i=A.oxw(2);A.xp6(1),A.AsE(" ",A.lcZ(2,2,"DIALOGS.ADD_HOST.INVALID_HOST"),"",i.hostsCtrl.getError("invalidHost").value," ")}}function Ct(e,t){if(1&e&&(A.TgZ(0,"div",8),A.TgZ(1,"mat-form-field"),A.TgZ(2,"textarea",9),A._uU(3,"      "),A.qZA(),A.YNc(4,bt,3,3,"mat-error",10),A.YNc(5,Et,3,4,"mat-error",10),A.qZA(),A.TgZ(6,"div",11),A._uU(7),A.ALo(8,"translate"),A.qZA(),A.qZA()),2&e){var i=A.oxw();A.xp6(2),A.Q6J("formControl",i.hostsCtrl),A.xp6(2),A.Q6J("ngIf",i.hostsCtrl.hasError("required")),A.xp6(1),A.Q6J("ngIf",i.hostsCtrl.hasError("invalidHost")),A.xp6(2),A.Oqu(A.lcZ(8,4,"DIALOGS.ADD_HOST.HINT"))}}var Zt=function(){var e=function(){function e(t,i,a,n,l){s(this,e),this.dialogRef=t,this.data=i,this.facilitiesManager=a,this.notificator=n,this.translate=l,this.loading=!1,this.hostPattern=new RegExp("^(?!:\\/\\/)(?=.{1,255}$)((.{1,63}\\.){1,127}(?![0-9]*$)[a-z0-9-]+\\.?)$|^(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)(\\.(25[0-5]|2[0-4]\\d|[0-1]?\\d?\\d)){3}$")}return o(e,[{key:"ngOnInit",value:function(){this.theme=this.data.theme,this.facilityName=this.data.facilityName,this.hostsCtrl=new le.NI("",[le.kI.required,this.hostsNameValidator()]),this.hostsCtrl.markAllAsTouched()}},{key:"onAdd",value:function(){var e=this;this.loading=!0;var t,a=[],n=i(this.hostsCtrl.value.split("\n"));try{for(n.s();!(t=n.n()).done;){var s=t.value;a=a.concat(this.parseHostName(s))}}catch(l){n.e(l)}finally{n.f()}this.facilitiesManager.addHosts(this.data.facilityId,a).subscribe(function(){e.notificator.showSuccess(e.translate.instant("DIALOGS.ADD_HOST.SUCCESS")),e.dialogRef.close(!0)},function(){return e.loading=!1})}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}},{key:"hostsNameValidator",value:function(){var e=this;return function(t){var a,n=[],s=t.value.split("\n"),l=i(s);try{for(l.s();!(a=l.n()).done;){var o=a.value;n=n.concat(e.parseHostName(o))}}catch(d){l.e(d)}finally{l.f()}console.log(s);var r,c=i(n);try{for(c.s();!(r=c.n()).done;){var u=r.value;if(!e.hostPattern.test(u))return{invalidHost:{value:u}}}}catch(d){c.e(d)}finally{c.f()}return null}}},{key:"parseHostName",value:function(e){var i=new RegExp("[[0-9]+-[0-9]+]","g"),a=e.split(i),n=e.match(i);if(null==n)return""===e?[]:[e];for(var s=[],l=0;l<a.length-1;l++){for(var o=t(this.parseRange(n[l]),2),r=o[0],c=o[1],u=[],d=r;d<=c;d++)u=u.concat(a[l].concat(d.toString()));s=s.concat([u])}return s=s.concat([a[a.length-1]]),this.joinHostNames(s,0)}},{key:"parseRange",value:function(e){var i=t(e.split("-"),2),a=i[0],n=i[1];return[parseInt(a.substring(1,a.length),10),parseInt(n.substring(0,n.length),10)]}},{key:"joinHostNames",value:function(e,t){if(t===e.length-1)return[e[t]];var a,n=this.joinHostNames(e,t+1),s=[],l=i(e[t]);try{for(l.s();!(a=l.n()).done;){var o,r=a.value,c=i(n);try{for(c.s();!(o=c.n()).done;){var u=o.value;s.push(r.concat(u))}}catch(d){c.e(d)}finally{c.f()}}}catch(d){l.e(d)}finally{l.f()}return s}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(v.so),A.Y36(v.WI),A.Y36(f.IQ),A.Y36(g.V6),A.Y36(_.sK))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-add-host-dialog"]],decls:16,vars:19,consts:[["mat-dialog-title",""],[1,"page-subtitle"],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-content","","class","dialog-container",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","accent",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content","",1,"dialog-container"],["id","facilityAddHost","name","facilityAddHost","rows","8","cols","50","matInput","","required","",1,"md-textarea","form-control",3,"formControl"],[4,"ngIf"],[1,"text-muted"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"h1",1),A._uU(5),A.ALo(6,"translate"),A.qZA(),A.YNc(7,yt,1,0,"mat-spinner",2),A.YNc(8,Ct,9,6,"div",3),A.TgZ(9,"div",4),A.TgZ(10,"button",5),A.NdJ("click",function(){return t.onCancel()}),A._uU(11),A.ALo(12,"translate"),A.qZA(),A.TgZ(13,"button",6),A.NdJ("click",function(){return t.onAdd()}),A._uU(14),A.ALo(15,"translate"),A.qZA(),A.qZA(),A.qZA()),2&e&&(A.Tol(t.theme),A.xp6(2),A.AsE("",t.facilityName,": ",A.lcZ(3,11,"DIALOGS.ADD_HOST.TITLE"),""),A.xp6(3),A.hij("",A.lcZ(6,13,"DIALOGS.ADD_HOST.SUBTITLE"),":"),A.xp6(2),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(3),A.hij(" ",A.lcZ(12,15,"DIALOGS.ADD_HOST.CANCEL"),""),A.xp6(2),A.Q6J("disabled",t.hostsCtrl.invalid||t.loading),A.xp6(1),A.hij(" ",A.lcZ(15,17,"DIALOGS.ADD_HOST.ADD"),""))},directives:[v.uh,r.O5,v.H8,Z.lW,y.$g,v.xY,de.KE,he.Nt,le.Fj,le.Q7,le.JJ,le.oH,de.TO],pipes:[_.X$],styles:[""]}),e}();function _t(e,t){1&e&&A._UZ(0,"mat-spinner",6)}function kt(e,t){1&e&&A._UZ(0,"th",15)}function Lt(e,t){if(1&e&&(A.TgZ(0,"td",16),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.hij(" ",i.hostname," ")}}function xt(e,t){1&e&&A._UZ(0,"tr",17)}function Ot(e,t){1&e&&A._UZ(0,"tr",18)}function Dt(e,t){if(1&e&&(A.TgZ(0,"div",7),A.TgZ(1,"p"),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"div",8),A._uU(5),A.ALo(6,"translate"),A.qZA(),A.TgZ(7,"table",9),A.ynx(8,10),A.YNc(9,kt,1,0,"th",11),A.YNc(10,Lt,2,1,"td",12),A.BQk(),A.YNc(11,xt,1,0,"tr",13),A.YNc(12,Ot,1,0,"tr",14),A.qZA(),A.qZA()),2&e){var i=A.oxw();A.xp6(2),A.Oqu(A.lcZ(3,5,"DIALOGS.REMOVE_HOST.DESCRIPTION")),A.xp6(3),A.hij(" ",A.lcZ(6,7,"DIALOGS.REMOVE_HOST.ASK")," "),A.xp6(2),A.Q6J("dataSource",i.dataSource),A.xp6(4),A.Q6J("matHeaderRowDef",i.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",i.displayedColumns)}}var Rt=function(){var e=function(){function e(t,i,a,n,l){s(this,e),this.dialogRef=t,this.data=i,this.facilitiesManager=a,this.notificator=n,this.translate=l,this.displayedColumns=["name"],this.loading=!1}return o(e,[{key:"ngOnInit",value:function(){this.theme=this.data.theme,this.hosts=this.data.hosts,this.dataSource=new ot.by(this.data.hosts)}},{key:"onConfirm",value:function(){var e=this;this.loading=!0,this.facilitiesManager.removeHosts(this.data.facilityId,this.hosts.map(function(e){return e.id})).subscribe(function(){e.notificator.showSuccess(e.translate.instant("DIALOGS.REMOVE_HOST.SUCCESS")),e.dialogRef.close(!0)},function(){return e.loading=!1})}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(v.so),A.Y36(v.WI),A.Y36(f.IQ),A.Y36(g.V6),A.Y36(_.sK))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-remove-host-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","mr-auto ml-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"mr-auto","ml-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(A.TgZ(0,"h1",0),A._uU(1),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"div"),A.YNc(4,_t,1,0,"mat-spinner",1),A.YNc(5,Dt,13,9,"div",2),A.TgZ(6,"div",3),A.TgZ(7,"button",4),A.NdJ("click",function(){return t.onCancel()}),A._uU(8),A.ALo(9,"translate"),A.qZA(),A.TgZ(10,"button",5),A.NdJ("click",function(){return t.onConfirm()}),A._uU(11),A.ALo(12,"translate"),A.qZA(),A.qZA(),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,9,"DIALOGS.REMOVE_HOST.TITLE")),A.xp6(2),A.Tol(t.theme),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(3),A.hij(" ",A.lcZ(9,11,"DIALOGS.REMOVE_HOST.CANCEL"),""),A.xp6(2),A.Q6J("disabled",t.loading),A.xp6(1),A.hij(" ",A.lcZ(12,13,"DIALOGS.REMOVE_HOST.CONFIRM"),""))},directives:[v.uh,r.O5,v.H8,Z.lW,y.$g,v.xY,ot.BZ,ot.w1,ot.fO,ot.Dz,ot.as,ot.nj,ot.ge,ot.ev,ot.XQ,ot.Gk],pipes:[_.X$],styles:[""]}),e}(),Nt=l(58623),wt=l(82819),Yt=l(84534),Mt=l(39571);function Ft(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"th",13),A.TgZ(1,"mat-checkbox",14),A.NdJ("change",function(e){A.CHM(i);var t=A.oxw();return e?t.masterToggle():null}),A.qZA(),A.qZA()}if(2&e){var a=A.oxw();A.xp6(1),A.Q6J("aria-label",a.checkboxLabel())("checked",a.selection.hasValue()&&a.isAllSelected())("indeterminate",a.selection.hasValue()&&!a.isAllSelected())}}function qt(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"td",15),A.TgZ(1,"mat-checkbox",16),A.NdJ("change",function(e){var t=A.CHM(i).$implicit,a=A.oxw();return e?a.selection.toggle(t):null})("click",function(e){return e.stopPropagation()}),A.qZA(),A.qZA()}if(2&e){var a=t.$implicit,n=A.oxw();A.xp6(1),A.Q6J("aria-label",n.checkboxLabel(a))("checked",n.selection.isSelected(a))}}function Ut(e,t){1&e&&(A.TgZ(0,"th",17),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.HOSTS_LIST.TABLE_HOST_ID")))}function Jt(e,t){if(1&e&&(A.TgZ(0,"td",15),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.id)}}function Qt(e,t){1&e&&(A.TgZ(0,"th",17),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.HOSTS_LIST.TABLE_HOST_NAME")))}function zt(e,t){if(1&e&&(A.TgZ(0,"td",18),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.hostname)}}function Ht(e,t){1&e&&A._UZ(0,"tr",19)}var Vt=function(e,t){return["/facilities",e,"hosts",t]};function Bt(e,t){if(1&e&&A._UZ(0,"tr",20),2&e){var i=t.$implicit,a=A.oxw();A.Q6J("perunWebAppsMiddleClickRouterLink",a.disableRouting?null:A.WLB(2,Vt,a.facilityId,i.id))("routerLink",a.disableRouting?null:A.WLB(5,Vt,a.facilityId,i.id))}}function Pt(e,t){1&e&&(A.TgZ(0,"app-alert",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}function Gt(e,t){1&e&&(A.TgZ(0,"app-alert",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED.COMPONENTS.HOSTS_LIST.NO_HOST_WARNING"),"\n"))}var $t=function(){var e=function(){function e(t,i){s(this,e),this.authResolver=t,this.tableCheckbox=i,this.hosts=[],this.selection=new Oe.Ov(!0,[]),this.pageSize=10,this.disableRouting=!1,this.displayedColumns=["select","id","name"],this.page=new A.vpe,this.pageSizeOptions=p.f7}return o(e,[{key:"matSort",set:function(e){this.sort=e,this.setDataSource()}},{key:"ngOnChanges",value:function(e){this.authResolver.isPerunAdmin()||(this.displayedColumns=this.displayedColumns.filter(function(e){return"id"!==e})),this.dataSource=new ot.by(this.hosts),this.setDataSource(),this.dataSource.filter=this.filterValue}},{key:"getDataForColumn",value:function(e,t){switch(t){case"id":return e.id.toString();case"name":return e.hostname;default:return""}}},{key:"exportData",value:function(e){(0,p.O6)((0,p.Xn)(this.dataSource.filteredData,this.displayedColumns,this.getDataForColumn,this),e)}},{key:"setDataSource",value:function(){var e=this;this.dataSource&&(this.dataSource.sort=this.sort,this.dataSource.filterPredicate=function(t,i){return(0,p.Sd)(t,i,e.displayedColumns,e.getDataForColumn,e)},this.dataSource.sortData=function(t,i){return(0,p.pR)(t,i,e.getDataForColumn,e)},this.dataSource.paginator=this.child.paginator)}},{key:"isAllSelected",value:function(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}},{key:"masterToggle",value:function(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.pageSize,this.child.paginator.pageIndex,!1)}},{key:"checkboxLabel",value:function(e){return e?"".concat(this.selection.isSelected(e)?"deselect":"select"," row ").concat(e.id+1):(this.isAllSelected()?"select":"deselect")+" all"}},{key:"ngAfterViewInit",value:function(){this.dataSource.paginator=this.child.paginator}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(g.x4),A.Y36(g.UA))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-hosts-list"]],viewQuery:function(e,t){var i;(1&e&&(A.Gf(Nt.YE,7),A.Gf(p.l9,7)),2&e)&&(A.iGM(i=A.CRH())&&(t.matSort=i.first),A.iGM(i=A.CRH())&&(t.child=i.first))},inputs:{hosts:"hosts",selection:"selection",filterValue:"filterValue",pageSize:"pageSize",facilityId:"facilityId",disableRouting:"disableRouting",displayedColumns:"displayedColumns"},outputs:{page:"page"},features:[A.TTD],decls:16,vars:9,consts:[[1,"card","mt-3",3,"hidden"],[3,"dataLength","pageSizeOptions","pageSize","exportData","page"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","name"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",3,"perunWebAppsMiddleClickRouterLink","routerLink",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item",3,"perunWebAppsMiddleClickRouterLink","routerLink"],["alert_type","warn"]],template:function(e,t){1&e&&(A.TgZ(0,"div",0),A.TgZ(1,"perun-web-apps-table-wrapper",1),A.NdJ("exportData",function(e){return t.exportData(e)})("page",function(e){return t.page.emit(e)}),A.TgZ(2,"table",2),A.ynx(3,3),A.YNc(4,Ft,2,3,"th",4),A.YNc(5,qt,2,2,"td",5),A.BQk(),A.ynx(6,6),A.YNc(7,Ut,3,3,"th",7),A.YNc(8,Jt,2,1,"td",5),A.BQk(),A.ynx(9,8),A.YNc(10,Qt,3,3,"th",7),A.YNc(11,zt,2,1,"td",9),A.BQk(),A.YNc(12,Ht,1,0,"tr",10),A.YNc(13,Bt,1,8,"tr",11),A.qZA(),A.qZA(),A.qZA(),A.YNc(14,Pt,3,3,"app-alert",12),A.YNc(15,Gt,3,3,"app-alert",12)),2&e&&(A.Q6J("hidden",0===t.dataSource.filteredData.length||0===t.hosts.length),A.xp6(1),A.Q6J("dataLength",t.dataSource.filteredData.length)("pageSizeOptions",t.pageSizeOptions)("pageSize",t.pageSize),A.xp6(1),A.Q6J("dataSource",t.dataSource),A.xp6(10),A.Q6J("matHeaderRowDef",t.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",t.displayedColumns),A.xp6(1),A.Q6J("ngIf",0===t.dataSource.filteredData.length&&0!==t.hosts.length),A.xp6(1),A.Q6J("ngIf",0===t.hosts.length))},directives:[wt.l,ot.BZ,Nt.YE,ot.w1,ot.fO,ot.Dz,ot.as,ot.nj,r.O5,ot.ge,ue.oG,ot.ev,Nt.nU,ot.XQ,ot.Gk,Yt.YH,c.rH,Mt.w],pipes:[_.X$],styles:[".disable-outline[_ngcontent-%COMP%]{outline:none!important}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}"]}),e}();function jt(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",7),A.NdJ("click",function(){return A.CHM(i),A.oxw().addHost()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"FACILITY_DETAIL.HOSTS.ADD")," "))}function Kt(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",8),A.NdJ("click",function(){return A.CHM(i),A.oxw().removeHost()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selected.selected.length),A.xp6(1),A.hij(" ",A.lcZ(2,2,"FACILITY_DETAIL.HOSTS.REMOVE")," ")}}function Wt(e,t){1&e&&A._UZ(0,"mat-spinner",9)}function Xt(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"app-hosts-list",10),A.NdJ("page",function(e){return A.CHM(i),A.oxw().pageChanged(e)}),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("pageSize",a.pageSize)("filterValue",a.filterValue)("hosts",a.hosts)("selection",a.selected)("displayedColumns",a.displayedColumns)("disableRouting",!a.routeAuth)("facilityId",a.facilityId)}}var ei=function(){var e=function(){function e(t,i,a,n,l){s(this,e),this.dialog=t,this.facilitiesManager=i,this.tableConfigService=a,this.route=n,this.authResolver=l,this.hosts=[],this.selected=new Oe.Ov(!0,[]),this.filterValue="",this.tableId=xe.eq,this.displayedColumns=["id","name"]}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe(function(t){e.facilityId=t.facilityId,e.facilitiesManager.getFacilityById(e.facilityId).subscribe(function(t){e.facility=t,e.refreshTable()})})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.facilitiesManager.getHosts(this.facilityId).subscribe(function(t){e.hosts=t,e.selected.clear(),e.setAuthRights(),e.loading=!1})}},{key:"setAuthRights",value:function(){this.addAuth=this.authResolver.isAuthorized("addHosts_Facility_List<String>_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeHosts_List<Host>_Facility_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","id","name"]:["id","name"],0!==this.hosts.length&&(this.routeAuth=this.authResolver.isAuthorized("getHostById_int_policy",[this.facility,this.hosts[0]]))}},{key:"addHost",value:function(){var e=this,t=(0,p.kZ)();t.width="600px",t.data={facilityId:this.facility.id,facilityName:this.facility.name,theme:"facility-theme"},this.dialog.open(Zt,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}},{key:"removeHost",value:function(){var e=this,t=(0,p.kZ)();t.width="600px",t.data={facilityId:this.facility.id,theme:"facility-theme",hosts:this.selected.selected},this.dialog.open(Rt,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(v.uw),A.Y36(f.IQ),A.Y36(xe.dB),A.Y36(c.gz),A.Y36(g.x4))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-hosts"]],decls:10,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent","class","mr-2",3,"click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","hosts","selection","displayedColumns","disableRouting","facilityId","page",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2",3,"click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","hosts","selection","displayedColumns","disableRouting","facilityId","page"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"perun-web-apps-refresh-button",1),A.NdJ("refresh",function(){return t.refreshTable()}),A.qZA(),A.YNc(5,jt,3,3,"button",2),A.YNc(6,Kt,3,4,"button",3),A.TgZ(7,"perun-web-apps-immediate-filter",4),A.NdJ("filter",function(e){return t.applyFilter(e)}),A.qZA(),A.YNc(8,Wt,1,0,"mat-spinner",5),A.YNc(9,Xt,1,7,"app-hosts-list",6),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,6,"FACILITY_DETAIL.HOSTS.TITLE")),A.xp6(3),A.Q6J("ngIf",!t.loading&&t.addAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.removeAuth),A.xp6(1),A.Q6J("placeholder","FACILITY_DETAIL.HOSTS.FILTER"),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[Pe.t,r.O5,Ge.L,Z.lW,y.$g,$t],pipes:[_.X$],styles:[""]}),e}();function ti(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"th",14),A.TgZ(1,"mat-checkbox",15),A.NdJ("change",function(e){A.CHM(i);var t=A.oxw();return e?t.masterToggle():null}),A.qZA(),A.qZA()}if(2&e){var a=A.oxw();A.xp6(1),A.Q6J("aria-label",a.checkboxLabel())("checked",a.selection.hasValue()&&a.isAllSelected())("indeterminate",a.selection.hasValue()&&!a.isAllSelected())}}function ii(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"td",16),A.TgZ(1,"mat-checkbox",17),A.NdJ("change",function(e){var t=A.CHM(i).$implicit,a=A.oxw();return e?a.selection.toggle(t):null})("click",function(e){return e.stopPropagation()}),A.qZA(),A.qZA()}if(2&e){var a=t.$implicit,n=A.oxw();A.xp6(1),A.Q6J("aria-label",n.checkboxLabel(a))("checked",n.selection.isSelected(a))}}function ai(e,t){1&e&&(A.TgZ(0,"th",18),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.BLACKLIST_LIST.USER_ID")))}function ni(e,t){if(1&e&&(A.TgZ(0,"td",16),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i[1].id)}}function si(e,t){1&e&&(A.TgZ(0,"th",18),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.BLACKLIST_LIST.NAME")))}function li(e,t){if(1&e&&(A.TgZ(0,"td",19),A._uU(1),A.ALo(2,"userFullName"),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(A.lcZ(2,1,i[1]))}}function oi(e,t){1&e&&(A.TgZ(0,"th",18),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.BLACKLIST_LIST.REASON")))}function ri(e,t){if(1&e&&(A.TgZ(0,"td",19),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i[0].description)}}function ci(e,t){1&e&&A._UZ(0,"tr",20)}function ui(e,t){1&e&&A._UZ(0,"tr",21)}function di(e,t){1&e&&(A.TgZ(0,"app-alert",22),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}function hi(e,t){1&e&&(A.TgZ(0,"app-alert",22),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED.COMPONENTS.BLACKLIST_LIST.NO_BANS_WARNING"),"\n"))}var fi=function(){var e=function(){function e(t,i){s(this,e),this.authResolver=t,this.tableCheckbox=i,this.bansOnFacilitiesWithUsers=[],this.selection=new Oe.Ov(!0,[]),this.pageSize=10,this.page=new A.vpe,this.displayedColumns=["select","userId","name","reason"],this.pageSizeOptions=p.f7}return o(e,[{key:"matSort",set:function(e){this.sort=e,this.setDataSource()}},{key:"ngOnChanges",value:function(e){this.authResolver.isPerunAdmin()||(this.displayedColumns=this.displayedColumns.filter(function(e){return"userId"!==e})),this.dataSource=new ot.by(this.bansOnFacilitiesWithUsers),this.setDataSource(),this.dataSource.filter=this.filterValue}},{key:"getDataForColumn",value:function(e,t){switch(t){case"userId":return e[1].id.toString();case"reason":return e[0].description;case"name":return(0,p.hu)(e[1]);default:return""}}},{key:"exportData",value:function(e){(0,p.O6)((0,p.Xn)(this.dataSource.filteredData,this.displayedColumns,this.getDataForColumn,this),e)}},{key:"setDataSource",value:function(){var e=this;this.dataSource&&(this.dataSource.filterPredicate=function(t,i){return(0,p.Sd)(t,i,e.displayedColumns,e.getDataForColumn,e)},this.dataSource.sortData=function(t,i){return(0,p.pR)(t,i,e.getDataForColumn,e)},this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator)}},{key:"isAllSelected",value:function(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}},{key:"masterToggle",value:function(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.pageSize,this.child.paginator.pageIndex,!1)}},{key:"checkboxLabel",value:function(e){return e?"".concat(this.selection.isSelected(e)?"deselect":"select"," row ").concat(e[0].userId+1):(this.isAllSelected()?"select":"deselect")+" all"}},{key:"ngAfterViewInit",value:function(){this.dataSource.paginator=this.child.paginator}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(g.x4),A.Y36(g.UA))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-perun-web-apps-blacklist-list"]],viewQuery:function(e,t){var i;(1&e&&(A.Gf(Nt.YE,7),A.Gf(p.l9,7)),2&e)&&(A.iGM(i=A.CRH())&&(t.matSort=i.first),A.iGM(i=A.CRH())&&(t.child=i.first))},inputs:{bansOnFacilitiesWithUsers:"bansOnFacilitiesWithUsers",selection:"selection",filterValue:"filterValue",pageSize:"pageSize"},outputs:{page:"page"},features:[A.TTD],decls:19,vars:9,consts:[[1,"card","mt-3",3,"hidden"],[3,"dataLength","pageSizeOptions","pageSize","exportData","page"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","userId"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","name"],["mat-cell","",4,"matCellDef"],["matColumnDef","reason"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"],["alert_type","warn"]],template:function(e,t){1&e&&(A.TgZ(0,"div",0),A.TgZ(1,"perun-web-apps-table-wrapper",1),A.NdJ("exportData",function(e){return t.exportData(e)})("page",function(e){return t.page.emit(e)}),A.TgZ(2,"table",2),A.ynx(3,3),A.YNc(4,ti,2,3,"th",4),A.YNc(5,ii,2,2,"td",5),A.BQk(),A.ynx(6,6),A.YNc(7,ai,3,3,"th",7),A.YNc(8,ni,2,1,"td",5),A.BQk(),A.ynx(9,8),A.YNc(10,si,3,3,"th",7),A.YNc(11,li,3,3,"td",9),A.BQk(),A.ynx(12,10),A.YNc(13,oi,3,3,"th",7),A.YNc(14,ri,2,1,"td",9),A.BQk(),A.YNc(15,ci,1,0,"tr",11),A.YNc(16,ui,1,0,"tr",12),A.qZA(),A.qZA(),A.qZA(),A.YNc(17,di,3,3,"app-alert",13),A.YNc(18,hi,3,3,"app-alert",13)),2&e&&(A.Q6J("hidden",0===t.dataSource.filteredData.length||0===t.bansOnFacilitiesWithUsers.length),A.xp6(1),A.Q6J("dataLength",t.dataSource.filteredData.length)("pageSizeOptions",t.pageSizeOptions)("pageSize",t.pageSize),A.xp6(1),A.Q6J("dataSource",t.dataSource),A.xp6(13),A.Q6J("matHeaderRowDef",t.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",t.displayedColumns),A.xp6(1),A.Q6J("ngIf",0===t.dataSource.filteredData.length&&0!==t.bansOnFacilitiesWithUsers.length),A.xp6(1),A.Q6J("ngIf",0===t.bansOnFacilitiesWithUsers.length))},directives:[wt.l,ot.BZ,Nt.YE,ot.w1,ot.fO,ot.Dz,ot.as,ot.nj,r.O5,ot.ge,ue.oG,ot.ev,Nt.nU,ot.XQ,ot.Gk,Mt.w],pipes:[_.X$,ge.d],styles:[""]}),e}();function pi(e,t){1&e&&A._UZ(0,"mat-spinner",5)}function gi(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"app-perun-web-apps-blacklist-list",6),A.NdJ("page",function(e){return A.CHM(i),A.oxw().pageChanged(e)}),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("pageSize",a.pageSize)("filterValue",a.filterValue)("bansOnFacilitiesWithUsers",a.bansOnFacilitiesWithUsers)("selection",a.selected)}}var mi=function(){var e=function(){function e(t,i,a,n){s(this,e),this.facilitiesManager=t,this.usersManager=i,this.tableConfigService=a,this.route=n,this.bansOnFacilitiesWithUsers=[],this.selected=new Oe.Ov(!0,[]),this.filterValue="",this.tableId=xe.NG}return o(e,[{key:"ngOnInit",value:function(){this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.refreshTable()}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.route.parent.parent.params.subscribe(function(t){e.facilitiesManager.getBansForFacility(t.facilityId).subscribe(function(t){var a,n=i(t);try{for(n.s();!(a=n.n()).done;){var s=a.value,l=void 0;e.usersManager.getUserById(s.userId).subscribe(function(e){l=e}),e.bansOnFacilitiesWithUsers.push([s,l])}}catch(o){n.e(o)}finally{n.f()}e.selected.clear(),e.loading=!1})})}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(f.IQ),A.Y36(f.Fv),A.Y36(xe.dB),A.Y36(c.gz))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-perun-web-apps-facility-settings-blacklist"]],decls:9,vars:8,consts:[[1,"page-subtitle"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","bansOnFacilitiesWithUsers","selection","page",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","bansOnFacilitiesWithUsers","selection","page"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"perun-web-apps-refresh-button",1),A.NdJ("refresh",function(){return t.refreshTable()}),A.qZA(),A.TgZ(5,"perun-web-apps-immediate-filter",2),A.NdJ("filter",function(e){return t.applyFilter(e)}),A.ALo(6,"translate"),A.qZA(),A.YNc(7,pi,1,0,"mat-spinner",3),A.YNc(8,gi,1,4,"app-perun-web-apps-blacklist-list",4),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,4,"FACILITY_DETAIL.SETTINGS.BLACKLIST.TITLE")),A.xp6(3),A.Q6J("placeholder",A.lcZ(6,6,"FACILITY_DETAIL.SETTINGS.BLACKLIST.FILTER")),A.xp6(2),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[Pe.t,Ge.L,r.O5,y.$g,fi],pipes:[_.X$],styles:[""]}),e}(),Si=l(41939),Ai=l(13572),vi=l(40695),Ti=l(41186),Ii=["list"];function yi(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"perun-web-apps-attributes-list",6,7),A.NdJ("page",function(e){return A.CHM(i),A.oxw().pageChanged(e)}),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("pageSize",a.pageSize)("attributes",a.attributes)("selection",a.selected)}}var bi=function(){var e=function(){function e(t,i,a,n,l){s(this,e),this.dialog=t,this.attributesManager=i,this.facilityManager=a,this.tableConfigService=n,this.route=l,this.attributes=[],this.selected=new Oe.Ov(!0,[]),this.host={beanName:"",id:0},this.tableId=xe.rF}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.params.subscribe(function(t){e.hostId=t.hostId,e.facilityManager.getHostById(e.hostId).subscribe(function(t){e.host=t}),e.refreshTable()})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.attributesManager.getHostAttributes(this.hostId).subscribe(function(t){e.attributes=(0,p.MX)(t),e.selected.clear(),e.loading=!1})}},{key:"onSave",value:function(){var e=this;this.list.updateMapAttributes();var t=(0,p.kZ)();t.width="450px",t.data={entityId:this.hostId,entity:"host",attributes:this.selected.selected},this.dialog.open(m.wA,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}},{key:"addAttribute",value:function(){var e=this,t=(0,p.kZ)();t.width="1050px",t.data={entityId:this.hostId,entity:"host",notEmptyAttributes:this.attributes,style:"facility-theme"},this.dialog.open(vi.n,t).afterClosed().subscribe(function(t){"saved"===t&&e.refreshTable()})}},{key:"removeAttribute",value:function(){var e=this,t=(0,p.kZ)();t.width="450px",t.data={entityId:this.hostId,entity:"host",attributes:this.selected.selected,theme:"facility-theme"},this.dialog.open(Ai.k,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(v.uw),A.Y36(f.H8),A.Y36(f.IQ),A.Y36(xe.dB),A.Y36(c.gz))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-hosts-detail"]],viewQuery:function(e,t){var i;(1&e&&A.Gf(Ii,5),2&e)&&(A.iGM(i=A.CRH())&&(t.list=i.first))},decls:15,vars:16,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent",1,"mr-2",3,"click"],["mat-flat-button","","color","accent",1,"mr-2",3,"disabled","click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[3,"pageSize","attributes","selection","page",4,"ngIf"],[3,"pageSize","attributes","selection","page"],["list",""]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"perun-web-apps-refresh-button",1),A.NdJ("refresh",function(){return t.refreshTable()}),A.qZA(),A.TgZ(5,"button",2),A.NdJ("click",function(){return t.addAttribute()}),A._uU(6),A.ALo(7,"translate"),A.qZA(),A.TgZ(8,"button",3),A.NdJ("click",function(){return t.onSave()}),A._uU(9),A.ALo(10,"translate"),A.qZA(),A.TgZ(11,"button",4),A.NdJ("click",function(){return t.removeAttribute()}),A._uU(12),A.ALo(13,"translate"),A.qZA(),A.YNc(14,yi,2,3,"perun-web-apps-attributes-list",5),A.qZA()),2&e&&(A.xp6(2),A.AsE(" ",A.lcZ(3,8,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.TITLE")," ",t.host.hostname,""),A.xp6(4),A.hij(" ",A.lcZ(7,10,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.ADD")," "),A.xp6(2),A.Q6J("disabled",0===t.selected.selected.length),A.xp6(1),A.hij(" ",A.lcZ(10,12,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.SAVE")," "),A.xp6(2),A.Q6J("disabled",0===t.selected.selected.length),A.xp6(1),A.hij(" ",A.lcZ(13,14,"FACILITY_DETAIL.HOSTS.HOSTS_DETAIL.REMOVE")," "),A.xp6(2),A.Q6J("ngIf",!t.loading))},directives:[Pe.t,Z.lW,r.O5,Ti.p],pipes:[_.X$],styles:[""]}),e}();function Ei(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"th",14),A.TgZ(1,"mat-checkbox",15),A.NdJ("change",function(e){A.CHM(i);var t=A.oxw();return e?t.masterToggle():null}),A.qZA(),A.qZA()}if(2&e){var a=A.oxw();A.xp6(1),A.Q6J("aria-label",a.checkboxLabel())("checked",a.selection.hasValue()&&a.isAllSelected())("indeterminate",a.selection.hasValue()&&!a.isAllSelected())}}function Ci(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"td",16),A.TgZ(1,"mat-checkbox",17),A.NdJ("change",function(e){var t=A.CHM(i).$implicit,a=A.oxw();return e?a.selection.toggle(t):null})("click",function(e){return e.stopPropagation()}),A.qZA(),A.qZA()}if(2&e){var a=t.$implicit,n=A.oxw();A.xp6(1),A.Q6J("aria-label",n.checkboxLabel(a))("checked",n.selection.isSelected(a))}}function Zi(e,t){1&e&&(A.TgZ(0,"th",18),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.SECURITY_TEAMS_LIST.ID")))}function _i(e,t){if(1&e&&(A.TgZ(0,"td",16),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.id)}}function ki(e,t){1&e&&(A.TgZ(0,"th",18),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.SECURITY_TEAMS_LIST.NAME")))}function Li(e,t){if(1&e&&(A.TgZ(0,"td",19),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.name)}}function xi(e,t){1&e&&(A.TgZ(0,"th",18),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED.COMPONENTS.SECURITY_TEAMS_LIST.DESCRIPTION")))}function Oi(e,t){if(1&e&&(A.TgZ(0,"td",19),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.description)}}function Di(e,t){1&e&&A._UZ(0,"tr",20)}function Ri(e,t){1&e&&A._UZ(0,"tr",21)}function Ni(e,t){1&e&&(A.TgZ(0,"app-alert",22),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}function wi(e,t){1&e&&(A.TgZ(0,"app-alert",22),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED.COMPONENTS.SECURITY_TEAMS_LIST.NO_SECURITY_TEAMS_WARNING"),"\n"))}var Yi=function(){var e=function(){function e(t,i){s(this,e),this.authResolver=t,this.tableCheckbox=i,this.securityTeams=[],this.selection=new Oe.Ov(!0,[]),this.pageSize=10,this.displayedColumns=["select","id","name","description"],this.page=new A.vpe,this.pageSizeOptions=p.f7}return o(e,[{key:"matSort",set:function(e){this.sort=e,this.setDataSource()}},{key:"ngOnChanges",value:function(e){this.authResolver.isPerunAdmin()||(this.displayedColumns=this.displayedColumns.filter(function(e){return"id"!==e})),this.dataSource=new ot.by(this.securityTeams),this.setDataSource(),this.dataSource.filter=this.filterValue}},{key:"getDataForColumn",value:function(e,t){switch(t){case"id":return e.id.toString();case"name":return e.name;case"description":return e.description;default:return""}}},{key:"exportData",value:function(e){(0,p.O6)((0,p.Xn)(this.dataSource.filteredData,this.displayedColumns,this.getDataForColumn,this),e)}},{key:"setDataSource",value:function(){var e=this;this.dataSource&&(this.dataSource.filterPredicate=function(t,i){return(0,p.Sd)(t,i,e.displayedColumns,e.getDataForColumn,e)},this.dataSource.sortData=function(t,i){return(0,p.pR)(t,i,e.getDataForColumn,e)},this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator)}},{key:"isAllSelected",value:function(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}},{key:"masterToggle",value:function(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.pageSize,this.child.paginator.pageIndex,!1)}},{key:"checkboxLabel",value:function(e){return e?"".concat(this.selection.isSelected(e)?"deselect":"select"," row ").concat(e.id+1):(this.isAllSelected()?"select":"deselect")+" all"}},{key:"ngAfterViewInit",value:function(){this.dataSource.paginator=this.child.paginator}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(g.x4),A.Y36(g.UA))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-security-teams-list"]],viewQuery:function(e,t){var i;(1&e&&(A.Gf(Nt.YE,7),A.Gf(p.l9,7)),2&e)&&(A.iGM(i=A.CRH())&&(t.matSort=i.first),A.iGM(i=A.CRH())&&(t.child=i.first))},inputs:{securityTeams:"securityTeams",selection:"selection",filterValue:"filterValue",pageSize:"pageSize",displayedColumns:"displayedColumns"},outputs:{page:"page"},features:[A.TTD],decls:19,vars:9,consts:[[1,"card","mt-3",3,"hidden"],[3,"dataLength","pageSizeOptions","pageSize","exportData","page"],["mat-table","","matSort","","matSortActive","id","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","name"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"],["alert_type","warn"]],template:function(e,t){1&e&&(A.TgZ(0,"div",0),A.TgZ(1,"perun-web-apps-table-wrapper",1),A.NdJ("exportData",function(e){return t.exportData(e)})("page",function(e){return t.page.emit(e)}),A.TgZ(2,"table",2),A.ynx(3,3),A.YNc(4,Ei,2,3,"th",4),A.YNc(5,Ci,2,2,"td",5),A.BQk(),A.ynx(6,6),A.YNc(7,Zi,3,3,"th",7),A.YNc(8,_i,2,1,"td",5),A.BQk(),A.ynx(9,8),A.YNc(10,ki,3,3,"th",7),A.YNc(11,Li,2,1,"td",9),A.BQk(),A.ynx(12,10),A.YNc(13,xi,3,3,"th",7),A.YNc(14,Oi,2,1,"td",9),A.BQk(),A.YNc(15,Di,1,0,"tr",11),A.YNc(16,Ri,1,0,"tr",12),A.qZA(),A.qZA(),A.qZA(),A.YNc(17,Ni,3,3,"app-alert",13),A.YNc(18,wi,3,3,"app-alert",13)),2&e&&(A.Q6J("hidden",0===t.dataSource.filteredData.length||0===t.securityTeams.length),A.xp6(1),A.Q6J("dataLength",t.dataSource.filteredData.length)("pageSizeOptions",t.pageSizeOptions)("pageSize",t.pageSize),A.xp6(1),A.Q6J("dataSource",t.dataSource),A.xp6(13),A.Q6J("matHeaderRowDef",t.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",t.displayedColumns),A.xp6(1),A.Q6J("ngIf",0===t.dataSource.filteredData.length&&0!==t.securityTeams.length),A.xp6(1),A.Q6J("ngIf",0===t.securityTeams.length))},directives:[wt.l,ot.BZ,Nt.YE,ot.w1,ot.fO,ot.Dz,ot.as,ot.nj,r.O5,ot.ge,ue.oG,ot.ev,Nt.nU,ot.XQ,ot.Gk,Mt.w],pipes:[_.X$],styles:[""]}),e}();function Mi(e,t){1&e&&A._UZ(0,"mat-spinner",5)}function Fi(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"app-security-teams-list",6),A.NdJ("page",function(e){return A.CHM(i),A.oxw().pageChanged(e)}),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("pageSize",a.pageSize)("filterValue",a.filterValue)("securityTeams",a.securityTeams)("displayedColumns",a.displayedColumns)("selection",a.selected)}}var qi=function(){var e=function(){function e(t,i,a,n,l){s(this,e),this.dialog=t,this.facilitiesManager=i,this.tableConfigService=a,this.route=n,this.authResolver=l,this.securityTeams=[],this.selected=new Oe.Ov(!0,[]),this.filterValue="",this.tableId=xe.O9,this.displayedColumns=[]}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe(function(t){e.facilitiesManager.getFacilityById(t.facilityId).subscribe(function(t){e.facility=t,e.refreshTable()})})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.facilitiesManager.getAssignedSecurityTeams(this.facility.id).subscribe(function(t){e.securityTeams=t,e.selected.clear(),e.setAuthRights(),e.loading=!1})}},{key:"setAuthRights",value:function(){this.addAuth=this.authResolver.isAuthorized("assignSecurityTeam_Facility_SecurityTeam_policy",[this.facility]),this.removeAuth=this.authResolver.isAuthorized("removeSecurityTeam_Facility_SecurityTeam_policy",[this.facility]),this.displayedColumns=this.removeAuth?["select","id","name","description"]:["id","name","description"]}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"addSecurityTeam",value:function(){}},{key:"removeSecurityTeam",value:function(){}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(v.uw),A.Y36(f.IQ),A.Y36(xe.dB),A.Y36(c.gz),A.Y36(g.x4))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-security-teams"]],decls:8,vars:6,consts:[[1,"page-subtitle"],[3,"refresh"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","securityTeams","displayedColumns","selection","page",4,"ngIf"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","securityTeams","displayedColumns","selection","page"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"perun-web-apps-refresh-button",1),A.NdJ("refresh",function(){return t.refreshTable()}),A.qZA(),A.TgZ(5,"perun-web-apps-immediate-filter",2),A.NdJ("filter",function(e){return t.applyFilter(e)}),A.qZA(),A.YNc(6,Mi,1,0,"mat-spinner",3),A.YNc(7,Fi,1,5,"app-security-teams-list",4),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,4,"FACILITY_DETAIL.SECURITY_TEAMS.TITLE")),A.xp6(3),A.Q6J("placeholder","FACILITY_DETAIL.SECURITY_TEAMS.FILTER"),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[Pe.t,Ge.L,r.O5,y.$g,Yi],pipes:[_.X$],styles:[""]}),e}(),Ui=l(64359),Ji=l(75374);function Qi(e,t){1&e&&A._UZ(0,"mat-spinner",6)}function zi(e,t){1&e&&(A.TgZ(0,"th",17),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"DIALOGS.DELETE_TASK_RESULT.RESULT_ID")))}function Hi(e,t){if(1&e&&(A.TgZ(0,"td",18),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.hij(" ",i.id," ")}}function Vi(e,t){1&e&&(A.TgZ(0,"th",17),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"DIALOGS.DELETE_TASK_RESULT.DESTINATION")))}function Bi(e,t){if(1&e&&(A.TgZ(0,"td",18),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.hij(" ",i.destination.destination," ")}}function Pi(e,t){1&e&&(A.TgZ(0,"th",17),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"DIALOGS.DELETE_TASK_RESULT.TIME")))}function Gi(e,t){if(1&e&&(A.TgZ(0,"td",18),A._uU(1),A.ALo(2,"date"),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.hij(" ",A.xi3(2,1,i.timestamp,"d.M.y H:mm:ss")," ")}}function $i(e,t){1&e&&A._UZ(0,"tr",19)}function ji(e,t){1&e&&A._UZ(0,"tr",20)}function Ki(e,t){if(1&e&&(A.TgZ(0,"div",7),A.TgZ(1,"p"),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"div",8),A._uU(5),A.ALo(6,"translate"),A.qZA(),A.TgZ(7,"table",9),A.ynx(8,10),A.YNc(9,zi,3,3,"th",11),A.YNc(10,Hi,2,1,"td",12),A.BQk(),A.ynx(11,13),A.YNc(12,Vi,3,3,"th",11),A.YNc(13,Bi,2,1,"td",12),A.BQk(),A.ynx(14,14),A.YNc(15,Pi,3,3,"th",11),A.YNc(16,Gi,3,4,"td",12),A.BQk(),A.YNc(17,$i,1,0,"tr",15),A.YNc(18,ji,1,0,"tr",16),A.qZA(),A.qZA()),2&e){var i=A.oxw();A.xp6(2),A.Oqu(A.lcZ(3,5,"DIALOGS.DELETE_TASK_RESULT.DESCRIPTION")),A.xp6(3),A.hij(" ",A.lcZ(6,7,"DIALOGS.DELETE_TASK_RESULT.ASK")," "),A.xp6(2),A.Q6J("dataSource",i.dataSource),A.xp6(10),A.Q6J("matHeaderRowDef",i.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",i.displayedColumns)}}var Wi=function(){var e=function(){function e(t,i,a,n,l){s(this,e),this.dialogRef=t,this.data=i,this.taskManager=a,this.notificator=n,this.translate=l,this.loading=!1,this.dataSource=new ot.by(this.data.taskResults),this.displayedColumns=["id","destination","time"]}return o(e,[{key:"ngOnInit",value:function(){this.theme=this.data.theme,this.taskResults=this.data.taskResults}},{key:"deleteResults",value:function(){var e=this;if(this.loading=!0,0===this.taskResults.length)return this.dialogRef.close(!0),this.loading=!1,void this.notificator.showSuccess(this.translate.instant("DIALOGS.DELETE_TASK_RESULT.SUCCESS"));this.taskManager.deleteTaskResultById({taskResultId:this.taskResults.pop().id}).subscribe(function(){e.deleteResults()},function(){return e.loading=!1})}},{key:"onDelete",value:function(){this.deleteResults()}},{key:"onCancel",value:function(){this.dialogRef.close(!1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(v.so),A.Y36(v.WI),A.Y36(f.Ob),A.Y36(g.V6),A.Y36(_.sK))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-delete-task-result-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content",""],[1,"font-weight-bold"],["mat-table","",1,"w-100",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","destination"],["matColumnDef","time"],["mat-header-row","","class","font-weight-bolder",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-row","",1,"font-weight-bolder"],["mat-row",""]],template:function(e,t){1&e&&(A.TgZ(0,"h1",0),A._uU(1),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"div"),A.YNc(4,Qi,1,0,"mat-spinner",1),A.YNc(5,Ki,19,9,"div",2),A.TgZ(6,"div",3),A.TgZ(7,"button",4),A.NdJ("click",function(){return t.onCancel()}),A._uU(8),A.ALo(9,"translate"),A.qZA(),A.TgZ(10,"button",5),A.NdJ("click",function(){return t.onDelete()}),A._uU(11),A.ALo(12,"translate"),A.qZA(),A.qZA(),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,9,"DIALOGS.DELETE_TASK_RESULT.TITLE")),A.xp6(2),A.Tol(t.theme),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(3),A.hij(" ",A.lcZ(9,11,"DIALOGS.DELETE_TASK_RESULT.CANCEL")," "),A.xp6(2),A.Q6J("disabled",t.loading),A.xp6(1),A.hij(" ",A.lcZ(12,13,"DIALOGS.DELETE_TASK_RESULT.REMOVE")," "))},directives:[v.uh,r.O5,v.H8,Z.lW,y.$g,v.xY,ot.BZ,ot.w1,ot.fO,ot.Dz,ot.as,ot.nj,ot.ge,ot.ev,ot.XQ,ot.Gk],pipes:[_.X$,r.uU],styles:[""]}),e}(),Xi=l(88884);function ea(e,t){1&e&&A._UZ(0,"mat-spinner",6)}function ta(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-checkbox",13),A.NdJ("change",function(e){return A.CHM(i),A.oxw(2).change(e)}),A.ALo(1,"translate"),A._uU(2),A.ALo(3,"translate"),A.qZA()}if(2&e){var a=A.oxw(2);A.s9C("matTooltip",A.lcZ(1,5,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOXES_DISABLED")),A.Q6J("matTooltipDisabled",!a.checkboxesDisabled)("disabled",a.checkboxesDisabled)("checked",a.taskChecked),A.xp6(2),A.hij(" ",A.lcZ(3,7,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOX_TASK_AND_TASK_RESULTS")," ")}}function ia(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"mat-checkbox",14),A.NdJ("change",function(e){return A.CHM(i),A.oxw(2).change(e)}),A.ALo(1,"translate"),A._uU(2),A.ALo(3,"translate"),A.qZA()}if(2&e){var a=A.oxw(2);A.s9C("matTooltip",A.lcZ(1,5,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOXES_DISABLED")),A.Q6J("matTooltipDisabled",!a.checkboxesDisabled)("disabled",a.checkboxesDisabled)("checked",a.taskResultsChecked),A.xp6(2),A.hij(" ",A.lcZ(3,7,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOX_TASK_RESULTS")," ")}}function aa(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"perun-web-apps-resources-list",15),A.NdJ("allSelected",function(e){return A.CHM(i),A.oxw(2).disableCheckboxes(e)})("page",function(e){return A.CHM(i),A.oxw(2).pageChanged(e)}),A.qZA()}if(2&e){var a=A.oxw(2);A.Q6J("pageSize",a.pageSize)("disableRouting",!0)("resources",a.resources)("selection",a.selected)("displayedColumns",a.displayedColumns)}}function na(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"div",7),A.TgZ(1,"p"),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"div"),A.YNc(5,ta,4,9,"mat-checkbox",8),A.YNc(6,ia,4,9,"mat-checkbox",9),A.TgZ(7,"mat-checkbox",10),A.NdJ("change",function(e){return A.CHM(i),A.oxw().change(e)}),A.ALo(8,"translate"),A._uU(9),A.ALo(10,"translate"),A.qZA(),A.qZA(),A.TgZ(11,"p"),A._uU(12),A.ALo(13,"translate"),A.qZA(),A.TgZ(14,"div",11),A._uU(15),A.ALo(16,"translate"),A.qZA(),A.YNc(17,aa,1,5,"perun-web-apps-resources-list",12),A.qZA()}if(2&e){var a=A.oxw();A.xp6(2),A.Oqu(A.lcZ(3,11,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOXES_DESCRIPTION")),A.xp6(3),A.Q6J("ngIf",null!==a.taskId),A.xp6(1),A.Q6J("ngIf",null!==a.taskId),A.xp6(1),A.s9C("matTooltip",A.lcZ(8,13,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOXES_DISABLED")),A.Q6J("matTooltipDisabled",!a.checkboxesDisabled)("disabled",a.checkboxesDisabled)("checked",a.destinationChecked),A.xp6(2),A.hij(" ",A.lcZ(10,15,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOX_DESTINATION")," "),A.xp6(3),A.Oqu(A.lcZ(13,17,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.DESCRIPTION")),A.xp6(3),A.hij(" ",A.lcZ(16,19,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.ASK")," "),A.xp6(2),A.Q6J("ngIf",!a.loading)}}var sa=function(){var t=function(){function t(i,a,n,l,o,r,c,u,d){s(this,t),this.dialogRef=i,this.data=a,this.tableConfigService=n,this.resourcesManager=l,this.tasksManager=o,this.serviceManager=r,this.translate=c,this.notificator=u,this.cd=d,this.loading=!1,this.dataSource=new ot.by(this.data.resource),this.selected=new Oe.Ov(!0,e(this.dataSource.data)),this.resources=[],this.displayedColumns=["select","id","vo","name"],this.checkboxesDisabled=!1,this.taskChecked=!0,this.taskResultsChecked=!0,this.destinationChecked=!0,this.tableId=xe.$V}return o(t,[{key:"ngOnInit",value:function(){this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.theme=this.data.theme,this.taskId=this.data.taskId,this.serviceId=this.data.serviceId,this.facilityId=this.data.facilityId,this.resources=this.data.resource}},{key:"remove",value:function(){var e=this;this.loading=!0,this.taskResultsChecked&&!this.taskChecked&&null!==this.taskId&&this.tasksManager.getTaskResultsForGUIByTask(this.taskId).subscribe(function(t){t.forEach(function(t){e.tasksManager.deleteTaskResultById({taskResultId:t.id}).subscribe()})}),this.taskChecked&&null!==this.taskId&&this.tasksManager.deleteTask({task:this.taskId}).subscribe(),this.destinationChecked&&this.serviceManager.getDestinations(this.serviceId,this.facilityId).subscribe(function(t){t.forEach(function(t){e.serviceManager.removeDestination(e.serviceId,e.facilityId,t.destination,t.type).subscribe()})}),this.selected.selected.forEach(function(t){e.resourcesManager.removeService(t.id,e.serviceId).subscribe(function(){e.translate.get("DIALOGS.REMOVE_SERVICE_FROM_FACILITY.SUCCESS").subscribe(function(t){e.notificator.showSuccess(t),e.dialogRef.close(!0)})},function(){return e.loading=!1})})}},{key:"cancel",value:function(){this.dialogRef.close(!1)}},{key:"disableCheckboxes",value:function(e){e&&this.checkboxesDisabled&&this.changeCheckboxes(!0),e||this.checkboxesDisabled||this.changeCheckboxes(!1)}},{key:"changeCheckboxes",value:function(e){this.checkboxesDisabled=!e,this.taskChecked=e,this.taskResultsChecked=e,this.destinationChecked=e,this.cd.detectChanges()}},{key:"change",value:function(e){switch(e.source.id){case"task":this.taskChecked=e.checked;break;case"taskResults":this.taskResultsChecked=e.checked;break;case"destination":this.destinationChecked=e.checked}}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),t}();return t.\u0275fac=function(e){return new(e||t)(A.Y36(v.so),A.Y36(v.WI),A.Y36(xe.dB),A.Y36(f.xk),A.Y36(f.Ob),A.Y36(f.KK),A.Y36(_.sK),A.Y36(g.V6),A.Y36(A.sBO))},t.\u0275cmp=A.Xpm({type:t,selectors:[["app-delete-service-from-facility"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content",""],["id","task","class","right-space","color","warn",3,"matTooltip","matTooltipDisabled","disabled","checked","change",4,"ngIf"],["id","taskResults","class","right-space","color","warn",3,"matTooltip","matTooltipDisabled","disabled","checked","change",4,"ngIf"],["id","destination","color","warn",3,"matTooltip","matTooltipDisabled","disabled","checked","change"],[1,"font-weight-bold"],[3,"pageSize","disableRouting","resources","selection","displayedColumns","allSelected","page",4,"ngIf"],["id","task","color","warn",1,"right-space",3,"matTooltip","matTooltipDisabled","disabled","checked","change"],["id","taskResults","color","warn",1,"right-space",3,"matTooltip","matTooltipDisabled","disabled","checked","change"],[3,"pageSize","disableRouting","resources","selection","displayedColumns","allSelected","page"]],template:function(e,t){1&e&&(A.TgZ(0,"h1",0),A._uU(1),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"div"),A.YNc(4,ea,1,0,"mat-spinner",1),A.YNc(5,na,18,21,"div",2),A.TgZ(6,"div",3),A.TgZ(7,"button",4),A.NdJ("click",function(){return t.cancel()}),A._uU(8),A.ALo(9,"translate"),A.qZA(),A.TgZ(10,"button",5),A.NdJ("click",function(){return t.remove()}),A._uU(11),A.ALo(12,"translate"),A.qZA(),A.qZA(),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,9,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.TITLE")),A.xp6(2),A.Tol(t.theme),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(3),A.hij(" ",A.lcZ(9,11,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CANCEL")," "),A.xp6(2),A.Q6J("disabled",t.loading||0===t.selected.selected.length),A.xp6(1),A.hij(" ",A.lcZ(12,13,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.REMOVE")," "))},directives:[v.uh,r.O5,v.H8,Z.lW,y.$g,v.xY,ue.oG,E.gM,Xi.C],pipes:[_.X$],styles:[".right-space[_ngcontent-%COMP%]{margin-right:40px}"]}),t}();function la(e,t){1&e&&A._UZ(0,"mat-spinner",6)}function oa(e,t){1&e&&(A.TgZ(0,"div",7),A.TgZ(1,"div",8),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.qZA()),2&e&&(A.xp6(2),A.hij(" ",A.lcZ(3,1,"DIALOGS.DELETE_TASK.DESCRIPTION")," "))}var ra=function(){var e=function(){function e(t,i,a,n,l){s(this,e),this.dialogRef=t,this.data=i,this.tasksManager=a,this.translate=n,this.notificator=l,this.loading=!1}return o(e,[{key:"ngOnInit",value:function(){this.theme=this.data.theme,this.taskId=this.data.taskId}},{key:"remove",value:function(){var e=this;this.loading=!0,this.tasksManager.deleteTask({task:this.taskId}).subscribe(function(){e.translate.get("DIALOGS.DELETE_TASK.SUCCESS").subscribe(function(t){e.notificator.showSuccess(t),e.dialogRef.close(!0)})},function(){return e.loading=!1})}},{key:"cancel",value:function(){this.dialogRef.close(!1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(v.so),A.Y36(v.WI),A.Y36(f.Ob),A.Y36(_.sK),A.Y36(g.V6))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-delete-task-dialog"]],decls:13,vars:15,consts:[["mat-dialog-title",""],["class","ml-auto mr-auto",4,"ngIf"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],["mat-flat-button","",1,"ml-auto",3,"click"],["mat-flat-button","","color","warn",1,"ml-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],["mat-dialog-content",""],[1,"font-weight-bold"]],template:function(e,t){1&e&&(A.TgZ(0,"h1",0),A._uU(1),A.ALo(2,"translate"),A.qZA(),A.TgZ(3,"div"),A.YNc(4,la,1,0,"mat-spinner",1),A.YNc(5,oa,4,3,"div",2),A.TgZ(6,"div",3),A.TgZ(7,"button",4),A.NdJ("click",function(){return t.cancel()}),A._uU(8),A.ALo(9,"translate"),A.qZA(),A.TgZ(10,"button",5),A.NdJ("click",function(){return t.remove()}),A._uU(11),A.ALo(12,"translate"),A.qZA(),A.qZA(),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,9,"DIALOGS.DELETE_TASK.TITLE")),A.xp6(2),A.Tol(t.theme),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(3),A.hij(" ",A.lcZ(9,11,"DIALOGS.DELETE_TASK.CANCEL")," "),A.xp6(2),A.Q6J("disabled",t.loading),A.xp6(1),A.hij(" ",A.lcZ(12,13,"DIALOGS.DELETE_TASK.DELETE")," "))},directives:[v.uh,r.O5,v.H8,Z.lW,y.$g,v.xY],pipes:[_.X$],styles:[""]}),e}(),ca=l(8055),ua=function(){var e=function(){function e(){s(this,e)}return o(e,[{key:"transform",value:function(e){return e.blockedOnFacility?"BLOCKED":e.blockedGlobally?"BLOCKED GLOBALLY":"ALLOWED"}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=A.Yjl({name:"serviceStateBlockedToString",type:e,pure:!0}),e}();function da(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"th",17),A.TgZ(1,"mat-checkbox",18),A.NdJ("change",function(e){A.CHM(i);var t=A.oxw();return e&&t.masterToggle(),t.selectionChange.emit()}),A.qZA(),A.qZA()}if(2&e){var a=A.oxw();A.xp6(1),A.Q6J("checked",a.selection.hasValue()&&a.isAllSelected())("indeterminate",a.selection.hasValue()&&!a.isAllSelected())("aria-label",a.checkboxLabel())}}function ha(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"td",19),A.TgZ(1,"mat-checkbox",20),A.NdJ("click",function(e){return e.stopPropagation()})("change",function(e){var t=A.CHM(i).$implicit,a=A.oxw();return e&&a.selection.toggle(t),a.selectionChange.emit()}),A.qZA(),A.qZA()}if(2&e){var a=t.$implicit,n=A.oxw();A.xp6(1),A.Q6J("checked",n.selection.isSelected(a))("aria-label",n.checkboxLabel(a))}}function fa(e,t){1&e&&(A.TgZ(0,"th",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.TASK_ID")))}function pa(e,t){if(1&e&&(A.TgZ(0,"div"),A._uU(1),A.qZA()),2&e){var i=A.oxw().$implicit;A.xp6(1),A.Oqu(i.task.id)}}function ga(e,t){1&e&&(A.TgZ(0,"div"),A._uU(1,"0"),A.qZA())}function ma(e,t){if(1&e&&(A.TgZ(0,"td",19),A.YNc(1,pa,2,1,"div",22),A.YNc(2,ga,2,0,"div",22),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Q6J("ngIf",i.task),A.xp6(1),A.Q6J("ngIf",!i.task)}}function Sa(e,t){1&e&&(A.TgZ(0,"th",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.SERVICE_NAME")))}function Aa(e,t){if(1&e&&(A.TgZ(0,"td",23),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.service.name)}}function va(e,t){1&e&&(A.TgZ(0,"th",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.STATUS")))}function Ta(e,t){if(1&e&&(A.TgZ(0,"td",23),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.status)}}function Ia(e,t){1&e&&(A.TgZ(0,"th",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.BLOCKED")))}function ya(e,t){if(1&e&&(A.TgZ(0,"td",23),A._uU(1),A.ALo(2,"serviceStateBlockedToString"),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(A.lcZ(2,1,i))}}function ba(e,t){1&e&&(A.TgZ(0,"th",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.STARTED")))}function Ea(e,t){if(1&e&&(A.TgZ(0,"div"),A._uU(1),A.ALo(2,"date"),A.qZA()),2&e){var i=A.oxw().$implicit;A.xp6(1),A.Oqu(A.xi3(2,1,i.task.startTime,"d.M.y H:mm:ss"))}}function Ca(e,t){1&e&&(A.TgZ(0,"div"),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.NOT_YET"),""))}function Za(e,t){if(1&e&&(A.TgZ(0,"td",23),A.YNc(1,Ea,3,4,"div",22),A.YNc(2,Ca,3,3,"div",22),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Q6J("ngIf",i.task&&i.task.startTime),A.xp6(1),A.Q6J("ngIf",!i.task||!i.task.startTime)}}function _a(e,t){1&e&&(A.TgZ(0,"th",21),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.ENDED")))}function ka(e,t){if(1&e&&(A.TgZ(0,"div"),A._uU(1),A.ALo(2,"date"),A.qZA()),2&e){var i=A.oxw().$implicit;A.xp6(1),A.Oqu(A.xi3(2,1,i.task.endTime,"d.M.y H:mm:ss"))}}function La(e,t){1&e&&(A.TgZ(0,"div"),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.NOT_YET")," "))}function xa(e,t){if(1&e&&(A.TgZ(0,"td",23),A.YNc(1,ka,3,4,"div",22),A.YNc(2,La,3,3,"div",22),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Q6J("ngIf",i.task&&i.task.endTime),A.xp6(1),A.Q6J("ngIf",!i.task||!i.task.endTime)}}function Oa(e,t){1&e&&A._UZ(0,"tr",24)}var Da=function(e,t){return["/facilities",e,"services-status",t]};function Ra(e,t){if(1&e&&A._UZ(0,"tr",25),2&e){var i=t.$implicit,a=A.oxw();A.ekj("disable-outline",a.disableRouting||!i.task)("make-yellow","WARNING"===i.status)("make-green","DONE"===i.status)("make-red","GENERROR"===i.status||"SENDERROR"===i.status||"ERROR"===i.status)("cursor-pointer",!a.disableRouting&&null!==i.task),A.Q6J("routerLink",a.disableRouting||null===i.task?null:A.WLB(12,Da,i.facility.id,i.taskId))("perunWebAppsMiddleClickRouterLink",a.disableRouting||null===i.task?null:A.WLB(15,Da,i.facility.id,i.taskId))}}function Na(e,t){1&e&&(A.TgZ(0,"app-alert",26),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}function wa(e,t){1&e&&(A.TgZ(0,"app-alert",26),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.NO_SERVICES_STATUS_WARNING"),"\n"))}var Ya=function(){var e=function(){function e(t,i){s(this,e),this.authResolver=t,this.tableCheckbox=i,this.servicesStatus=[],this.displayedColumns=["select","task.id","service.name","status","blocked","task.startTime","task.endTime"],this.selection=new Oe.Ov(!0,[]),this.pageSize=10,this.disableRouting=!0,this.page=new A.vpe,this.selectionChange=new A.vpe,this.pageSizeOptions=p.f7}return o(e,[{key:"matSort",set:function(e){this.sort=e,this.setDataSource()}},{key:"ngOnChanges",value:function(e){this.authResolver.isPerunAdmin()||(this.displayedColumns=this.displayedColumns.filter(function(e){return"task.id"!==e})),this.dataSource=new ot.by(this.servicesStatus),this.setDataSource(),this.dataSource.filterPredicate=function(e,t){var i=t.trim().toLowerCase();return function e(t){var i="";return Object.values(t).forEach(function(t){"object"!=typeof t?i=i+" "+t:null!==t&&(i=i+" "+e(t))}),i.trim().toLowerCase()}(e).includes(i)},this.dataSource.filter=this.filterValue}},{key:"getDataForColumn",value:function(e,t){switch(t){case"task.id":return e.task?e.task.id.toString():e[t];case"service.name":return e.service.name;case"status":return e.status;case"blocked":return e.blockedOnFacility?"BLOCKED":e.blockedGlobally?"BLOCKED GLOBALLY":"ALLOWED";case"task.startTime":return e.task&&e.task.startTime?(0,r.p6)(e.task.startTime,"d.M.y H:mm:ss","en"):e[t];case"task.endTime":return e.task&&e.task.endTime?(0,r.p6)(e.task.endTime,"d.M.y H:mm:ss","en"):e[t];default:return e[t]}}},{key:"getSortDataForColumn",value:function(e,t){switch(t){case"task.id":return e.task?e.task.id.toString():e[t];case"service.name":return e.service.name;case"status":return e.status;case"blocked":return e.blockedOnFacility?"BLOCKED":e.blockedGlobally?"BLOCKED GLOBALLY":"ALLOWED";case"task.startTime":return e.task&&e.task.startTime?(0,r.p6)(e.task.startTime,"yyyy.MM.dd HH:mm:ss","en"):e[t];case"task.endTime":return e.task&&e.task.endTime?(0,r.p6)(e.task.endTime,"yyyy.MM.dd HH:mm:ss","en"):e[t];default:return e[t]}}},{key:"exportData",value:function(e){(0,p.O6)((0,p.Xn)(this.dataSource.filteredData,this.displayedColumns,this.getDataForColumn,this),e)}},{key:"setDataSource",value:function(){var e=this;this.dataSource&&(this.dataSource.filterPredicate=function(t,i){return(0,p.Sd)(t,i,e.displayedColumns,e.getDataForColumn,e)},this.dataSource.sortData=function(t,i){return(0,p.pR)(t,i,e.getSortDataForColumn,e)},this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator)}},{key:"isAllSelected",value:function(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}},{key:"masterToggle",value:function(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.pageSize,this.child.paginator.pageIndex,!1)}},{key:"checkboxLabel",value:function(e){return e?"".concat(this.selection.isSelected(e)?"deselect":"select"," row ").concat(e.service.id+1):(this.isAllSelected()?"select":"deselect")+" all"}},{key:"ngAfterViewInit",value:function(){this.dataSource.paginator=this.child.paginator}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(g.x4),A.Y36(g.UA))},e.\u0275cmp=A.Xpm({type:e,selectors:[["perun-web-apps-services-status-list"]],viewQuery:function(e,t){var i;(1&e&&(A.Gf(Nt.YE,7),A.Gf(p.l9,7)),2&e)&&(A.iGM(i=A.CRH())&&(t.matSort=i.first),A.iGM(i=A.CRH())&&(t.child=i.first))},inputs:{servicesStatus:"servicesStatus",displayedColumns:"displayedColumns",selection:"selection",filterValue:"filterValue",pageSize:"pageSize",disableRouting:"disableRouting"},outputs:{page:"page",selectionChange:"selectionChange"},features:[A.TTD],decls:28,vars:9,consts:[[1,"card","mt-3",3,"hidden"],[3,"dataLength","pageSizeOptions","pageSize","exportData","page"],["mat-table","","matSort","","matSortActive","service.name","matSortDirection","asc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","","class","static-column-size",4,"matCellDef"],["matColumnDef","task.id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","service.name"],["mat-cell","",4,"matCellDef"],["matColumnDef","status"],["matColumnDef","blocked"],["matColumnDef","task.startTime"],["matColumnDef","task.endTime"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","dark-hover-list-item",3,"disable-outline","make-yellow","make-green","make-red","cursor-pointer","routerLink","perunWebAppsMiddleClickRouterLink",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["color","primary",3,"checked","indeterminate","aria-label","change"],["mat-cell","",1,"static-column-size"],["color","primary",3,"checked","aria-label","click","change"],["mat-header-cell","","mat-sort-header",""],[4,"ngIf"],["mat-cell",""],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item",3,"routerLink","perunWebAppsMiddleClickRouterLink"],["alert_type","warn"]],template:function(e,t){1&e&&(A.TgZ(0,"div",0),A.TgZ(1,"perun-web-apps-table-wrapper",1),A.NdJ("exportData",function(e){return t.exportData(e)})("page",function(e){return t.page.emit(e)}),A.TgZ(2,"table",2),A.ynx(3,3),A.YNc(4,da,2,3,"th",4),A.YNc(5,ha,2,2,"td",5),A.BQk(),A.ynx(6,6),A.YNc(7,fa,3,3,"th",7),A.YNc(8,ma,3,2,"td",5),A.BQk(),A.ynx(9,8),A.YNc(10,Sa,3,3,"th",7),A.YNc(11,Aa,2,1,"td",9),A.BQk(),A.ynx(12,10),A.YNc(13,va,3,3,"th",7),A.YNc(14,Ta,2,1,"td",9),A.BQk(),A.ynx(15,11),A.YNc(16,Ia,3,3,"th",7),A.YNc(17,ya,3,3,"td",9),A.BQk(),A.ynx(18,12),A.YNc(19,ba,3,3,"th",7),A.YNc(20,Za,3,2,"td",9),A.BQk(),A.ynx(21,13),A.YNc(22,_a,3,3,"th",7),A.YNc(23,xa,3,2,"td",9),A.BQk(),A.YNc(24,Oa,1,0,"tr",14),A.YNc(25,Ra,1,18,"tr",15),A.qZA(),A.qZA(),A.qZA(),A.YNc(26,Na,3,3,"app-alert",16),A.YNc(27,wa,3,3,"app-alert",16)),2&e&&(A.Q6J("hidden",0===t.dataSource.filteredData.length||0===t.servicesStatus.length),A.xp6(1),A.Q6J("dataLength",t.dataSource.filteredData.length)("pageSizeOptions",t.pageSizeOptions)("pageSize",t.pageSize),A.xp6(1),A.Q6J("dataSource",t.dataSource),A.xp6(22),A.Q6J("matHeaderRowDef",t.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",t.displayedColumns),A.xp6(1),A.Q6J("ngIf",0===t.dataSource.filteredData.length&&0!==t.servicesStatus.length),A.xp6(1),A.Q6J("ngIf",0===t.servicesStatus.length))},directives:[wt.l,ot.BZ,Nt.YE,ot.w1,ot.fO,ot.Dz,ot.as,ot.nj,r.O5,ot.ge,ue.oG,ot.ev,Nt.nU,ot.XQ,ot.Gk,c.rH,Yt.YH,Mt.w],pipes:[_.X$,ua,r.uU],styles:[".disable-outline[_ngcontent-%COMP%]{outline:none!important}.make-green[_ngcontent-%COMP%]{background-color:#c4ffcb}.make-yellow[_ngcontent-%COMP%]{background-color:#fffde7}.make-red[_ngcontent-%COMP%]{background-color:#ffcdd2}.cursor-pointer[_ngcontent-%COMP%]{cursor:pointer}"]}),e}();function Ma(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",11),A.NdJ("click",function(){return A.CHM(i),A.oxw().forcePropagation()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selected.selected.length),A.xp6(1),A.hij(" ",A.lcZ(2,2,"FACILITY_DETAIL.SERVICES_STATUS.FORCE_PROPAGATION")," ")}}function Fa(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",11),A.NdJ("click",function(){return A.CHM(i),A.oxw().allow()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selected.selected.length||a.disableAllowButton),A.xp6(1),A.hij(" ",A.lcZ(2,2,"FACILITY_DETAIL.SERVICES_STATUS.ALLOW")," ")}}function qa(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",12),A.NdJ("click",function(){return A.CHM(i),A.oxw().block()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("disabled",0===a.selected.selected.length||a.disableBlockButton),A.xp6(1),A.hij(" ",A.lcZ(2,2,"FACILITY_DETAIL.SERVICES_STATUS.BLOCK")," ")}}function Ua(e,t){if(1&e&&(A.TgZ(0,"button",13),A.ALo(1,"translate"),A._uU(2),A.ALo(3,"translate"),A.qZA()),2&e){var i=A.oxw(),a=A.MAs(10);A.s9C("matTooltip",A.lcZ(1,5,"DIALOGS.REMOVE_SERVICE_FROM_FACILITY.CHECKBOXES_DISABLED")),A.Q6J("matTooltipDisabled",!i.disableRemoveButton)("disabled",i.disableRemoveButton)("matMenuTriggerFor",a),A.xp6(2),A.hij(" ",A.lcZ(3,7,"FACILITY_DETAIL.SERVICES_STATUS.REMOVE")," ")}}function Ja(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",7),A.NdJ("click",function(){return A.CHM(i),A.oxw().removeTaskResults()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"FACILITY_DETAIL.SERVICES_STATUS.REMOVE_TASK_RESULTS")," "))}function Qa(e,t){1&e&&A._UZ(0,"mat-spinner",14)}function za(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"perun-web-apps-services-status-list",15),A.NdJ("page",function(e){return A.CHM(i),A.oxw().pageChanged(e)})("selectionChange",function(){return A.CHM(i),A.oxw().selectionChanged()}),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("pageSize",a.pageSize)("filterValue",a.filterValue)("servicesStatus",a.servicesStates)("selection",a.selected)("disableRouting",!a.routeAuth)}}var Ha=function(){var e=function(){function e(t,i,a,n,l,o,r,c,u,d){var h=this;s(this,e),this.route=t,this.tasksManager=i,this.tableConfigService=a,this.servicesManager=n,this.notificator=l,this.translate=o,this.authResolver=r,this.facilityManager=c,this.resourcesManager=u,this.dialog=d,this.servicesStates=[],this.selected=new Oe.Ov(!0,[]),this.filterValue="",this.tableId=xe.oK,this.disableAllowButton=!0,this.disableBlockButton=!0,this.disableRemoveButton=!0,o.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_FORCE_PROPAGATION").subscribe(function(e){return h.successFPMessage=e}),o.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_ALLOW").subscribe(function(e){return h.successAllowMessage=e}),o.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_BLOCK").subscribe(function(e){return h.successBlockMessage=e}),o.get("FACILITY_DETAIL.SERVICES_STATUS.SUCCESS_DELETE").subscribe(function(e){return h.successDeleteMessage=e}),o.get("FACILITY_DETAIL.SERVICES_STATUS.ALREADY_DELETED").subscribe(function(e){return h.allreadyDeletedMessage=e})}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe(function(t){e.facilityId=parseInt(t.facilityId,10),e.facility={id:e.facilityId,beanName:"Facility"},e.refreshTable()})}},{key:"forcePropagation",value:function(){var e,t=this,a=i(this.selected.selected);try{for(a.s();!(e=a.n()).done;){var n=e.value;this.servicesManager.forceServicePropagation(n.service.id,n.facility.id).subscribe(function(){t.refreshTable(),t.notificator.showSuccess(t.successFPMessage)})}}catch(s){a.e(s)}finally{a.f()}}},{key:"allow",value:function(){var e,t=this,a=i(this.selected.selected);try{for(a.s();!(e=a.n()).done;){var n=e.value;this.servicesManager.unblockServiceOnFacility(n.service.id,n.facility.id).subscribe(function(){t.refreshTable(),t.notificator.showSuccess(t.successAllowMessage)})}}catch(s){a.e(s)}finally{a.f()}}},{key:"block",value:function(){var e,t=this,a=i(this.selected.selected);try{for(a.s();!(e=a.n()).done;){var n=e.value;this.servicesManager.blockServiceOnFacility(n.service.id,n.facility.id).subscribe(function(){t.refreshTable(),t.notificator.showSuccess(t.successBlockMessage)})}}catch(s){a.e(s)}finally{a.f()}}},{key:"removeTaskResults",value:function(){var e=this;this.tasksManager.getTaskResultsForGUIByTask(this.selected.selected[0].task.id).subscribe(function(t){var i=(0,p.kZ)();i.width="600px",i.data={theme:"facility-theme",taskResults:t},e.dialog.open(Wi,i)})}},{key:"removeServiceFromFacility",value:function(){var e=this;this.facilityManager.getAssignedResourcesByAssignedServiceForFacility(this.selected.selected[0].facility.id,this.selected.selected[0].service.id).subscribe(function(t){var i=(0,p.kZ)();i.width="600px",e.taskId=e.taskIsNull?null:e.selected.selected[0].task.id,0===t.length?(i.data={theme:"facility-theme",taskId:e.taskId},e.dialog.open(ra,i).afterClosed().subscribe(function(t){t&&(e.disableRemoveButton=!0,e.refreshTable())})):e.resourcesManager.getRichResourcesByIds(t.map(function(e){return e.id})).subscribe(function(t){i.data={theme:"facility-theme",taskId:e.taskId,serviceId:e.selected.selected[0].service.id,facilityId:e.selected.selected[0].facility.id,resource:t},e.dialog.open(sa,i).afterClosed().subscribe(function(t){t&&(e.disableRemoveButton=!0,e.refreshTable())})})})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.tasksManager.getFacilityServicesState(this.facilityId).subscribe(function(t){e.servicesStates=t,e.selected.clear(),e.setAuthRights(),e.loading=!1})}},{key:"setAuthRights",value:function(){this.propagationAuth=this.authResolver.isAuthorized("forceServicePropagation_Facility_Service_policy",[this.facility]),this.blockAuth=this.authResolver.isAuthorized("blockServiceOnFacility_Service_Facility_policy",[this.facility]),this.allowAuth=this.authResolver.isAuthorized("unblockServiceOnFacility_Service_Facility_policy",[this.facility]),this.deleteAuth=this.authResolver.isAuthorized("deleteTask_Task_policy",[this.facility]),this.routeAuth=this.authResolver.isAuthorized("getTaskResultsByTask_int_policy",[this.facility])}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}},{key:"selectionChanged",value:function(){this.disableBlockButton=!0,this.disableAllowButton=!0,this.disableRemoveButton=1!==this.selected.selected.length,this.disableRemoveButton||(this.taskIsNull=null===this.selected.selected[0].task);var e,t=i(this.selected.selected);try{for(t.s();!(e=t.n()).done;){e.value.blockedOnFacility?this.disableAllowButton=!1:this.disableBlockButton=!1}}catch(a){t.e(a)}finally{t.f()}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(c.gz),A.Y36(f.Ob),A.Y36(xe.dB),A.Y36(f.KK),A.Y36(g.V6),A.Y36(_.sK),A.Y36(g.x4),A.Y36(f.IQ),A.Y36(f.xk),A.Y36(v.uw))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-service-status"]],decls:18,vars:14,consts:[[1,"page-subtitle"],[3,"refresh"],["mat-flat-button","","color","accent","class","mr-2",3,"disabled","click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2",3,"disabled","click",4,"ngIf"],["mat-flat-button","","color","warn","class","mr-2 dropdown-toggle",3,"matTooltip","matTooltipDisabled","disabled","matMenuTriggerFor",4,"ngIf"],["menu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"pageSize","filterValue","servicesStatus","selection","disableRouting","page","selectionChange",4,"ngIf"],["mat-flat-button","","color","accent",1,"mr-2",3,"disabled","click"],["mat-flat-button","","color","warn",1,"mr-2",3,"disabled","click"],["mat-flat-button","","color","warn",1,"mr-2","dropdown-toggle",3,"matTooltip","matTooltipDisabled","disabled","matMenuTriggerFor"],[1,"ml-auto","mr-auto"],[3,"pageSize","filterValue","servicesStatus","selection","disableRouting","page","selectionChange"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.TgZ(4,"perun-web-apps-refresh-button",1),A.NdJ("refresh",function(){return t.refreshTable()}),A.qZA(),A.YNc(5,Ma,3,4,"button",2),A.YNc(6,Fa,3,4,"button",2),A.YNc(7,qa,3,4,"button",3),A.YNc(8,Ua,4,9,"button",4),A.TgZ(9,"mat-menu",null,5),A.YNc(11,Ja,3,3,"button",6),A.TgZ(12,"button",7),A.NdJ("click",function(){return t.removeServiceFromFacility()}),A._uU(13),A.ALo(14,"translate"),A.qZA(),A.qZA(),A.TgZ(15,"perun-web-apps-immediate-filter",8),A.NdJ("filter",function(e){return t.applyFilter(e)}),A.qZA(),A.YNc(16,Qa,1,0,"mat-spinner",9),A.YNc(17,za,1,5,"perun-web-apps-services-status-list",10),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,10,"FACILITY_DETAIL.SERVICES_STATUS.TITLE")),A.xp6(3),A.Q6J("ngIf",!t.loading&&t.propagationAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.allowAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.blockAuth),A.xp6(1),A.Q6J("ngIf",!t.loading&&t.deleteAuth),A.xp6(3),A.Q6J("ngIf",!t.taskIsNull),A.xp6(2),A.Oqu(A.lcZ(14,12,"FACILITY_DETAIL.SERVICES_STATUS.REMOVE_SERVICE_FROM_FACILITY")),A.xp6(2),A.Q6J("placeholder","SHARED_LIB.PERUN.COMPONENTS.SERVICES_STATUS_LIST.TABLE_SEARCH"),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading))},directives:[Pe.t,r.O5,ca.VK,ca.OP,Ge.L,Z.lW,E.gM,ca.p6,y.$g,Ya],pipes:[_.X$],styles:[""]}),e}(),Va=l(86593);function Ba(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"perun-web-apps-refresh-button",6),A.NdJ("refresh",function(){return A.CHM(i),A.oxw().refreshTable()}),A.qZA()}}function Pa(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"perun-web-apps-immediate-filter",7),A.NdJ("filter",function(e){return A.CHM(i),A.oxw().applyFilter(e)}),A.qZA()}2&e&&A.Q6J("placeholder","FACILITY_DETAIL.ALLOWED_USERS.FILTER")}function Ga(e,t){1&e&&A._UZ(0,"mat-spinner",8)}function $a(e,t){1&e&&(A.TgZ(0,"app-alert",9),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"FACILITY_DETAIL.ALLOWED_USERS.NO_USERS")," "))}var ja=function(){return["id","name"]};function Ka(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"app-users-list",10),A.NdJ("page",function(e){return A.CHM(i),A.oxw().pageChanged(e)}),A.qZA()}if(2&e){var a=A.oxw();A.Q6J("pageSize",a.pageSize)("users",a.users)("displayedColumns",A.DdM(5,ja))("disableRouting",!a.routeAuth)("filter",a.filterValue)}}var Wa=function(){var e=function(){function e(t,i,a,n){s(this,e),this.route=t,this.facilityService=i,this.tableConfigService=a,this.authResolver=n,this.loading=!1,this.filterValue="",this.tableId=xe.z6}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe(function(t){e.facilityId=t.facilityId,e.routeAuth=e.authResolver.isPerunAdmin(),e.refreshTable()})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.facilityService.getAssignedUsers(this.facilityId).subscribe(function(t){e.users=t,e.loading=!1})}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(c.gz),A.Y36(f.IQ),A.Y36(xe.dB),A.Y36(g.x4))},e.\u0275cmp=A.Xpm({type:e,selectors:[["app-facility-allowed-users"]],decls:9,vars:8,consts:[[1,"page-subtitle"],[3,"refresh",4,"ngIf"],[3,"placeholder","filter",4,"ngIf"],["class","ml-auto mr-auto",4,"ngIf"],["alert_type","warn",4,"ngIf"],[3,"pageSize","users","displayedColumns","disableRouting","filter","page",4,"ngIf"],[3,"refresh"],[3,"placeholder","filter"],[1,"ml-auto","mr-auto"],["alert_type","warn"],[3,"pageSize","users","displayedColumns","disableRouting","filter","page"]],template:function(e,t){1&e&&(A.TgZ(0,"div"),A.TgZ(1,"h1",0),A._uU(2),A.ALo(3,"translate"),A.qZA(),A.YNc(4,Ba,1,0,"perun-web-apps-refresh-button",1),A.YNc(5,Pa,1,1,"perun-web-apps-immediate-filter",2),A.YNc(6,Ga,1,0,"mat-spinner",3),A.YNc(7,$a,3,3,"app-alert",4),A.YNc(8,Ka,1,6,"app-users-list",5),A.qZA()),2&e&&(A.xp6(2),A.Oqu(A.lcZ(3,6,"FACILITY_DETAIL.ALLOWED_USERS.TITLE")),A.xp6(2),A.Q6J("ngIf",!t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading),A.xp6(1),A.Q6J("ngIf",t.loading),A.xp6(1),A.Q6J("ngIf",!t.loading&&(void 0===t.users||0===t.users.length)),A.xp6(1),A.Q6J("ngIf",!t.loading&&0!==t.users.length))},directives:[r.O5,Pe.t,Ge.L,y.$g,Mt.w,Va.C],pipes:[_.X$],styles:[""]}),e}(),Xa=l(95142);function en(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"th",19),A.TgZ(1,"mat-checkbox",20),A.NdJ("change",function(e){A.CHM(i);var t=A.oxw();return e?t.masterToggle():null}),A.qZA(),A.qZA()}if(2&e){var a=A.oxw();A.xp6(1),A.Q6J("aria-label",a.checkboxLabel())("checked",a.selection.hasValue()&&a.isAllSelected())("indeterminate",a.selection.hasValue()&&!a.isAllSelected())}}function tn(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"td",21),A.TgZ(1,"mat-checkbox",22),A.NdJ("change",function(e){var t=A.CHM(i).$implicit,a=A.oxw();return e?a.selection.toggle(t):null})("click",function(e){return e.stopPropagation()}),A.qZA(),A.qZA()}if(2&e){var a=t.$implicit,n=A.oxw();A.xp6(1),A.Q6J("aria-label",n.checkboxLabel(a))("checked",n.selection.isSelected(a))}}function an(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.RESULT_ID")))}function nn(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.id)}}function sn(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.DESTINATION")))}function ln(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.destination.destination)}}function on(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.TYPE")))}function rn(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.destination.type.toUpperCase())}}function cn(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.SERVICE")))}function un(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.service.name)}}function dn(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.STATUS")))}function hn(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.status)}}function fn(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.TIME")))}function pn(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.ALo(2,"date"),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(A.xi3(2,1,i.timestamp,"d.M.y H:mm:ss"))}}function gn(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.RETURN_CODE")))}function mn(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.returnCode)}}function Sn(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.STANDARD_MESSAGE")))}function An(e,t){if(1&e&&(A.TgZ(0,"span"),A._uU(1),A._UZ(2,"br"),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i)}}function vn(e,t){if(1&e&&(A.TgZ(0,"td",21),A.YNc(1,An,3,1,"span",24),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Q6J("ngForOf",i.standardMessage.split("\n"))}}function Tn(e,t){1&e&&(A.TgZ(0,"th",23),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.Oqu(A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.ERROR_MESSAGE")))}function In(e,t){if(1&e&&(A.TgZ(0,"td",21),A._uU(1),A.qZA()),2&e){var i=t.$implicit;A.xp6(1),A.Oqu(i.errorMessage)}}function yn(e,t){1&e&&A._UZ(0,"tr",25)}function bn(e,t){if(1&e&&A._UZ(0,"tr",26),2&e){var i=t.$implicit;A.ekj("greenTableItem","DONE"===i.status)("redTableItem","ERROR"===i.status||"DENIED"===i.status)("yellowTableItem","WARNING"===i.status)}}function En(e,t){1&e&&(A.TgZ(0,"app-alert",27),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.UI.ALERTS.NO_FILTER_RESULTS_ALERT"),"\n"))}function Cn(e,t){1&e&&(A.TgZ(0,"app-alert",27),A._uU(1),A.ALo(2,"translate"),A.qZA()),2&e&&(A.xp6(1),A.hij(" ",A.lcZ(2,1,"SHARED_LIB.PERUN.COMPONENTS.TASK_RESULTS_LIST.NO_RESULTS_WARNING"),"\n"))}var Zn=function(){var e=function(){function e(t,i){s(this,e),this.authResolver=t,this.tableCheckbox=i,this.pageSizeOptions=p.f7,this.taskResults=[],this.selection=new Oe.Ov(!0,[]),this.pageSize=10,this.displayedColumns=["select","id","destination","type","service","status","time","returnCode","standardMessage","errorMessage"],this.page=new A.vpe}return o(e,[{key:"matSort",set:function(e){this.sort=e,this.setDataSource()}},{key:"ngOnChanges",value:function(e){this.authResolver.isPerunAdmin()||(this.displayedColumns=this.displayedColumns.filter(function(e){return"id"!==e})),this.dataSource=new ot.by(this.taskResults),this.setDataSource(),this.dataSource.filter=this.filterValue}},{key:"getDataForColumn",value:function(e,t){switch(t){case"id":return e.id.toString();case"destination":return e.destination.destination;case"type":return e.destination.type;case"service":return e.service.name;case"status":return e.status;case"time":return(0,r.p6)(e.timestamp.toString(),"d.M.y H:mm:ss","en");case"returnCode":return e.returnCode.toString();case"standardMessage":return e.standardMessage;case"errorMessage":return e.errorMessage;default:return""}}},{key:"getSortDataForColumn",value:function(e,t){switch(t){case"id":return e.id.toString();case"destination":return e.destination.destination;case"type":return e.destination.type;case"service":return e.service.name;case"status":return e.status;case"time":return(0,r.p6)(e.timestamp.toString(),"yyyy.MM.dd HH:mm:ss","en");case"returnCode":return e.returnCode.toString();case"standardMessage":return e.standardMessage;case"errorMessage":return e.errorMessage;default:return""}}},{key:"exportData",value:function(e){(0,p.O6)((0,p.Xn)(this.dataSource.filteredData,this.displayedColumns,this.getDataForColumn,this),e)}},{key:"setDataSource",value:function(){var e=this;this.dataSource&&(this.dataSource.sort=this.sort,this.dataSource.paginator=this.child.paginator,this.dataSource.filter=this.filterValue,this.dataSource.filterPredicate=function(t,i){return(0,p.Sd)(t,i,e.displayedColumns,e.getDataForColumn,e)},this.dataSource.sortData=function(t,i){return(0,p.pR)(t,i,e.getSortDataForColumn,e)})}},{key:"isAllSelected",value:function(){return this.tableCheckbox.isAllSelected(this.selection.selected.length,this.filterValue,this.pageSize,this.child.paginator.hasNextPage(),this.dataSource)}},{key:"masterToggle",value:function(){this.tableCheckbox.masterToggle(this.isAllSelected(),this.selection,this.filterValue,this.dataSource,this.sort,this.pageSize,this.child.paginator.pageIndex,!1)}},{key:"checkboxLabel",value:function(e){return e?"".concat(this.selection.isSelected(e)?"deselect":"select"," row ").concat(e.id+1):(this.isAllSelected()?"select":"deselect")+" all"}},{key:"ngAfterViewInit",value:function(){this.dataSource.paginator=this.child.paginator}}]),e}();return e.\u0275fac=function(t){return new(t||e)(A.Y36(g.x4),A.Y36(g.UA))},e.\u0275cmp=A.Xpm({type:e,selectors:[["perun-web-apps-task-results-list"]],viewQuery:function(e,t){var i;(1&e&&(A.Gf(Nt.YE,7),A.Gf(p.l9,7)),2&e)&&(A.iGM(i=A.CRH())&&(t.matSort=i.first),A.iGM(i=A.CRH())&&(t.child=i.first))},inputs:{taskResults:"taskResults",selection:"selection",filterValue:"filterValue",pageSize:"pageSize",displayedColumns:"displayedColumns"},outputs:{page:"page"},features:[A.TTD],decls:37,vars:9,consts:[[1,"card","mt-3",3,"hidden"],[3,"dataLength","pageSizeOptions","pageSize","exportData","page"],["mat-table","","matSort","","matSortActive","time","matSortDirection","desc","matSortDisableClear","",1,"w-100",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["class","static-column-size","mat-cell","",4,"matCellDef"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","destination"],["matColumnDef","type"],["matColumnDef","service"],["matColumnDef","status"],["matColumnDef","time"],["matColumnDef","returnCode"],["matColumnDef","standardMessage"],["matColumnDef","errorMessage"],["mat-header-row","",4,"matHeaderRowDef"],["class","dark-hover-list-item","mat-row","",3,"greenTableItem","redTableItem","yellowTableItem",4,"matRowDef","matRowDefColumns"],["alert_type","warn",4,"ngIf"],["mat-header-cell",""],["color","primary",3,"aria-label","checked","indeterminate","change"],["mat-cell","",1,"static-column-size"],["color","primary",3,"aria-label","checked","change","click"],["mat-header-cell","","mat-sort-header",""],[4,"ngFor","ngForOf"],["mat-header-row",""],["mat-row","",1,"dark-hover-list-item"],["alert_type","warn"]],template:function(e,t){1&e&&(A.TgZ(0,"div",0),A.TgZ(1,"perun-web-apps-table-wrapper",1),A.NdJ("exportData",function(e){return t.exportData(e)})("page",function(e){return t.page.emit(e)}),A.TgZ(2,"table",2),A.ynx(3,3),A.YNc(4,en,2,3,"th",4),A.YNc(5,tn,2,2,"td",5),A.BQk(),A.ynx(6,6),A.YNc(7,an,3,3,"th",7),A.YNc(8,nn,2,1,"td",5),A.BQk(),A.ynx(9,8),A.YNc(10,sn,3,3,"th",7),A.YNc(11,ln,2,1,"td",5),A.BQk(),A.ynx(12,9),A.YNc(13,on,3,3,"th",7),A.YNc(14,rn,2,1,"td",5),A.BQk(),A.ynx(15,10),A.YNc(16,cn,3,3,"th",7),A.YNc(17,un,2,1,"td",5),A.BQk(),A.ynx(18,11),A.YNc(19,dn,3,3,"th",7),A.YNc(20,hn,2,1,"td",5),A.BQk(),A.ynx(21,12),A.YNc(22,fn,3,3,"th",7),A.YNc(23,pn,3,4,"td",5),A.BQk(),A.ynx(24,13),A.YNc(25,gn,3,3,"th",7),A.YNc(26,mn,2,1,"td",5),A.BQk(),A.ynx(27,14),A.YNc(28,Sn,3,3,"th",7),A.YNc(29,vn,2,1,"td",5),A.BQk(),A.ynx(30,15),A.YNc(31,Tn,3,3,"th",7),A.YNc(32,In,2,1,"td",5),A.BQk(),A.YNc(33,yn,1,0,"tr",16),A.YNc(34,bn,1,6,"tr",17),A.qZA(),A.qZA(),A.qZA(),A.YNc(35,En,3,3,"app-alert",18),A.YNc(36,Cn,3,3,"app-alert",18)),2&e&&(A.Q6J("hidden",0===t.dataSource.filteredData.length||0===t.taskResults.length),A.xp6(1),A.Q6J("dataLength",t.dataSource.filteredData.length)("pageSizeOptions",t.pageSizeOptions)("pageSize",t.pageSize),A.xp6(1),A.Q6J("dataSource",t.dataSource),A.xp6(31),A.Q6J("matHeaderRowDef",t.displayedColumns),A.xp6(1),A.Q6J("matRowDefColumns",t.displayedColumns),A.xp6(1),A.Q6J("ngIf",0===t.dataSource.filteredData.length&&0!==t.taskResults.length),A.xp6(1),A.Q6J("ngIf",0===t.taskResults.length))},directives:[wt.l,ot.BZ,Nt.YE,ot.w1,ot.fO,ot.Dz,ot.as,ot.nj,r.O5,ot.ge,ue.oG,ot.ev,Nt.nU,r.sg,ot.XQ,ot.Gk,Mt.w],pipes:[_.X$,r.uU],styles:[".greenTableItem[_ngcontent-%COMP%]{background-color:#c4ffcb}.yellowTableItem[_ngcontent-%COMP%]{background-color:#fffde7}.redTableItem[_ngcontent-%COMP%]{background-color:#ffcdd2}"]}),e}();function _n(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"button",8),A.NdJ("click",function(){return A.CHM(i),A.oxw(2).removeTaskResult()}),A._uU(1),A.ALo(2,"translate"),A.qZA()}if(2&e){var a=A.oxw(2);A.Q6J("disabled",0===a.selection.selected.length),A.xp6(1),A.hij(" ",A.lcZ(2,2,"FACILITY_DETAIL.TASK_RESULTS.REMOVE")," ")}}function kn(e,t){1&e&&A._UZ(0,"mat-spinner",9)}function Ln(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"perun-web-apps-task-results-list",10),A.NdJ("page",function(e){return A.CHM(i),A.oxw(2).pageChanged(e)}),A.qZA()}if(2&e){var a=A.oxw(2);A.Q6J("displayedColumns",a.displayedColumns)("filterValue",a.filterValue)("pageSize",a.pageSize)("selection",a.selection)("taskResults",a.taskResults)}}function xn(e,t){if(1&e){var i=A.EpF();A.TgZ(0,"div"),A.TgZ(1,"h1",1),A._uU(2),A.ALo(3,"translate"),A.TgZ(4,"span",2),A._uU(5),A.qZA(),A.qZA(),A.TgZ(6,"perun-web-apps-refresh-button",3),A.NdJ("refresh",function(){return A.CHM(i),A.oxw().refreshTable()}),A.qZA(),A.YNc(7,_n,3,4,"button",4),A.TgZ(8,"perun-web-apps-immediate-filter",5),A.NdJ("filter",function(e){return A.CHM(i),A.oxw().applyFilter(e)}),A.qZA(),A.YNc(9,kn,1,0,"mat-spinner",6),A.YNc(10,Ln,1,5,"perun-web-apps-task-results-list",7),A.qZA()}if(2&e){var a=A.oxw();A.xp6(2),A.AsE("",A.lcZ(3,7,"FACILITY_DETAIL.TASK_RESULTS.TITLE")," - ",a.task.service.name," "),A.xp6(3),A.hij(" \xa0#",a.task.id," "),A.xp6(2),A.Q6J("ngIf",!a.loading&&a.removeAuth),A.xp6(1),A.Q6J("placeholder","FACILITY_DETAIL.TASK_RESULTS.FILTER"),A.xp6(1),A.Q6J("ngIf",a.loading),A.xp6(1),A.Q6J("ngIf",!a.loading)}}var On,Dn,Rn=[{path:"",component:u.P},{path:":facilityId",component:N,children:[{path:"",component:F,data:{animation:"FacilityOverviewPage"}},{path:"attributes",component:te,data:{animation:"FacilityAttributesPage"}},{path:"resources",component:q.f,data:{animation:"FacilityResourcesPage"}},{path:"allowed-users",component:Wa,data:{animation:"FacilityAllowedUsersPage"}},{path:"allowed-groups",component:U.o,data:{animation:"FacilityAllowedGroupsPage"}},{path:"services-status",component:Ha,data:{animation:"FacilityServiceStatusPage"}},{path:"services-status/:taskId",component:(On=function(){function e(t,i,a,n,l){s(this,e),this.route=t,this.tableConfigService=i,this.taskManager=a,this.authResolver=n,this.dialog=l,this.loading=!1,this.filterValue="",this.selection=new Oe.Ov(!0,[]),this.tableId=xe.e5,this.displayedColumns=["select","id","destination","type","service","status","time","returnCode","standardMessage","errorMessage"],this.removeAuth=!1}return o(e,[{key:"ngOnInit",value:function(){var e=this;this.loading=!0,this.pageSize=this.tableConfigService.getTablePageSize(this.tableId),this.route.parent.params.subscribe(function(t){e.facility={id:parseInt(t.facilityId,10),beanName:"Facility"},e.removeAuth=e.authResolver.isAuthorized("deleteTask_Task_policy",[e.facility]),e.removeAuth||(e.displayedColumns=["id","destination","type","service","status","time","returnCode","standardMessage","errorMessage"]),e.route.params.subscribe(function(t){e.taskId=t.taskId,e.taskManager.getTaskById(e.taskId).subscribe(function(t){e.task=t,e.refreshTable()})})})}},{key:"refreshTable",value:function(){var e=this;this.loading=!0,this.taskManager.getTaskResultsForGUIByTask(this.taskId).subscribe(function(t){e.selection.clear(),e.taskResults=t,e.loading=!1})}},{key:"removeTaskResult",value:function(){var e=this,t=(0,p.kZ)();t.width="600px",t.data={theme:"facility-theme",taskResults:this.selection.selected},this.dialog.open(Wi,t).afterClosed().subscribe(function(t){t&&e.refreshTable()})}},{key:"applyFilter",value:function(e){this.filterValue=e}},{key:"pageChanged",value:function(e){this.pageSize=e.pageSize,this.tableConfigService.setTablePageSize(this.tableId,e.pageSize)}}]),e}(),On.\u0275fac=function(e){return new(e||On)(A.Y36(c.gz),A.Y36(xe.dB),A.Y36(f.Ob),A.Y36(g.x4),A.Y36(v.uw))},On.\u0275cmp=A.Xpm({type:On,selectors:[["app-facility-task-results"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"page-subtitle"],[1,"text-muted"],[3,"refresh"],["class","mr-2","color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],[3,"placeholder","filter"],["class","ml-auto mr-auto",4,"ngIf"],[3,"displayedColumns","filterValue","pageSize","selection","taskResults","page",4,"ngIf"],["color","warn","mat-flat-button","",1,"mr-2",3,"disabled","click"],[1,"ml-auto","mr-auto"],[3,"displayedColumns","filterValue","pageSize","selection","taskResults","page"]],template:function(e,t){1&e&&A.YNc(0,xn,11,9,"div",0),2&e&&A.Q6J("ngIf",!t.loading)},directives:[r.O5,Pe.t,Ge.L,Z.lW,y.$g,Zn],pipes:[_.X$],styles:[""]}),On),data:{animation:"FacilityTaskResultsPage"}},{path:"service-config",component:Ze,data:{animation:"FacilityServiceConfigPage"}},{path:"services-destinations",component:it,data:{animation:"FacilityServicesDestinationsPage"}},{path:"hosts",component:ei,data:{animation:"FacilityHostsPage"}},{path:"hosts/:hostId",component:bi,data:{animation:"FacilityHostsDetailPage"}},{path:"settings",component:z,children:[{path:"",component:B,data:{animation:"FacilitySettingsOverviewPage"}},{path:"owners",component:It,data:{animation:"FacilitySettingOwnersPage"}},{path:"managers",component:Le,data:{animation:"FacilitySettingsManagersPage"}},{path:"security-teams",component:qi,data:{animation:"FacilitySecurityTeamsPage"}},{path:"blacklist",component:mi,data:{animation:"FacilitySettingsBlackListPage"}}]}]},{path:":facilityId/resources/:resourceId",component:J.b,children:[{path:"",component:Q.H,data:{animation:"ResourceOverviewPage"}},{path:"attributes",component:ne.X,data:{animation:"ResourceAttributesPage"}},{path:"groups",component:se.K,data:{animation:"ResourceGroupsComponent"}},{path:"services",component:Ji.D,data:{animation:"ResourceAssignedServicesComponent"}},{path:"members",component:Xa.y,data:{animation:"ResourceAssignedMembersComponent"}},{path:"settings",component:ie.t,children:[{path:"",component:ae.h,data:{animation:"ResourceSettingsOverviewPage"}},{path:"managers",component:Ui.O,data:{animation:"ResourceSettingsManagersPage"}}]}]}],Nn=function(){var e=function e(){s(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=A.oAB({type:e}),e.\u0275inj=A.cJS({imports:[[c.Bz.forChild(Rn)],c.Bz]}),e}(),wn=l(28780),Yn=l(22727),Mn=l(6363),Fn=((Dn=function e(){s(this,e)}).\u0275fac=function(e){return new(e||Dn)},Dn.\u0275mod=A.oAB({type:Dn}),Dn.\u0275inj=A.cJS({providers:[ce.dp],imports:[[r.ez,Nn,wn.m,Yn.r,Si.ez,ce.d4,Mn.UsersModule]]}),Dn)}}])}();